@友人を昼食に誘う
#DIM DYNAMIC LCOUNT
#DIM DYNAMIC LRAND
#DIM DYNAMIC 候補人数
#DIM DYNAMIC 候補, 1000

PRINTL □誰を誘いますか？

FOR LCOUNT, 1, CHARANUM
	;同じ学校の中から
	SIF CSTR:LCOUNT:在校 != CSTR:PLAYER:在校 && CSTR:LCOUNT:在任 != CSTR:PLAYER:在校
		CONTINUE
	;好感度の高いキャラを選出
	IF 好感度合計(LCOUNT) >= 100
		IF CSTR:LCOUNT:現在地 != CSTR:LCOUNT:在校 && CSTR:LCOUNT:現在地 != CSTR:LCOUNT:在任
			SETCOLORBYNAME gray
			PRINT　[---] - 
			CALL SNAME(LCOUNT)
			SETCOLORBYNAME gray
			PRINTL (学校をサボっている)
			RESETCOLOR
		ELSE
			PRINTFORM 　[{LCOUNT, 3}] - 
			CALL SNAME(LCOUNT)
			SIF CSTR:LCOUNT:在任 != ""
				PRINT 先生
			PRINTL 
		ENDIF
		候補人数++
	ENDIF
NEXT

IF 候補人数 == 0
	PRINTL 
	PRINTL 　----------友人が居ません----------
	PRINTL 
ENDIF

DRAWLINE
PRINTPLAIN 　友人を昼食に誘う　
PRINTL [0] - やめる

BINPUT
SIF RESULT == 0
	RETURN 0

TARGET = RESULT

IF CSTR:在任 != ""
	PRINTFORML %CALLNAME:TARGET%先生と一緒に昼食を食べた
	CALL SCHOOL_KOJO, TARGET, "一緒に昼食"
	CALL 好感度上昇, TARGET, "舎弟", 10
	CALL 好感度上昇, TARGET, "友情", 10
ELSE
	PRINTFORML %CALLNAME:TARGET%と一緒に昼食を食べた
	CALL SCHOOL_KOJO, TARGET, "一緒に昼食"
	CALL 好感度上昇, TARGET, "友情", 20
ENDIF
WAIT

RETURN 1
