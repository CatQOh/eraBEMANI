@校内を散策する
#DIM DYNAMIC LCOUNT
#DIM DYNAMIC LRESULT

PRINTFORML □%CALLNAME:PLAYER%は学校内を散策してみた
VARSET 出現率
CALL 出現キャラ_学校
FOR LCOUNT, 1, CHARANUM
	SIF RANDPER(出現率:LCOUNT)
		PRINTFORML 　[{LCOUNT}] - %SNAME(LCOUNT)%に話しかける
NEXT
DRAWLINE
PRINTPLAIN 　校内を散策する　
PRINTFORML [0] - 戻る [-1] - もう少し周りを見てみる

BINPUT
LRESULT = RESULT
SELECTCASE LRESULT
	CASE 0
		RETURN 0
	CASE -1
		RESTART
	CASEELSE
		CALL 学園モード_汎用会話, LRESULT
		SIF !RESULT
			RESTART
ENDSELECT

RETURN 1

@出現キャラ_学校
#DIM DYNAMIC LCOUNT

;NOではなく登録番号で指定する
FOR LCOUNT, 1, CHARANUM
	;同じ学校に居るキャラのみ
	SIF CSTR:PLAYER:現在地 != CSTR:LCOUNT:現在地
		CONTINUE
	出現率:LCOUNT = 10
NEXT

;;;校内に居るフラグ
@校内
#FUNCTION

SIF CSTR:PLAYER:現在地 == CSTR:PLAYER:在校
	RETURNF 1
RETURNF 0
