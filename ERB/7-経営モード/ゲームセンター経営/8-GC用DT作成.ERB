@GC用DT作成
#DIM DYNAMIC LCOUNT
[SKIPSTART]
DT_CREATE "GC_DATA"

DT_COLUMN_ADD "GC_DATA", "前日の収入", "int64"
DT_COLUMN_ADD "GC_DATA", "営業中", "int8"
DT_COLUMN_ADD "GC_DATA", "物件", "int8"
DT_COLUMN_ADD "GC_DATA", "名声", "int64"
DT_COLUMN_ADD "GC_DATA", "評判", "int64"
DT_COLUMN_ADD "GC_DATA", "メンテ", "int64"
DT_COLUMN_ADD "GC_DATA", "広さ", "int16"
DT_COLUMN_ADD "GC_DATA", "分煙", "int8"
DT_COLUMN_ADD "GC_DATA", "階層", "int8"
DT_COLUMN_ADD "GC_DATA", "外装", "int64"
DT_COLUMN_ADD "GC_DATA", "フードコート", "int8"
DT_COLUMN_ADD "GC_DATA", "トイレ", "int64"
DT_COLUMN_ADD "GC_DATA", "店名", "string"
DT_COLUMN_ADD "GC_DATA", "定休日", "string"
DT_COLUMN_ADD "GC_DATA", "バージョン", "int64"

SIF DT_ROW_LENGTH("GC_DATA") == 0
	DT_ROW_ADD "GC_DATA"

[SKIPEND]
DT_CREATE "GC_HISTORY"

DT_COLUMN_ADD "GC_HISTORY", "客数", "int64"
DT_COLUMN_ADD "GC_HISTORY", "総売上", "int64"
DT_COLUMN_ADD "GC_HISTORY", "支出", "int64"
DT_COLUMN_ADD "GC_HISTORY", "フードコート売上", "int64"
DT_COLUMN_ADD "GC_HISTORY", "日付", "string"

FOR LCOUNT, 0, VARSIZE("筐体")
	SIF ERDNAME(筐体, LCOUNT) == ""
		CONTINUE
	SIF DT_COLUMN_EXIST("GC_HISTORY", @"%ERDNAME(筐体, LCOUNT)%売上")
		CONTINUE
	DT_COLUMN_ADD "GC_HISTORY", @"%ERDNAME(筐体, LCOUNT)%売上", "int64"
NEXT

@GC_HISTORY, 行, 列
#FUNCTION
#DIMS DYNAMIC 列
#DIM DYNAMIC 行

IF !DT_COLUMN_EXIST("GC_HISTORY", 列)
	;#; SIF 列 != "id"
	;#; THROW %列%はカラムに存在しない
	RETURNF 0
ENDIF

SIF DT_CELL_ISNULL("GC_HISTORY", 行, 列)
	RETURNF 0
RETURNF DT_CELL_GET("GC_HISTORY", 行, 列)

@GC_売上日付, 行
#FUNCTIONS
#DIM DYNAMIC 行

SIF DT_CELL_ISNULL("GC_HISTORY", 行, "日付")
	RETURNF ""
RETURNF DT_CELL_GETS("GC_HISTORY", 行, "日付")

;;;今のところDT_ROW_LENGTH-1の行しか編集しないので固定する
@GC_CELL_PLUS, 列, 値
#DIMS DYNAMIC 列
#DIM DYNAMIC 値

DT_CELL_SET "GC_HISTORY", DT_ROW_LENGTH("GC_HISTORY")-1, 列, DT_CELL_GET("GC_HISTORY", DT_ROW_LENGTH("GC_HISTORY")-1, 列)+値
