@CHARA_MANUAL, ARG

VARSET LOCAL, 0

IF GETCHARA(ARG) > 0
	PRINTFORMW %CSVNAMEF(ARG)%は既に購入されています
	RETURN 1
ELSEIF CCB:ARG
	PRINTFORMW %CSVNAMEF(ARG)%は購入できません
	RETURN 1
ELSEIF ARG == NO:MASTER
	RETURN 1
ENDIF

REPEAT 100
	SIF CSVCSTR(ARG, COUNT) == ""
		BREAK
	PRINTFORML %CSVCSTR(ARG, COUNT)%
REND

SELECTCASE CSVNAME(ARG)
	CASE "黄のラピカ"
		PRINTFORML 【黄のラピカ（キャトられ%UNICODE(0x2764)%恋はモ～モク）】
		PRINTFORML 詳細はよくわかっていないが赤のリピカの部下らしい。
		PRINTFORML しかしリピカをちゃん付けで呼んだりルピカをちゃん付けで呼んだりとあまりそういう観念はない模様。
		PRINTFORML 幼い風貌に見えるが並以上のプロポーションを持っており、魅力的な調教対象になるだろう。
	CASE "風雅"
		SETCOLOR 50 , 255 , 50
		PRINTL 【風雅（Cosmic Hurricane）】
		PRINTL 烈、氷海、鈴花と同じ学園に通う転校生。
		PRINTL 烈をライバル視しており、学園の生徒会長の氷海とも何かと仲が悪い。
		PRINTL 冷めた性格で何事にも無関心。彼の興味を引くことは容易では無いだろう。
		RESETCOLOR
	CASE "氷海"
		SETCOLOR 25 , 255 , 255
		PRINTL 【氷海（snow prism）】
		PRINTL お嬢様気質の生徒会長。
		PRINTL 抜群のプロポーションで身体的な逸材。
		PRINTL しかし内面はツンデレでプライドが高く、調教は苦戦すると思われる。
		PRINTL パステルくんに密かに恋をしているようだが……
		RESETCOLOR
	CASE "烈"
		SETCOLOR 230 , 50 , 0
		PRINTL 【烈（紅焔）】
		PRINTL 赤髪で赤い瞳、運命を浄化する炎の化身。
		PRINTL 課せられたサダメを全うするため、今日も灼熱の精霊と共にココロを燃やし尽くす。運命浄化！
		PRINTL 中二病な性格であるが、外向的な性格で明るく好奇心旺盛。
		PRINTL 風雅、氷海と相性が悪いところに気をつければ、それほど難しい相手ではないと思われる。
		RESETCOLOR
	CASE "鈴花"
		SETCOLOR 180 , 90 , 100
		PRINTL 【鈴花（恋閃繚乱）】
		PRINTL チャイナドレスを身にまとう小柄で無邪気な少女。
		PRINTL 同じ学園の風雅、氷海、烈とは相性が良く、明るく元気な性格。恋閃繚乱！
		PRINTL 体力が低くハードな調教には向かないが、優しく快楽を与え続ければ陥落は容易だろう。
		RESETCOLOR
	CASE "てまり"
		PRINTL 【てまり（コドモライブ）】
		PRINTW 「い」　いづこに参られた 
		PRINTW 「ろ」　露降りし夜明け想う 
		PRINTW 「は」　花匂い立つ春 
		PRINTW 「に」　にわか寂しさ募る 
		PRINTW 「ほ」　ほんのわずかばかりの 
		PRINTW 「へ」　減らぬつたなし痛み 
		PRINTW 「と」　永遠に抱き続ける
		PRINTW Ha　千代の幸せ願い
		PRINTL 
		PRINTL 
		PRINTL 手まり歌を歌いながら手まりをつき続ける小さな女の子。
		PRINTL いなくなった兄の帰りを待ち続けているようだが本人が生きているのかすらわからない。
		PRINTL 当然性的なことなど知識は皆無で経験すらない子供なので無理強いしないことを勧める。
	CASE "なぎさ"
		PRINTL 【なぎさ（†渚の小悪魔ラヴリィ～レイディオ†）】
			SETCOLOR 255 , 180 , 220
		PRINTL えいニャ！えいニャ！渚の小悪魔！
			RESETCOLOR
		PRINTL 
		PRINTL 特筆する点は無いが[絶壁]持ちなのでいろいろなことに制約がかかることに注意。
	CASE "オーリー"
		PRINTL 【オーリー（Snowfield Express）】
		PRINTL 銀世界をスノーボードで駆け抜けるユキヒョウ。雪山にそぐわない服装でも彼の体毛のおかげできっと暖かい
		PRINTL スピードに乗ることと寒い場所を好み、逆に暑い場所は苦手
		FONTSTYLE 4
		PRINTL （下半身は何も履いていない）
		FONTSTYLE 0
ENDSELECT

@CHARA_BUY_CHECK, ARG
LOCAL = 0
IF !EXISTCSV(ARG)
	PRINTL 
	PRINTW CSVが未実装です（仕様）
	RETURN 1
ELSEIF MONEY < CSVCFLAG(ARG, 50)
	PRINTL 
	PRINTW ＜金額が足りません＞
	RETURN 1
ELSE
	DO
		PRINTL 
		PRINTL 購入しますか？
		PRINTL [0]はい
		PRINTL [1]いいえ
		SIF LOCAL == 0
			PRINTL [2]素質を表示する
		INPUT
		SELECTCASE RESULT
			CASE 0
				購入人数++
				MONEY -= CSVCFLAG(ARG , 50)
				PRINTFORMW ＜%CSVNAMEF(ARG)%を解禁しました＞
				ADDCHARA ARG
				CCB:ARG = 1
				キャラ未購入 = 0
				;マルクトとミリアは片方しか奴隷にできない
				SELECTCASE ARG
					CASE 2058
						CCB:2059 = 1
					CASE 2059
						CCB:2058 = 1
				ENDSELECT
				TARGET = CHARANUM-1
				BUYD = DAYS
				BUYM = MONTH
				BUYY = YEAR
				SIF CFLAG:誕生日 == (MONTH*100)+DAYS
					CALL 実績解除, "アンハッピーバースデー"
				SIF CHARANAMEF(TARGET) == "つらら" && MONTH == 12 && (DAYS == 24 || DAYS == 25)
					CALL 実績解除, "クリスマス中止のお知らせ"
				;初期フラグいろいろ
				CFLAG:生殖力担当魔術師 = -1
				CFLAG:不妊担当魔術師 = -1
				CFLAG:男性器提供者 = -1
				IF PENIS(TARGET)
					CFLAG:ペニスサイズ = 2
					SIF TALENT:小柄体型 || TALENT:小人体型
						CFLAG:ペニスサイズ = 1
				ENDIF
				TRYCALLFORM MASTER_K{NO:MASTER}_CHARABUY, ARG
				TFLAG:ページ数 = 0
				RETURN 0
			CASE 1
				RETURN 1
			CASE 2
				LOCAL = 1
				PRINTL 
				PRINTFORML 種族:%CSVCSTR(ARG, GETNUM(CSTR, "種族"))%
				PRINT 素質
				REPEAT 200
					SELECTCASE TALENTNAME:COUNT
						CASE "性別"
							CONTINUE
						CASE "バストサイズ"
							SELECTCASE CSVTALENT(ARG, COUNT)
								CASE 1
									PRINT 【絶壁】
								CASE 2
									PRINT 【貧乳】
								CASE 3
									PRINT 【並乳】
								CASE 4
									PRINT 【巨乳】
								CASE 5
									PRINT 【爆乳】
							ENDSELECT
							CONTINUE
					ENDSELECT
					SIF CSVTALENT(ARG, COUNT)
						PRINTFORM 【%TALENTNAME:COUNT%】
				REND
				PRINTL 
		ENDSELECT
	LOOP LOOPRES(0, 1)
ENDIF

RETURN 0

