@TUTORIAL, ARGS
#DIMS 前回のコマンド名
SIF TUTORIAL == ""
	RETURN RESULT

IF ARGS != ""
	SELECTCASE ARGS
		CASE "キャラクリ終了"
			SIF TUTORIAL == "キャラクリ"
				TUTORIAL = キャラクリ終了
		CASE "奴隷購入"
			SIF TUTORIAL == "SHOP_2"
				TUTORIAL = 奴隷購入
		CASE "調教開始"
			SIF TUTORIAL == "奴隷購入"
				TUTORIAL = 調教開始
		CASE "調教_1"
			SIF TUTORIAL == "調教開始"
				TUTORIAL = 調教_1
		CASE "コマンドセット"
			SIF TUTORIAL == "調教_3"
				TUTORIAL = コマンドセット
		CASE "調教_4"
			SIF TUTORIAL == "コマンドセット"
				TUTORIAL = 調教_4
		CASE "調教終了無効"
			SIF TUTORIAL != "調教終了" && BASE:体力 <= 500
				BASE:体力 = 700
		CASE "調教終了無効_2"
			IF TUTORIAL != "調教終了"
				TUTORIAL_RESULT = 999
				RETURN 0
			ENDIF
	ENDSELECT
	RETURN RESULT
ENDIF


CALL NEWLINE

DRAWLINE

REDRAW 0

GCREATEFROMFILE 0, "dj_usi.png"
SPRITECREATE "DJ_USI", 0
CALL 動物スプライト

TUTORIAL_LINE = 0
VARSET TUTORIAL_TEXT

SELECTCASE TUTORIAL
	CASE "FIRST"
		TUTORIAL_ICON = DJ_USI
		CALL TPRINTL, "俺がeraBEMANI専属DJ、DJ USIだ"
		CALL TPRINTL, "調教師になりたいなら俺の説明をよく聞いとけよ"
		CALL TPRINTL, "まずはゲームの遊び方を覚えないとな"
		CALL TSHOW
		WAIT
		TUTORIAL_ICON = 牛
		CALL TPRINTL, "ゲームを開始すると、まずはどのゲームモードで遊ぶかを選ぶ必要がある"
		CALL TPRINTL, "従来のeraのルールに則った、調教と売却がメインのSTANDARDモード、独自システムの経営で資金ノルマを達成するSTRATEGYモード、"
		CALL TPRINTL, "変則ルールで攻略を目指す段位認定、ノルマの無い新婚モードやPFREEモードなどがあるよ"
		CALL TSHOW
		WAIT
		CALL TPRINTL, "このチュートリアルでは最低限の流れを掴むためにPFREEモードで開始しているからね"
		CALL TPRINTL, "チュートリアル用に省くけど、ゲーム上のオプションをより詳細に設定することが可能だよ"
		CALL TPRINTL, "難易度もNORMALに設定してある。より簡単なBEGINNERや、ゲームに慣れてきたら高難易度のHYPER、ANOTHER、LEGGENDARIAを遊んでみるのもいいかもね"
		CALL TSHOW
		WAIT
		CALL TPRINTL, "本来ならPFREEでは、eraBEMANIに実装されている全てのキャラからPC(プレイヤーキャラ)を選べるんだけど、"
		CALL TPRINTL, "ここではプレイヤーの分身である「あなた」を使って進めていくよ"
		CALL TPRINTL, "STANDARDモードやSTRATEGYモードではPCは選べず「あなた」で始まるんだ"
		CALL TSHOW
		WAIT
		CALL TPRINTL, "PCが「あなた」の時には名前や性別を始め、様々なステータスをカスタマイズすることができる"
		CALL TPRINTL, "次の画面で「あなた」のキャラクリエイトをしてみよう"
		CALL TSHOW
		WAIT
		TUTORIAL = キャラクリ
	CASE "キャラクリ"
		CALL TPRINTL, "これがキャラクリエイト画面だ。何も実際のプレイヤーのプロフィールを正直に入力する必要は無い"
		CALL TPRINTL, "プレイヤーの願望通りに設定してもいいし、ゲーム上有利に進めるために強キャラを作ってもいいし、ランダムに任せてもいい"
		CALL TPRINTL, "プレイヤー名は「あなた」のままでもゲームに支障は無いよ。オンラインゲームじゃないから誰かに見られることもない。欲望をさらけ出そう"
		CALL TSHOW
	CASE "キャラクリ終了"
		TUTORIAL_ICON = 牛2
		CALL TPRINTL, "これでゲームを遊ぶ最低限の設定は整った。次からは実際にゲーム画面を見ながらチュートリアルを進めていこう"
		CALL TPRINTL, "eraBEMANIは調教SLGだ。キャラクターを購入して各種ステータスを伸ばし、売却して資金を増やしていくゲームデザインになっている"
		CALL TPRINTL, "まずはキャラを購入しないと何も始まらないんだ"
		CALL TSHOW
		WAIT
		TUTORIAL = SHOP_1
	CASE "SHOP_1"
		TUTORIAL_ICON = 牛
		CALL TPRINTL, "ここがメインのメニュー画面。eraではSHOP画面と呼ばれている"
		CALL TPRINTL, "キャラを購入するために、まずは「[10003] キャラ・アイテム購入」のタブを選んでみよう"
		CALL TSHOW
		TUTORIAL = SHOP_2
	CASE "SHOP_2"
		IF 選択カラム != 3
			TUTORIAL_ICON = 牛3
			CALL TPRINTL, "それじゃない。「[10003] キャラ・アイテム購入」のタブだ"
			CALL TSHOW
		ELSE
			TUTORIAL_ICON = 牛
			CALL TPRINTL, "ここではアイテムとキャラを購入することができる"
			CALL TPRINTL, "とりあえずアイテムは置いといて「[2000] 奴隷購入」を選んでみよう"
			CALL TSHOW
		ENDIF
	CASE "奴隷購入"
		TUTORIAL_ICON = 牛1
		CALL TPRINTL, "音ゲーマーならお馴染みのキャラがたくさん居るね。このゲームではこいつら全員にヤりたい放題なんだ"
		CALL TPRINTL, "初心者にオススメの低難易度キャラを何人かピックアップしてみたから、気になるキャラを選んでみるといい"
		CALL TPRINTL, "そのキャラでチュートリアルを進めていこう"
		開発難易度フィルタ = 050000
		屈服難易度フィルタ = 030000
		FLAG:男女フィルタ = 2
		CALL TSHOW
	CASE "調教開始"
		TUTORIAL_ICON = 牛
		SELECTCASE 選択カラム
			CASE 0, 3
				CALL TPRINTL, @"%CALLNAME:TARGET%を選んだんだね。いいセンスだ"
				CALL TPRINTL, "早速調教を開始してみよう。「[10000] メイン」のタブから「[0] 調教開始」を選んでみよう"
				SIF TARGET > 0
					CALL TPRINTL, @"同意を得る必要なんて無い。君は\@ SEX(TARGET) == 1 ? 彼 # 彼女 \@の人権を買ったんだからね"
			CASEELSE
				CALL TPRINTL , "違う。[10000] メインのタブだ"
		ENDSELECT
		FLAG:Ｖ系コマンドフィルタ = 1
		FLAG:Ａ系コマンドフィルタ = 1
		FLAG:暴力コマンドフィルタ = 1
		CALL TSHOW
	CASE "調教_1"
		IF TUTORIAL_RESULT == 999
			TUTORIAL_ICON = 牛-1
			CALL TPRINTL, "それを選ぶと調教が終わっちゃうんだ。まだキャラの体力が残っているんだから終わるのはもったいない"
			CALL TPRINTL, "別のコマンドを選んでみよう"
		ELSEIF PREVCOMS != ""
			TUTORIAL_ICON = 牛
			CALL TPRINTL, "メッセージが表示されてパラメータが変動したのが分かったかな？"
			CALL TPRINTL, "このパラメータの変動こそがeraの醍醐味、eraがゲームたる所以だ。キャラを育てて大きな売却額を得たり、eraBEMANIなら経営要素に活かしたり、"
			CALL TPRINTL, "メッセージの描写や口上と合わせてエロゲのエロ部分を堪能することが目的だ。別のコマンドも選んでみよう"
			前回のコマンド名 = %PREVCOMS%
			FLAG:Ｖ系コマンドフィルタ = 0
			FLAG:Ａ系コマンドフィルタ = 0
			TUTORIAL = 調教_2
		ELSE
			TUTORIAL_ICON = 牛1
			CALL TPRINTL, "ここが調教画面だ。見るだけでワクワクする単語がいっぱい並んでるね。白い文字が実行できるコマンドだ。灰色のコマンドは拒否されてしまう"
			CALL TPRINTL, "チュートリアル通りに進めたのなら君は簡単なキャラを選んだはずだから、ある程度攻略の自由はある"
			CALL TPRINTL, "好きなコマンドを選んでみよう。最初は嫌がられるかもしれないけど、体に覚えさせれば攻略できないキャラは居ないのさ"
		ENDIF
		FLAG:口上表示 = 0
		FLAG:地の文表示 = 1
		CALL TSHOW
	CASE "調教_2"
		IF TUTORIAL_RESULT == 999
			TUTORIAL_ICON = 牛
			CALL TPRINTL, "ダメだ。まだ終わってない"
		ELSE
			IF 前回のコマンド名 == PREVCOMS
				TUTORIAL_ICON = 牛
				CALL TPRINTL, @"別のコマンドって言ったのに、君は随分と%PREVCOMS%が好きなんだね。このゲームでは同じコマンドを連続実行すると効率が下がるから気をつけて"
			ELSE
				TUTORIAL_ICON = 牛1
				CALL TPRINTL, "ね？面白いでしょ？この時点で面白さを感じなかったらゲームごとゴミ箱ダンクを推奨するよ"
			ENDIF
			CALL TPRINTL, "それはそうと、さっきまで「エロゲのくせにコマンド少ねえな」とか思わなかった？チュートリアル用に選べるコマンドを制限していたんだ"
			CALL TPRINTL, "いくつかのコマンド制限を外してみた。好きなコマンドを選んでみるといい"
			TUTORIAL = 調教_3
		ENDIF
		CALL TSHOW
	CASE "調教_3"
		IF TUTORIAL_RESULT == 999
			TUTORIAL_ICON = 牛
			CALL TPRINTL, "今それを選ぶのは違うと思うんだ"
		ELSE
			TUTORIAL_ICON = 牛1
			CALL TPRINTL, "選べるコマンドが増えてさらに楽しくなってきたね。より難しいキャラだと、攻略にも時間がかかるし調教フェイズも長くなる"
			CALL TPRINTL, "そんなときに便利なのがコマンドセット機能だ。予め選んでおいたコマンドを自動で実行してくれる。"
			CALL TPRINTL, "数をこなしたいときや、何らかの事情で片手を使えない時にも有効だ。「[951] コマンドセット1の設定」を選んでみよう"
		ENDIF
		CALL TSHOW
	CASE "コマンドセット"
		TUTORIAL_ICON = 牛
		IF TUTORIAL_RESULT == 999
			CALL TPRINTL, "ここで終わったらチュートリアルは完了しないよ"
		ELSE
			CALL TPRINTL, "これがコマンドセット画面だ。コマンドを選び、組み合わせ、一連の流れを作成できる"
			CALL TPRINTL, "全部白文字のコマンドだけど、実際は攻略対象のステータスによって実行不可能な場合がある。その時はコマンドがスキップされて次のコマンドを実行するよ"
			CALL TPRINTL, "コマンドセットを作ってもいいし作らなくてもいい。気が済むまで弄ったら[1000] 戻るを選ぼう"
		ENDIF
		FLAG:暴力コマンドフィルタ = 0
		CALL TSHOW
	CASE "調教_4"
		TUTORIAL_ICON = 牛-3
		CALL TPRINTL, "コマンド制限を全部解除した。「腹パン」とか「踏む」とか物騒なコマンドが増えたのが分かったかな？"
		CALL TPRINTL, "残念なことに、低難易度のキャラだと真面目に攻略するようにぶん殴って言うこと聞かせたほうが早い場合もあるんだ。選ぶ人も作る人もひどいよね"
		CALL TPRINTL, "視界に入っただけで不穏な気持ちになるなら、[960] コマンドフィルタの設定からコマンドを非表示にしよう。もしくは君の暴力的な一面を露わにしてもいい"
		CALL TSHOW
		TUTORIAL = 調教終了
	CASE "調教終了"
		TUTORIAL_ICON = 牛
		CALL TPRINTL, "調教の一連の流れはこんな感じだ。eraBEMANIは着衣プレイに対応してるから、自由に服を着脱させてもいいし、能力を見ながら攻略の方針を模索するのもいい"
		CALL TPRINTL, "今は口上表示をオフにしているけど、口上表示をオンにして口上が実装されているキャラなら、淡々とした地の文だけでなくエロゲさながらにキャラが喋りだすんだ"
		CALL TPRINTL, "また、キャラの体力が500以下になると調教は中断される。500以下になるまでコマンドを選ぶか、[999] 調教終了を選ぼう"
		CALL TSHOW
	CASE ""
		CALL TPRINTL, ""
		CALL TPRINTL, ""
		CALL TPRINTL, ""
		CALL TSHOW
		WAIT
	CASE ""
		CALL TPRINTL, ""
		CALL TPRINTL, ""
		CALL TPRINTL, ""
		CALL TSHOW
		WAIT
	CASE ""
		CALL TPRINTL, ""
		CALL TPRINTL, ""
		CALL TPRINTL, ""
		CALL TSHOW
		WAIT
ENDSELECT

TUTORIAL_RESULT = 0

@TPRINT, ARGS
TUTORIAL_TEXT:TUTORIAL_LINE += ARGS

@TPRINTL, ARGS
TUTORIAL_TEXT:TUTORIAL_LINE += ARGS
TUTORIAL_LINE++

@TSHOW
#DIM DYNAMIC 罫線文字数
HTML_PRINT @"<img src='%TUTORIAL_ICON%' srcb='' height='500' width='500'>", 1

罫線文字数 = STRLENSU(GETLINESTR("━"))

;画像(5)と┌と┐引いて7
罫線文字数 -= 7


;div使ってもいいけど簡単な処理には規模が大きくて向かない
PRINTPLAINFORM ┏%"━"*罫線文字数%┓
PRINTL 
PRINTPLAINFORM 　　　　　┃%TUTORIAL_TEXT:0, 罫線文字数*2, LEFT%┃
PRINTL 
PRINTPLAINFORM 　　　　　┃%TUTORIAL_TEXT:1, 罫線文字数*2, LEFT%┃
PRINTL 
PRINTPLAINFORM 　　　　　┃%TUTORIAL_TEXT:2, 罫線文字数*2, LEFT%┃
PRINTL 
PRINTPLAINFORM 　　　　　┗%"━"*罫線文字数%┛
PRINTL 

TUTORIAL_LINE = 0
VARSET TUTORIAL_TEXT
