;段位認定における1日ごとのゲージの変動を管理
@段位ゲージ処理
IF MONEY >= 4000
	LOCAL = MONEY
	LOCAL:1 = FLAG:段位ゲージ*2
	PRINT 所持金を段位ゲージに換算しました。
	FLAG:段位ゲージ += MONEY/4000
	MONEY = MONEY%4000
	IF FLAG:段位ゲージ > 51
		PRINT (※回復量がカンストしています)
		FLAG:段位ゲージ = 51
		MONEY = 3999
	ENDIF
	PRINTL 
	PRINTFORML 所持金 {LOCAL} → {MONEY}
	PRINTFORML 段位ゲージ {LOCAL:1} → {FLAG:段位ゲージ*2}
ENDIF

VARSET LOCAL, 0
REPEAT CHARANUM
	SIF CFLAG:COUNT:状態 >= 1
		LOCAL++
REND
SIF LOCAL >= (CHARANUM-1)
	CALL TEST_CLEAR

FLAG:段位ゲージ -= 1
SIF FLAG:段位ゲージ <= 0
	CALL TEST_FAILED

;段位ゲージの表示
@段位ゲージ表示
PRINTFORM 段位ゲージ {FLAG:段位ゲージ*2}\%[
REPEAT FLAG:段位ゲージ
	SETCOLOR 255, 0, 0
	PRINT |
	RESETCOLOR
REND
REPEAT 50-FLAG:段位ゲージ
	SETCOLOR 128, 128, 128
	PRINT |
	RESETCOLOR
REND
PRINT ]

@GORILLA_ITEM
DRAWLINE
CALL 段位ゲージ表示
PRINTL 
DRAWLINE
CALL ITEMPRINT
DRAWLINE
PRINTL □段位認定試験では通貨の代わりにゲージを消耗します。
PRINTL 　購入したいアイテムを選んでください。
PRINTL
SIF !ITEM:ローター
	PRINTL 　[0] ローター（ゲージ2%）
SIF !ITEM:オナホール
	PRINTL 　[1] オナホール（ゲージ4%）
SIF !ITEM:バイブ
	PRINTL 　[2] バイブ（ゲージ4%）
SIF !ITEM:アナルバイブ
	PRINTL 　[3] アナルバイブ（ゲージ6%）
SIF !ITEM:アナルビーズ
	PRINTL 　[4] アイマスク（ゲージ4%）
SIF !ITEM:縄
	PRINTL 　[5] 縄（ゲージ6%）
SIF !ITEM:ビデオカメラ
	PRINTL 　[6] ビデオカメラ テープ×3付属（ゲージ10%）
SIF ITEM:ビデオカメラ
	PRINTL 　[7] ビデオテープ×3（ゲージ6%）
PRINTL 　[8] ローション×5（ゲージ2%）
PRINTL 　[9] 媚薬（ゲージ2%）
DRAWLINE
PRINTPLAIN 　ITEM　
PRINTL [10] 戻る

DO
	INPUT
	SELECTCASE RESULT
		CASE 0
			IF ITEM:ローター
				PRINTW ローターは既に所持しています
			ELSEIF FLAG:段位ゲージ > 1
				PRINTW ＜ローターを購入しました＞
				ITEM:ローター = 1
				FLAG:段位ゲージ -= 1
			ELSE
				PRINTW ゲージが足りません
			ENDIF
		CASE 1
			IF ITEM:オナホール
				PRINTW オナホールは既に所持しています
			ELSEIF FLAG:段位ゲージ > 2
				PRINTW ＜オナホールを購入しました＞
				ITEM:オナホール = 1
				FLAG:段位ゲージ -= 2
			ELSE
				PRINTW ゲージが足りません
			ENDIF
		CASE 2
			IF ITEM:バイブ
				PRINTW バイブは既に所持しています
			ELSEIF FLAG:段位ゲージ > 2
				PRINTW ＜バイブを購入しました＞
				ITEM:バイブ = 1
				FLAG:段位ゲージ -= 2
			ELSE
				PRINTW ゲージが足りません
			ENDIF
		CASE 3
			IF ITEM:アナルバイブ
				PRINTW アナルバイブは既に所持しています
			ELSEIF FLAG:段位ゲージ > 3
				PRINTW ＜アナルバイブを購入しました＞
				ITEM:アナルバイブ = 1
				FLAG:段位ゲージ -= 3
			ELSE
				PRINTW ゲージが足りません
			ENDIF
		CASE 4
			IF ITEM:アイマスク
				PRINTW アイマスクは既に所持しています
			ELSEIF FLAG:段位ゲージ > 2
				PRINTW ＜アイマスクを購入しました＞
				ITEM:アイマスク = 1
				FLAG:段位ゲージ -= 2
			ELSE
				PRINTW ゲージが足りません
			ENDIF
		CASE 5
			IF ITEM:縄
				PRINTW 縄は既に所持しています
			ELSEIF FLAG:段位ゲージ > 3
				PRINTW ＜縄を購入しました＞
				ITEM:縄 = 1
				FLAG:段位ゲージ -= 3
			ELSE
				PRINTW ゲージが足りません
			ENDIF
		CASE 6
			IF ITEM:ビデオカメラ
				PRINTW ビデオカメラは既に所持しています
			ELSEIF FLAG:段位ゲージ > 5
				PRINTW ＜ビデオカメラを購入しました＞
				ITEM:ビデオカメラ = 1
				ITEM:ビデオテープ += 3
				FLAG:段位ゲージ -= 5
			ELSE
				PRINTW ゲージが足りません
			ENDIF
		CASE 7
			IF ITEM:ビデオテープ >= 97
				PRINTW ビデオテープはこれ以上持てません
			ELSEIF FLAG:段位ゲージ > 3
				PRINTW ＜ビデオテープ×3を購入しました＞
				ITEM:ビデオテープ += 3
				FLAG:段位ゲージ -= 3
			ELSE
				PRINTW ゲージが足りません
			ENDIF
		CASE 8
			IF ITEM:ローション >= 95
				PRINTW ローションはこれ以上持てません
			ELSEIF FLAG:段位ゲージ > 1
				PRINTW ＜ローション×5を購入しました＞
				ITEM:ローション += 5
				FLAG:段位ゲージ -= 1
			ELSE
				PRINTW ゲージが足りません
			ENDIF
		CASE 9
			IF ITEM:媚薬 >= 99
				PRINTW 媚薬はこれ以上持てません
			ELSEIF FLAG:段位ゲージ > 1
				PRINTW ＜媚薬を購入しました＞
				ITEM:媚薬 += 1
				FLAG:段位ゲージ -= 1
			ELSE
				PRINTW ゲージが足りません
			ENDIF
		CASE 10
			RETURN 0
	ENDSELECT
LOOP LOOPRES(0, 1, 2, 3, 4, 5, 6, 7, 8, 9)

RESTART

;数値に応じた段位を色付き文字で表示する関数 色変更するから式中関数化は無理
@GRADE, ARG
SELECTCASE ARG
	;緑段位
	CASE 1 TO 7
		SETCOLOR 140, 240, 140
	;青段位
	CASE 11 TO 18
		SETCOLOR 170, 220, 230
	;赤段位
	CASE 19, 20
		SETCOLOR 250, 150, 150
	;中伝
	CASE 30
		SETCOLOR 240, 240, 240
	;皆伝
	CASE 573
		SETCOLOR 250, 180, 0
	;overjoy
	CASE 999
		SETCOLOR 255, 255, 255
ENDSELECT

SELECTCASE ARG
	;緑段位
	CASE 1
		PRINT 七級
	CASE 2
		PRINT 六級
	CASE 3
		PRINT 五級
	CASE 4
		PRINT 四級
	CASE 5
		PRINT 三級
	CASE 6
		PRINT 二級
	CASE 7
		PRINT 一級
	;青段位
	CASE 11
		PRINT 初段
	CASE 12
		PRINT 二段
	CASE 13
		PRINT 三段
	CASE 14
		PRINT 四段
	CASE 15
		PRINT 五段
	CASE 16
		PRINT 六段
	CASE 17
		PRINT 七段
	CASE 18
		PRINT 八段
	;赤段位
	CASE 19
		PRINT 九段
	CASE 20
		PRINT 十段
	;中伝・皆伝
	CASE 30
		PRINT 中伝
	CASE 573
		PRINT 皆伝
	;overjoy
	CASE 999
		PRINT (^^)
	;EDIT,無名
	CASE 99
		PRINT EDIT
	CASE 0
		PRINT 無名
ENDSELECT

RESETCOLOR

