@STRATEGY_BROTHEL
#DIM DYNAMIC LCOUNT
#DIM DYNAMIC LRESULT
#DIMS DYNAMIC 定休日設定
CALL BR_ITEM_POINT

SIF 娼館広さ == 0
	娼館広さ = 1
SIF 娼館部屋数 == 0
	娼館部屋数 = 1
SIF 娼館方針 == 0
	娼館方針 = 1

DRAWLINE
PRINT □
SIF 娼館店名 != "娼館"
	PRINTFORM 娼館の店名：%娼館店名% 
PRINTFORM 娼館レベル：{娼館レベル} 運営方針：%娼館方針名(娼館方針)%
IF 娼館方針名(娼館方針) != "ソフト方針"
	PRINT 客の性別：
	SELECTCASE 娼館性別固定
		CASE 0
			PRINT 固定無し
		CASE 1
			PRINT 男性のみ
		CASE 2
			PRINT 女性のみ
	ENDSELECT
ENDIF
PRINTL 

PRINTFORML 　定休日：\@ 娼館定休日 == "" ? 無し # %娼館定休日%曜日 \@
CALL PASELIL, @"　次のランクアップまであと{娼館レベルアップ必要額}＄の売上が必要"
PRINTL 

HTML_PRINT SET_TOOLTIP("　[1] - 道具配置", "娼館に道具を配置します")
HTML_PRINT SET_TOOLTIP("　[2] - 物件増築", "娼館用の物件を改装します")
HTML_PRINT SET_TOOLTIP("　[3] - 運営方針", "娼館の運営方針を決定します")
HTML_PRINT SET_TOOLTIP("　[4] - 人員配置", "娼館で働かせるキャラを配属します")
HTML_PRINT SET_TOOLTIP("　[5] - 店名変更", "娼館の店名を変更します")
HTML_PRINT SET_TOOLTIP("　[8] - 定休日設定", "娼館の定休日を決めます")
IF FLAG:娼館営業中
	HTML_PRINT SET_TOOLTIP("　[9] - 一時休業", "娼館を一時休業し、収入と支出が行われないようにします")
ELSE
	HTML_PRINT SET_TOOLTIP("　[9] - 通常営業", "娼館の営業を再開し、収入と支出が行われるようにします")
ENDIF

DRAWLINE
PRINTPLAIN 　BROTHEL　
PRINT [0] - 戻る
PRINTL 　[100] 各コマンドの説明

DO
	INPUT
	SELECTCASE RESULT
		CASE 0
			RETURN 0
		CASE 1
			CALL BR_ITEM
		CASE 2
			CALL BR_RENOVATION
		CASE 3
			CALL BR_PLAN
		CASE 4
			CALL SELECT_ROOM_BR
		CASE 5
			PRINT □店名を入力してください
			SIF GC店名 != "娼館"
				PRINTFORM  現在の店名：%娼館店名%
			PRINTL 
			PRINTBUTTON "[変更しない]", "変更しない"
			PRINTL 
			INPUTS
			SIF RESULTS == "変更しない"
				RESTART
			PRINTFORMW 店名を「%RESULTS%」に変更しました
			娼館店名 = %RESULTS%
		CASE 8
			VARLINE = 0
			DO
				CALL LOOP_CLEARLINE
				定休日設定 = 
				DRAWLINE
				PRINTL □定休日を選んでください
				PRINTFORML 　[1] - 日曜日（\@ BR定休日("日") ? 定休 # 営業 \@）
				PRINTFORML 　[2] - 月曜日（\@ BR定休日("月") ? 定休 # 営業 \@）
				PRINTFORML 　[3] - 火曜日（\@ BR定休日("火") ? 定休 # 営業 \@）
				PRINTFORML 　[4] - 水曜日（\@ BR定休日("水") ? 定休 # 営業 \@）
				PRINTFORML 　[5] - 木曜日（\@ BR定休日("木") ? 定休 # 営業 \@）
				PRINTFORML 　[6] - 金曜日（\@ BR定休日("金") ? 定休 # 営業 \@）
				PRINTFORML 　[0] - 土曜日（\@ BR定休日("土") ? 定休 # 営業 \@）
				PRINTL 　[9] - 設定終了
				INPUT
				LRESULT = RESULT
				SELECTCASE LRESULT
					CASE 0 TO 6
						FOR LCOUNT, 0, 7
							IF LRESULT == LCOUNT
								IF !BR定休日(DOW(LRESULT))
									娼館定休日 += @"・%DOW(LRESULT)%"
								ELSE
									CONTINUE
								ENDIF
							ENDIF
							IF BR定休日(DOW(LCOUNT))
								IF 定休日設定 == ""
									定休日設定 = %DOW(LCOUNT)%
								ELSE
									定休日設定 += @"・%DOW(LCOUNT)%"
								ENDIF
							ENDIF
						NEXT
						娼館定休日 = %定休日設定%
					CASE 9
						BREAK
				ENDSELECT
			LOOP 1
		CASE 9
			IF FLAG:娼館営業中 > 0
				PRINTW 娼館の経営を一時中断しました
				;定休日じゃない休業は-1
				FLAG:娼館営業中 = -1
			ELSE
				PRINTW 娼館の経営を開始しました
				FLAG:娼館営業中 = DAY
			ENDIF
		CASE 100
			CALL BR_TUTORIAL
		CASEELSE
			CONTINUE
	ENDSELECT
	RESTART
LOOP 1

RESTART

;----------------------------------------------------
;娼館経営モードチュートリアル
;----------------------------------------------------
@BR_TUTORIAL
DRAWLINE
PRINTL 当モードは娼館を経営して資金を稼ぐコマンドです。
PRINTL 現在はキャラと客間の妊娠については非対応です。
PRINTL 
PRINTL [1] - 「道具配置」とは？
PRINTL [2] - 「物件増築」とは？
PRINTL [3] - 「経営方針」とは？
PRINTL [4] - 「人員配置」とは？
DRAWLINE
PRINTPLAIN 　TUTORIAL　
PRINTL [0] - 戻る

CALL INPUTF, 0, 1, 2, 3, 4

SELECTCASE RESULT
	CASE 0
		RETURN 0
	CASE 1
		PRINTL 道具を配置するコマンドです。
		PRINTL 調教用の道具とはまた別物で、娼館で使用するものは配置分だけ毎日コストを支払う必要があります。
		PRINTL 道具にはそれぞれ用途に合わせたポイントがあり、経営方針に見合った道具を配置することで収入にプラスの補正が入ります。
		PRINTW デフォルトでは1種類しか配置できませんが、増築することによって配置可能な数が増えます。
	CASE 2
		PRINTL 物件を増築し、より多くの道具や奴隷を配置できるようにするコマンドです。
		PRINTL ゲームセンター経営と違い、物件はデフォルトで所持しているので経営自体はすぐに始められます。
		SIF !ORIGIN
			PRINTW 増築には当然お金がかかりますが、序盤は小規模でも特に気になるものではないと思います。
	CASE 3
		PRINTL 運営方針を決めるコマンドです。
		PRINTL 運営には方針が必要であり、これを決めないとほとんど経営放棄も同然です。
		PRINTW 奴隷の身体をよく案じて考えて、適切な方針を定めましょう。
	CASE 4
		PRINTL 奴隷から人員を選出するコマンドです。
		PRINTL 当然身体を売る奴隷がいないと収入はありません。売春を行ったキャラは、売春の回数に応じて売却額が下がっていきます。
		PRINTL 体力が減っている、もしくはストレス過多の奴隷は配置しても売春できないため、奴隷の身体をちゃんと考えてあげましょう。
		PRINTW (数値上1000以上減っていると自動で休憩に入り、回復後に売春を行います)
ENDSELECT

RESTART

@BR_ITEM
#DIM DYNAMIC LCOUNT
#DIM DYNAMIC LRESULT
#DIM DYNAMIC 娼館道具設置数
#DIM DYNAMIC 表示数

CALL BR_ITEM_POINT
PRINTL □道具を配置します
DRAWLINE
PRINTL 【現在のポイント】
PRINTFORMLC ソフト - {ソフトポイント}
PRINTFORMLC ハード - {ハードポイント}
PRINTFORMLC SM - {SMポイント}
PRINTFORMLC 狂気 - {狂気ポイント}
PRINTL 
DRAWLINE

娼館道具設置数 = 0
FOR LCOUNT, GETNUM(ITEM, "娼館ローター"), GETNUM(ITEM, "お風呂場")
	SIF ITEM:LCOUNT
		娼館道具設置数++
NEXT
PRINT  *配置枠*［
表示数 = 0
REPEAT 娼館広さ
	IF 表示数 < 娼館道具設置数
		SETCOLOR 0 , 100 , 250
			PRINT ■
		RESETCOLOR
	ELSE
		SETCOLOR 120 , 120 , 120
			PRINT ■
		RESETCOLOR
	ENDIF
	表示数++
REND
PRINTL ］
DRAWLINE
表示数 = 0
FOR LCOUNT, GETNUM(ITEM, "娼館ローター"), GETNUM(ITEM, "お風呂場")
	SIF ITEMNAME:LCOUNT == ""
		CONTINUE
	SIF 表示数%3 == 0
		PRINT 　
	PRINTFORM [{LCOUNT}] %SUBSTRINGU(ITEMNAME:LCOUNT, 2, -1)%
	SIF !ORIGIN
		CALL PASELI, @" 維持費:{ITEMPRICE:LCOUNT}＄"
	IF ITEM:LCOUNT == 0
		PRINT 【
		SETCOLOR 120 , 120 , 120
			PRINT 未配置
		RESETCOLOR
		PRINT 】
	ELSE
		PRINT 【
		SETCOLOR 0 , 100 , 250
			PRINT 配置中
		RESETCOLOR
		PRINT 】
	ENDIF
	表示数++
	SIF 表示数%3 == 0
		PRINTL 
NEXT
PRINTL 
DRAWLINE
PRINTPLAIN 　PERSONAL　
PRINTL [100] - 戻る

DO
	INPUT
	LRESULT = RESULT
	SELECTCASE LRESULT
		CASE 100
			RETURN 0
		CASEELSE
			SIF ITEMNAME:LRESULT == ""
				CONTINUE
			IF ITEM:LRESULT == 0
				IF 娼館道具設置数 >= 娼館広さ
					PRINTW 【これ以上配置できません】
				ELSE
					PRINTFORMW %SUBSTRINGU(ITEMNAME:LRESULT, 2, -1)%を配置しました
					ITEM:LRESULT = 1
					IF FLAG:パートナー > 0
						SIF FLAG:口上表示 && !CFLAG:GETCHARA(FLAG:パートナー):口上非表示
							TRYCALLFORM BR_ITEM_%CSVNAMERPS(FLAG:パートナー)%, LRESULT
					ENDIF
				ENDIF
			ELSE
				PRINTFORMW %SUBSTRINGU(ITEMNAME:LRESULT, 2, -1)%を回収しました
				ITEM:LRESULT = 0
			ENDIF
			RESTART
	ENDSELECT
LOOP 1

@PRINT_BR_ITEM
#DIM DYNAMIC LCOUNT
#DIM DYNAMIC 文字数
#DIM DYNAMIC 表示数

PRINTFORML 【設備】
FOR LCOUNT, GETNUM(ITEM, "お風呂場"), GETNUM(ITEM, "わけのわからないもの")+1
	SIF ITEMNAME:LCOUNT == ""
		CONTINUE
	SIF ITEM:LCOUNT == 0
		CONTINUE
	SIF 文字数 == 0
		PRINT 　
	PRINTFORM [%ITEMNAME:LCOUNT%]
	文字数 += STRLENS(ITEMNAME:LCOUNT)
	IF 文字数 > 80
		PRINTL 
		文字数 = 0
	ENDIF
	表示数++
NEXT
SIF !表示数
	PRINT 　[設備無し]
CALL NEWLINE

;娼館増設----------------------------------------------------
@BR_RENOVATION
#DIM DYNAMIC 費用, 2

費用 = POWER(娼館広さ, 2)*10000
費用:1 = POWER(2, 娼館部屋数)*10000
PRINTL □物件を増設します
PRINTFORMLC 　広さ:{娼館広さ}
PRINTFORMLC 部屋数:{娼館部屋数}
PRINTL 
DRAWLINE
CALL PRINT_BR_ITEM
DRAWLINE

IF ORIGIN
	娼館広さ = 10
	娼館部屋数 = 20
ENDIF

IF 娼館広さ >= 10
	SETCOLORBYNAME gray
	PRINTPLAIN 　[-] - これ以上広く出来ません
	PRINTL 
	RESETCOLOR
ELSE
	CALL PASELIL, @"　[1] - 広くする({費用}＄)"
ENDIF
IF 娼館部屋数 >= 20
	SETCOLORBYNAME gray
	PRINTPLAIN 　[-] - これ以上部屋を増やせません
	PRINTL 
	RESETCOLOR
ELSE
	CALL PASELIL, @"　[2] - 部屋を増やす({費用:1}＄)"
ENDIF
PRINTFORML 　[3] - 設備を導入する
DRAWLINE
PRINTPLAIN 　RENOVATION　
PRINTL [0] - 戻る

CALL INPUTF, 0, 1, 2, 3

SELECTCASE RESULT
	CASE 0
		RETURN 0
	CASE 1
		SIF 娼館広さ >= 10
			RESTART
		IF 費用 > MONEY
			PRINTW 所持金が足りません
			RESTART
		ENDIF
		PRINTL 娼館を広くしますか？
		PRINTFORML 広さ {娼館広さ}→{娼館広さ+1}
		CALL PASELIL, @"増設後の所持金 {MONEY-費用}＄"
		PRINTL 
		PRINTL [0] - はい
		PRINTL [1] - いいえ
		CALL INPUTF, 0, 1
		SELECTCASE RESULT
			CASE 0
				PRINTW 娼館を広くしました
				MONEY -= 費用
				CALL 現金出納帳記録, @"娼館改築/-{費用}"
				娼館広さ++
				IF FLAG:パートナー > 0
					SIF FLAG:口上表示 && !CFLAG:GETCHARA(FLAG:パートナー):口上非表示
						TRYCALLFORM BR_RENOVATION_%CSVNAMERPS(FLAG:パートナー)%, 1
				ENDIF
		ENDSELECT
		RESTART
	CASE 2
		SIF 娼館部屋数 >= 20
			RESTART
		IF 費用:1 > MONEY
			PRINTW 所持金が足りません
			RESTART
		ENDIF
		PRINTL 娼館の部屋を増やしますか？
		PRINTFORML 部屋数 {娼館部屋数}→{娼館部屋数+1}
		CALL PASELIL, @"増設後の所持金 {MONEY-費用:1}＄"
		PRINTL 
		PRINTL [0] - はい
		PRINTL [1] - いいえ
		CALL INPUTF, 0, 1
		SELECTCASE RESULT
			CASE 0
				PRINTW 娼館の部屋を増やしました
				MONEY -= 費用:1
				CALL 現金出納帳記録, @"娼館改築/-{費用:1}"
				娼館部屋数++
				IF FLAG:パートナー > 0
					SIF FLAG:口上表示 && !CFLAG:GETCHARA(FLAG:パートナー):口上非表示
						TRYCALLFORM BR_RENOVATION_%CSVNAMERPS(FLAG:パートナー)%, 2
				ENDIF
		ENDSELECT
		RESTART
	CASE 3
		CALL BR_ITEM_BUY
ENDSELECT

;設備導入----------------------------------------------------
@BR_ITEM_BUY
#DIM DYNAMIC 表示数
#DIM DYNAMIC LCOUNT, 2
#DIM DYNAMIC 単位文字数
#DIMS DYNAMIC 表示用
#DIM DYNAMIC LRESULT

表示数 = 0
DRAWLINE
PRINTL □設備を導入します
DRAWLINE
CALL PRINT_BR_ITEM
DRAWLINE

FOR LCOUNT, GETNUM(ITEM, "お風呂場"), GETNUM(ITEM, "わけのわからないもの")+1
	SIF ITEMNAME:LCOUNT == ""
		CONTINUE
	SIF 表示数 == 0
		PRINT 　
	IF ITEM:LCOUNT
		SETCOLORBYNAME gray
		PRINTFORMLC [導入済み] %ITEMNAME:LCOUNT%
		RESETCOLOR
	ELSE
		表示用 = [{LCOUNT}] %ITEMNAME:LCOUNT%\@ !ORIGIN ? ({ITEMPRICE:LCOUNT}＄)#\@
		IF ORIGIN
			PRINTFORMLC %表示用%
		ELSE
			CALL PASELI, 表示用
			;PRINT_IMGでPRINTC系命令使うとエラーになるので疑似再現
			IF FLAG:パセリ表示
				単位文字数 = 2
			ELSEIF 通貨単位 != ""
				単位文字数 = STRLENS(通貨単位)
			ELSE
				単位文字数 = 1
			ENDIF
			;＄の分2文字と通貨単位分
			FOR LCOUNT:1, 0, 28-(STRLENS(表示用)-2)-単位文字数
				PRINT  
			NEXT
		ENDIF
	ENDIF
	表示数++
	IF 表示数 == 4
		CALL NEWLINE
		表示数 = 0
	ENDIF
NEXT
CALL NEWLINE

DRAWLINE
PRINTPLAIN 　ITEM　
PRINTL [0] - 戻る

DO
	INPUT
	SELECTCASE RESULT
		CASE 0
			RETURN 0
		CASEELSE
			SIF ITEMNAME:RESULT == ""
				CONTINUE
			SIF ITEM:RESULT
				CONTINUE
			IF ITEMPRICE:RESULT > MONEY && !ORIGIN
				PRINTW 所持金が足りません
				RESTART
			ENDIF
			DRAWLINE
			LRESULT = RESULT
			PRINTFORM %ITEMNAME:RESULT%:
			SELECTCASE ITEMNAME:RESULT
				CASE "お風呂場"
					PRINTL 性行為の前には体を洗いましょう
				CASE "高級ベッド"
					PRINTL 広々とした空間で新たなプレイを
				CASE "隠しカメラ"
					PRINTL マジックミラーの後ろに仕込む隠しカメラ
				CASE "換気扇"
					PRINTL 臭いと不快感を減らす
				CASE "ピンクライト"
					PRINTL 売春の雰囲気UP!
				CASE "防音壁"
					PRINTL 外に声が漏れないので遠慮なく楽しめます
				CASE "拷問器具"
					PRINTL 普通のSMプレイにも飽きた人へ
				CASE "わけのわからないもの"
					PRINTL わけのわからない人たちが使う
			ENDSELECT
			SIF !ORIGIN
				CALL PASELIL, @"導入後の所持金 {MONEY}＄→{MONEY-ITEMPRICE:RESULT}＄"
			PRINTL [0] - 導入する
			PRINTL [1] - 導入しない
			CALL INPUTF, 0, 1
			SELECTCASE RESULT
				CASE 0
					PRINTFORMW %ITEMNAME:LRESULT%を導入しました
					ITEM:LRESULT = 1
					MONEY -= ITEMPRICE:LRESULT
					CALL 現金出納帳記録, @"「%ITEMNAME:LRESULT%」購入/-{ITEMPRICE:LRESULT}"
					IF FLAG:パートナー > 0
						SIF FLAG:口上表示 && !CFLAG:GETCHARA(FLAG:パートナー):口上非表示
							TRYCALLFORM BR_ITEM_%CSVNAMERPS(FLAG:パートナー)%, LRESULT
					ENDIF
			ENDSELECT
			RESTART
	ENDSELECT
LOOP 1


;運営方針----------------------------------------------------
@BR_PLAN
#DIM DYNAMIC 現上級娼婦
;CALL BR_ITEM_POINT
DRAWLINE
PRINTL 【現在のポイント】
PRINTFORMLC 　ソフト - {ソフトポイント}
PRINTFORMLC ハード - {ハードポイント}
PRINTFORMLC SM - {SMポイント}
PRINTFORMLC 狂気 - {狂気ポイント}
PRINTL 
DRAWLINE
PRINTFORM □現在の方針：%娼館方針名(娼館方針)% 客の性別：
SIF 娼館方針名(娼館方針) == "ソフト方針"
	SETCOLORBYNAME gray
SELECTCASE 娼館性別固定
	CASE 0
		PRINT 固定無し
	CASE 1
		PRINT 男性のみ
	CASE 2
		PRINT 女性のみ
ENDSELECT
SIF 娼館方針名(娼館方針) == "ソフト方針"
	PRINT (ソフト方針では男性客のみの対応となります)
PRINTL
RESETCOLOR

;PRINTL 　[0] - 方針無し
PRINTL 　[1] - ソフト方針
PRINTL 　[2] - ハード方針
PRINTL 　[3] - SM方針
PRINTL 　[4] - 狂気方針
PRINTL 　[5] - 客の性別を固定しない
PRINTL 　[6] - 男性客専門店にする
PRINTL 　[7] - 女性客専門店にする
PRINTFORML 　[8] - プレイ内容を報告させる（現在\@ FLAG:娼館報告 ? オン # オフ \@）
PRINTFORML 　[9] - 上級娼婦を任命する（現在の上級娼婦:\@ FINDCHARA(CFLAG:上級娼婦, 1) >= 0 ? %NAME:(FINDCHARA(CFLAG:上級娼婦, 1))% # 無し\@）
DRAWLINE
PRINTPLAIN 　PLAN　
PRINT [0] 戻る 
PRINTL [20] 各方針の説明

INPUT
SELECTCASE RESULT
	CASE 0
		RETURN
	CASE 1 TO 4
		娼館方針 = RESULT
		IF FLAG:パートナー > 0
			SIF FLAG:口上表示 && !CFLAG:GETCHARA(FLAG:パートナー):口上非表示
				TRYCALLFORM BR_PLAN_%CSVNAMERPS(FLAG:パートナー)%, RESULT
		ENDIF
	CASE 5 TO 7
		娼館性別固定 = RESULT-5
	CASE 8
		INVERTBIT FLAG:娼館報告, 0
	CASE 9
		現上級娼婦 = FINDCHARA(CFLAG:上級娼婦, 1)
		SIF 現上級娼婦 >= 0
			CFLAG:現上級娼婦:上級娼婦 = 0
		DRAWLINE
		PRINTL □上級娼婦に任命したいキャラを選択してください
		FOR PAGING, 0, CHARANUM
			CALL PAGING, CSTR:PAGING:配属 == "娼館" && FALLTYPE(PAGING) == 2, "", "上級娼婦", "任命しない"
		NEXT
		SELECTCASE RESULT
			CASE -1
				PRINTW 上級娼婦を任命しません
			CASEELSE
				PRINTFORMW %CALLNAME:RESULT%を上級娼婦に任命します
				CFLAG:RESULT:上級娼婦 = 1
				SIF !CFLAG:RESULT:上級娼婦に任命された経験
					CFLAG:RESULT:名刺 = 5
				CFLAG:RESULT:上級娼婦に任命された経験++
		ENDSELECT
	CASE 20
		PRINTL 0-方針無し
		PRINTL ├特に方針を指定しません。初期設定でもあります。
		PRINTL ├無計画ということなので方針としての効果は皆無。
		PRINTL └何かしら方針は定めたほうが良いでしょう。
		PRINTL 
		PRINTL 1-ソフト売春
		PRINTL ├本番無しなど店側の制約を多く設けた方針です。
		PRINTL ├体力や気力の消費が軽く経験の浅い奴隷でもそれなりの効果があります。
		PRINTL └しかし基本的に経験が上がりにくく、調教としての効果は薄いかもしれません。
		PRINTL 
		PRINTL 2-ハード方針
		PRINTL ├経験豊富で淫乱な奴隷ほど効果が高まる方針です。
		PRINTL ├各種経験に多めの数値が入り、収入も安定しています。
		PRINTL └経験が浅く適正でない奴隷の場合、収入も低く体力消費も大きいため序盤にはおすすめできません。
		PRINTL 
		PRINTL 3-SM方針
		PRINTL ├いろいろとマニアックなプレイを専門とする方針です。
		PRINTL ├一部素質で強力なプラス補正がかかり、逆にこういったプレイに向かない奴隷の場合は
		PRINTL └多大な体力消費など、マイナスの効果が大きいかもしれません。
		PRINTL 
		PRINTL 4-狂気方針
		PRINTL ├ごく一部の稀有なクライアント向けの方針です。
		PRINTL ├脱法的な経営なので、客は少なく、ランクが低いとまったく収入がありません。
		PRINTL └崩壊した奴隷や特殊な素質を持った奴隷の効果が高く、玄人向けの方針といえるでしょう。
		PRINTL 
		PRINTL 5-プレイ内容を報告させる
		PRINTL ├売春での奉仕内容を収入計算時に報告させます。
		PRINTL └オンオフで収入に違いは無いので奴隷の動向が気になるならオンにしてみましょう。
		PRINTL 
		PRINTL 6-上級娼婦を任命する
		PRINTL ├淫乱、もしくは娼婦の素質を持ったキャラを上級娼婦に任命できます。
		PRINTL ├上級娼婦に任命されたキャラは、売春中にプレイアブル可能になります。
		PRINTL ├運営方針に応じて可能な行為、効果的な行為が変わり、お客様の満足度によって得られる報酬も増減します。
		PRINTW └お客様とのより濃厚な売春を楽しみたいならぜひ任命してみましょう。
ENDSELECT

RESTART

;道具名----------------------------------------------------
@BR_ITEM_POINT
#DIM DYNAMIC LCOUNT
ソフトポイント = 0
ハードポイント = 0
SMポイント = 0
狂気ポイント = 0

FOR LCOUNT, GETNUM(ITEM, "娼館ローター"), GETNUM(ITEM, "お風呂場")
	SIF ITEMNAME:LCOUNT == ""
		CONTINUE
	SIF !ITEM:LCOUNT
		CONTINUE
	SELECTCASE ITEMNAME:LCOUNT
		CASE "娼館ローター"
			ソフトポイント += 20
			ハードポイント += 10
			狂気ポイント += 5
		CASE "娼館バイブ"
			ハードポイント += 10
			SMポイント += 20
			狂気ポイント += 15
		CASE "娼館鞭"
			SMポイント += 30
			狂気ポイント += 20
		CASE "娼館縄"
			SMポイント += 25
			狂気ポイント += 35
		CASE "娼館ペニスバンド"
			ハードポイント += 10
			SMポイント += 30
			狂気ポイント += 5
		CASE "娼館コンドーム"
			ソフトポイント += 5
			ハードポイント += 20
			SMポイント += 15
			狂気ポイント += 5
		CASE "娼館ローション"
			ソフトポイント += 15
			ハードポイント += 20
			SMポイント += 10
			狂気ポイント += 5
		CASE "娼館媚薬"
			ソフトポイント += 20
			ハードポイント += 40
			SMポイント += 35
			狂気ポイント += 30
		CASE "娼館睡眠薬"
			ハードポイント += 5
			SMポイント += 10
			狂気ポイント += 30
		CASE "娼館ゴム手袋"
			ソフトポイント += 15
			狂気ポイント += 5
	ENDSELECT
NEXT

SIF ITEM:ピンクライト
	TIMES ソフトポイント , 1.50
SIF ITEM:防音壁
	TIMES ハードポイント , 1.50
SIF ITEM:拷問器具
	TIMES SMポイント , 1.50
SIF ITEM:わけのわからないもの
	TIMES 狂気ポイント , 1.50


;人員配置----------------------------------------------------
@SELECT_ROOM_BR
#DIM DYNAMIC LCOUNT
#DIM DYNAMIC 娼館部屋状態, 21, 2
#DIM DYNAMIC 選択部屋
#DIM DYNAMIC 部屋番号
DRAWLINE

VARSET 娼館部屋状態:0:0, 0

FOR LCOUNT, 0, CHARANUM
	IF CSTR:LCOUNT:配属 == "娼館"
		部屋番号 = CFLAG:LCOUNT:娼館部屋番号
		IF 娼館部屋状態:部屋番号:0 == 0
			娼館部屋状態:部屋番号:0 = LCOUNT
		ELSE
			娼館部屋状態:部屋番号:1 = LCOUNT
		ENDIF
	ENDIF
NEXT

PRINTL □キャラを配属させる部屋を選んでください
FOR LCOUNT, 1, 娼館部屋数+1
	PRINTFORM 　[{LCOUNT}] {LCOUNT}番ルーム(
	IF 娼館部屋状態:LCOUNT:0
		PRINTFORM %CALLNAME:(娼館部屋状態:LCOUNT:0)%
		SIF 娼館部屋状態:LCOUNT:1
			PRINTFORM と%CALLNAME:(娼館部屋状態:LCOUNT:1)%
		PRINTL が待機中)
	ELSE
		PRINTL 空き部屋)
	ENDIF
NEXT
DRAWLINE
PRINTPLAIN 　娼館配属　
PRINTL [0] 戻る

DO
	INPUT
	選択部屋 = RESULT
	SIF 選択部屋 == 0
		RETURN
	SIF !INRANGE(選択部屋, 1, 娼館部屋数)
		CONTINUE
	
	IF 娼館部屋状態:選択部屋:0 && 娼館部屋状態:選択部屋:1
		PRINTFORML これ以上{選択部屋}番ルームには配属できません
		PRINTL [0] - 仕方ないな
		PRINTL [1] - その部屋に配属してるキャラを外してくれ
		CALL INPUTF, 0, 1
		IF RESULT == 1
			CALL 配属解除, 娼館部屋状態:選択部屋:0
			CALL 配属解除, 娼館部屋状態:選択部屋:1
		ENDIF
		RESTART
	ENDIF
	CALL STRATEGY_PERSONAL, "娼館", RESULT
	RESTART
LOOP 1

;収入計算----------------------------------------------------
@INCOME_BR
#DIM DYNAMIC LCOUNT
#DIM DYNAMIC LCOUNT2
#DIM DYNAMIC 収入合計
#DIM DYNAMIC 支出
#DIM DYNAMIC LTARGET
#DIM DYNAMIC LMASTER
#DIM DYNAMIC LASSI
#DIM DYNAMIC 部屋配属人数
#DIM DYNAMIC 対象
#DIM DYNAMIC ノルマ

CVARSET 通常出勤

対象 = FINDCHARA(CFLAG:上級娼婦, 1)
IF 対象 >= 0
	;方針設定してないとダメ
	SIF 娼館方針 == 0
		GOTO 通常営業
	;体力不足
	IF BASE:対象:体力 <= 1000
		PRINTFORML %CALLNAME:対象%は疲労で娼館を休みました
		CFLAG:対象:休憩 = 1
		GOTO 通常営業
	ENDIF
	IF CFLAG:対象:ストレス値 > 300 && !TALENT:対象:崩壊
		PRINTFORML %CALLNAME:対象%はストレス過多のため、娼館を休みました
		CFLAG:対象:休憩 = 1
		GOTO 通常営業
	ENDIF
	;サボり魔はモチベに応じてサボる
	IF サボり判定(LCOUNT)
		PRINTFORML %CALLNAME:対象%は売春をサボりました
		CFLAG:対象:ストレス値 -= 5
		CFLAG:対象:休憩 = 1
		GOTO 通常営業
	ENDIF
	LTARGET = TARGET
	LMASTER = MASTER
	LASSI = ASSI
	CALL 上級売春
	TARGET = LTARGET
	MASTER = LMASTER
	ASSI = LASSI
ENDIF

$通常営業

FOR LCOUNT, 1, 娼館部屋数+1
	CALL CHECKDRAWLINE
	部屋配属人数 = 0
	FOR LCOUNT2, 1, CHARANUM
		;当然配属してないとダメ
		SIF CSTR:LCOUNT2:配属 != "娼館"
			CONTINUE
		;部屋番号違うならダメ
		SIF CFLAG:LCOUNT2:娼館部屋番号 != LCOUNT
			CONTINUE
		;配属完了してないとダメ 娼館なだけに召喚酔いってか
		SIF !CFLAG:LCOUNT2:配属完了
			GOTO 売春不可
		;休憩フラグ立ってるキャラの部屋は売春不可なので除外
		SIF CFLAG:LCOUNT2:休憩
			GOTO 売春不可
		;上級娼婦は上で処理してるので除外
		SIF CFLAG:LCOUNT2:上級娼婦 && 娼館方針
			GOTO 売春不可
		;以下、売春できないキャラが居る部屋は収入の対象にならない
		;体力不足
		IF BASE:LCOUNT2:体力 <= 1000
			PRINTFORML %CALLNAME:LCOUNT2%は疲労で娼館を休みました
			GOTO 売春不可
		ENDIF
		;ストレス高
		IF CFLAG:LCOUNT2:ストレス値 > 300 && !TALENT:LCOUNT2:崩壊
			PRINTFORML %CALLNAME:LCOUNT2%はストレス過多のため、娼館を休みました
			GOTO 売春不可
		ENDIF
		;サボり魔はモチベに応じてサボる
		IF サボり判定(LCOUNT2)
			PRINTFORML %CALLNAME:LCOUNT2%は売春をサボりました
			CFLAG:LCOUNT2:休憩 = 1
			GOTO 売春不可
		ENDIF
		;上記の要素をすべてクリアしたキャラにフラグを立てる
		通常出勤:LCOUNT2:0 = 1
		部屋配属人数++
		;ついでにストレスも下げておく
		IF TALENT:LCOUNT2:淫乱
			CFLAG:LCOUNT2:ストレス値 -= 10
		ELSEIF TALENT:LCOUNT2:娼婦
			CFLAG:LCOUNT2:ストレス値 -= 15
		ENDIF
	NEXT

	;上記のループを抜けられたならこの部屋は売春可能 部屋の配属人数に応じて関数を呼ぶ
	SELECTCASE 部屋配属人数
		;ソロ
		CASE 1
			CALL ソロ売春, LCOUNT
			収入合計 += RESULT
			CONTINUE
		CASE 2
			CALL ペア売春, LCOUNT
			収入合計 += RESULT
			CONTINUE
	ENDSELECT
	
	$売春不可
	;ここに到達した場合はその部屋は売春不可能なので休憩フラグを立てる
	FOR LCOUNT2, 1, CHARANUM
		SIF CSTR:LCOUNT2:配属 != "娼館"
			CONTINUE
		IF CFLAG:LCOUNT2:娼館部屋番号 == LCOUNT
			CFLAG:LCOUNT2:休憩 = 1
			CFLAG:LCOUNT2:配属完了 = 1
			CONTINUE
		ENDIF
	NEXT
NEXT

CALL CHECKDRAWLINE

;方針とポイントに応じて上下する
SELECTCASE 娼館方針
	;ソフト
	CASE 1
		収入合計 += 収入合計*ソフトポイント/100
	;ハード
	CASE 2
		収入合計 += 収入合計*ハードポイント/100
	;SM
	CASE 3
		収入合計 += 収入合計*SMポイント/100
	;狂気
	CASE 4
		収入合計 += 収入合計*狂気ポイント/100
ENDSELECT

;隠し撮りビデオを売却して追加報酬
SIF ITEM:隠しカメラ
	収入合計 += 収入合計/10

;娼館にいる上級売春をしているキャラを除くキャラ同士の相性値をすべて掛け算する
;(オーバーフローしないように対数を使用)
;FOR LCOUNT, 1, CHARANUM
;	IF 通常出勤:LCOUNT:0
;		FOR LCOUNT2, LCOUNT+1, CHARANUM
;			IF 通常出勤:LCOUNT2:0
;				LOCAL = RELATION:LCOUNT:(NO:LCOUNT2)+RELATION:LCOUNT2:(NO:LCOUNT)
;				相性指数 += HLOG2(LOCAL/2)
;			ENDIF
;		NEXT
;	ENDIF
;NEXT
;収入合計 *= HPOW2(相性指数)
;収入合計 /= 100

IF 収入合計
	CALL PASELIL, @"%娼館店名%の収入が{収入合計}＄入りました"
	MONEY += 収入合計
	娼館前日の収入 = 収入合計
	娼館総収入 += 収入合計
	バンめし = 0
	DO
		ノルマ = 0
		;高級ベッドがあるとレベルが上がりやすくなる
		IF ITEM:高級ベッド
			ノルマ = 700*POWER(娼館レベル, 2)
		ELSE
			ノルマ = 1000*POWER(娼館レベル, 2)
		ENDIF
		SIF 娼館総収入 >= ノルマ
			娼館レベル++
	LOOP 娼館総収入 >= ノルマ

	娼館レベルアップ必要額 = ノルマ-娼館総収入

	FOR LCOUNT, 1500, 1580
		IF ITEM:LCOUNT
			支出 += ITEMPRICE:LCOUNT
			支出 += ITEMPRICE:LCOUNT/5*浪費癖人数("娼館")
		ENDIF
	NEXT
	SIF 支出
		CALL PASELIL, @"%娼館店名%の支出は{支出}＄でした"
	MONEY -= 支出
	CALL 現金出納帳記録, @"娼館収支/{収入合計-支出}"
ENDIF


@ソロ売春, ARG
#DIM DYNAMIC 収入
#DIM DYNAMIC 適性
#DIM DYNAMIC 不適性
#DIM DYNAMIC 娼婦

#DIM DYNAMIC 客の性別
#DIM DYNAMIC 絶頂
#DIM DYNAMIC 射精
#DIM DYNAMIC 客の射精
#DIM DYNAMIC 自慰
#DIM DYNAMIC 自慰で射精
#DIM DYNAMIC フェラ
#DIM DYNAMIC フェラで射精
#DIM DYNAMIC ヴァギナ
#DIM DYNAMIC 中出し
#DIM DYNAMIC アナル
#DIM DYNAMIC アナル中出し
#DIM DYNAMIC 手コキ
#DIM DYNAMIC 手コキで射精
#DIM DYNAMIC 足コキ
#DIM DYNAMIC 足コキで射精
#DIM DYNAMIC 兜合わせ
#DIM DYNAMIC 兜合わせで射精
#DIM DYNAMIC 素股
#DIM DYNAMIC 素股で射精
#DIM DYNAMIC ゲイ
#DIM DYNAMIC レズ

娼婦 = FINDCHARA(CFLAG:娼館部屋番号, ARG)

;1000パセリは保証
収入 = 1000
CALL 娼婦補正, 娼婦
収入 += RESULT
;プレミアムフライデー
SIF PREMIUM_FRIDAY(YEAR, MONTH, DAYS)
	TIMES 収入, 1.10

SELECTCASE 娼館方針
	CASE 1
		絶頂 = RAND:6
		;射精 = RAND:6
		自慰 = RAND:4
		SIF 自慰 && PENIS(娼婦)
			自慰で射精 = RAND:2
		フェラ = RAND:8+3
		フェラで射精 = RAND:3
		IF PENIS(娼婦)
			兜合わせ = RAND:3
			SIF 兜合わせ
				兜合わせで射精 = RAND:2
			射精 = RAND:3+自慰で射精
		ELSE
			素股 = RAND:3
			SIF 素股
				素股で射精 = RAND:2
		ENDIF
		足コキ = RAND:3
		SIF 足コキ == 2
			足コキで射精 = RAND:2
		手コキ = RAND:3
		SIF 手コキ == 2
			手コキで射精 = RAND:2
		SIF SEX(娼婦) == 1
			ゲイ = RAND:4+1
		客の射精 = フェラで射精+手コキで射精+足コキで射精
	CASE 2
		;稀にふたなり女性客が来る
		SIF RAND:5 == 0
			客の性別 = 3
		;女性固定の場合はふたなりのみ
		SELECTCASE 娼館性別固定
			CASE 1
				客の性別 = 0
			CASE 2
				客の性別 = 3
		ENDSELECT
		IF VAGINA(娼婦)
			ヴァギナ = RAND(1, 11)
		ELSE
			アナル = RAND(1, 11)
		ENDIF
		絶頂 = RAND:6
		フェラ = RAND:2
		フェラで射精 = フェラ
		SIF アナル
			アナル中出し = RAND:3
		SIF ヴァギナ && 客の性別 != 2
			中出し = RAND:3
		SIF PENIS(娼婦)
			射精 = RAND:6
		SELECTCASE SEX(娼婦)
			CASE 1
				SIF 客の性別 <= 1
					ゲイ = RAND:10+3
			CASE 2
				SIF 客の性別 >= 2
					レズ = RAND:10+3
		ENDSELECT
		SIF ヴァギナ == 0 && アナル == 0
			アナル++
		客の射精 = 中出し+アナル中出し+フェラで射精
	CASE 3
		客の性別 = RAND:4
		SELECTCASE 娼館性別固定
			CASE 1
				客の性別 = 0
			CASE 2
				客の性別 = RAND(2, 4)
		ENDSELECT
		;たまにマゾが来る
		IF 客の性別 != 2 && RAND:5 == 0
			手コキで射精 = RAND:3+1
			手コキ = 手コキで射精
			足コキで射精 = RAND:3+1
			足コキ = 足コキで射精
		ELSE
			アナル = RAND:4
			SIF VAGINA(娼婦)
				ヴァギナ = RAND:4
			絶頂 = RAND:4
			自慰 = RAND:4+3
			SIF 自慰 && PENIS(娼婦)
				自慰で射精 = RAND:3
			SIF アナル && RAND:4 == 0
				アナル中出し = 1
			SIF ヴァギナ && 客の性別 != 2 && RAND:3 == 0
				中出し = 1
			SIF アナル == 0 && ヴァギナ == 0
				アナル++
			客の射精 = RAND:2
		ENDIF
		SIF PENIS(娼婦)
			射精 = RAND:6+自慰で射精
		SIF 客の性別 != 2
			フェラ = RAND:4
		SIF フェラ
			フェラで射精 = RAND:フェラ
		SELECTCASE SEX(娼婦)
			CASE 1
				SIF 客の性別 <= 1
					ゲイ = RAND:4+2
			CASE 2
				SIF 客の性別 >= 2
					レズ = RAND:4+2
		ENDSELECT
		客の射精 = 中出し+アナル中出し+手コキで射精+足コキで射精+フェラで射精
	CASE 4
		客の性別 = RAND:4
		SELECTCASE 娼館性別固定
			CASE 1
				客の性別 = 0
			CASE 2
				客の性別 = RAND(2, 4)
		ENDSELECT
		SIF VAGINA(娼婦)
			ヴァギナ = RAND:26+5
		アナル = RAND:26+5
		SIF 客の性別 != 2
			客の射精 = RAND:2
		SIF PENIS(娼婦)
			射精 = RAND:11
		SELECTCASE SEX(娼婦)
			CASE 1
				SIF 客の性別 <= 1
					ゲイ = RAND:10+1
			CASE 2
				SIF 客の性別 >= 2
					レズ = RAND:10+1
		ENDSELECT
ENDSELECT

IF FLAG:娼館報告 && 娼館方針
	IF FLAG:口上表示
		TRYCCALLFORM BR_PLAY_%CSVNAMERPS(NO:娼婦)%, 客の性別, 絶頂, 射精, 客の射精, 自慰, 自慰で射精, フェラ, フェラで射精, ヴァギナ, 中出し, アナル, アナル中出し, 手コキ, 手コキで射精, 足コキ, 足コキで射精, 兜合わせ, 兜合わせで射精, 素股, 素股で射精, ゲイ, レズ, 
		CATCH
			$NOTKOJO
			PRINTFORML %CALLNAME:娼婦%が今日の仕事を報告してきた。
			PRINTFORM %CALLNAME:娼婦%は
			SIF 娼館方針 == 3 && 手コキで射精
				PRINT マゾヒストの
			SELECTCASE 客の性別
				CASE IS <= 1
					PRINT 男性客を相手に
				CASE 2
					PRINT 女性客を相手に
				CASE 3
					PRINT ふたなり女性客を相手に
			ENDSELECT
			IF 客の性別 != 2
				IF フェラ
					PRINT 口で奉仕
					IF フェラで射精
						PRINTFORM して{フェラで射精}回射精させた
					ELSE
						PRINT した
					ENDIF
					IF ヴァギナ || アナル || 手コキ || 足コキ || 素股 || 兜合わせ
						PRINT 後、
					ELSE
						PRINT 。
					ENDIF
				ENDIF
				IF 手コキ || 足コキ
					IF 手コキ && 足コキ
						IF 手コキで射精 && 足コキで射精
							PRINTFORM 手で{手コキで射精}回、足で{足コキで射精}回イかせ
						ELSEIF 手コキで射精 || 足コキで射精
							PRINTFORM 手と足で扱いて{手コキで射精+足コキで射精}回イかせ
						ELSE
							PRINTFORM 手と足で扱
						ENDIF
					ELSEIF 手コキ
						IF 手コキで射精
							PRINTFORM 手で{手コキで射精}回イかせ
						ELSE
							PRINT 手で扱
						ENDIF
					ELSEIF 足コキ
						IF 足コキで射精
							PRINTFORM 足で{足コキで射精}回イかせ
						ELSE
							PRINT 足で扱
						ENDIF
					ENDIF
					IF 手コキで射精 || 足コキで射精
						IF ヴァギナ || アナル || 素股 || 兜合わせ
							PRINT 、
						ELSE
							PRINT た。
						ENDIF
					ELSE
						IF ヴァギナ || アナル || 素股 || 兜合わせ
							PRINT き、
						ELSE
							PRINT いたが、射精させるには至らなかった。
						ENDIF
					ENDIF
				ENDIF
				IF 兜合わせ
					PRINTFORM 客と陰茎を擦り合わせ
					IF 兜合わせで射精
						PRINTFORM て{兜合わせで射精}回射精させた。
					ELSE
						PRINT たが、射精させるには至らなかった。
					ENDIF
				ENDIF
				IF 素股
					PRINTFORM 性行為の代わりに秘部を擦り合わせ
					IF 素股で射精
						PRINTFORM て{素股で射精}回射精させた。
					ELSE
						PRINT たが、射精させるには至らなかった。
					ENDIF
				ENDIF
				IF ヴァギナ || アナル
					SIF ヴァギナ
						PRINT 膣
					SIF ヴァギナ && アナル
						PRINT と
					SIF アナル
						PRINT アナル
					PRINT で性行為に
					IF 中出し || アナル中出し
						PRINT 及び、
						IF 中出し && アナル中出し
							PRINTFORM 膣に{中出し}回、アナルに{アナル中出し}回中出しされた。
						ELSEIF 中出し
							PRINTFORM {中出し}回中出しされた。
						ELSEIF アナル中出し
							PRINTFORM {アナル中出し}回中出しされた。
						ENDIF
					ELSE
						PRINT 及んだが、射精させるには至らなかった。
					ENDIF
				ENDIF
				PRINTL 
			ENDIF
			IF (アナル || ヴァギナ) && (絶頂 || 射精)
				SIF 客の性別 != 2
					PRINTFORM %CALLNAME:娼婦%は
				SIF アナル
					PRINT アナル
				SIF アナル && ヴァギナ
					PRINT や
				SIF ヴァギナ
					PRINT 膣内
				PRINT を
				SIF 客の性別 == 2
					PRINT 指や道具で
				SIF ヴァギナ > 7 || アナル > 7
					PRINT 激しく
				PRINT 犯された
				IF 射精 == 0 && 絶頂 == 0
					PRINTL ようだ。
				ELSE
					PRINT 挙句、
					IF 中出し
						PRINT 膣に中出しされながら
					ELSEIF アナル中出し
						PRINT アナルに中出しされながら
					ELSEIF ヴァギナ > アナル
						PRINT ヴァギナへの快感で
					ELSE
						PRINT アナルへの快感で
					ENDIF
					SIF 射精 >= 3 && 絶頂 >= 3
						PRINT 何回も
					IF 射精
						PRINTL 射精してしまったようだ。
					ELSE
						PRINTL 絶頂に達してしまったようだ。
					ENDIF
				ENDIF
			ENDIF
			IF 自慰
				PRINT その後、自慰を命じられ
				IF 自慰で射精
					PRINTFORML 、%CALLNAME:娼婦%は上手に自分で射精できたようだ。
				ELSEIF 絶頂
					PRINTFORML 、%CALLNAME:娼婦%は上手に自分で絶頂に達せたようだ。
				ELSE
					PRINTFORML たが、一人で絶頂を迎えることはできなかったらしい。
				ENDIF
			ENDIF
		ENDCATCH
	ELSE
		GOTO NOTKOJO
	ENDIF
ENDIF

SIF !FLAG:娼館報告
	SKIPDISP 1

SIF ヴァギナ
	CALL EXPUP, "Ｖ経験", ヴァギナ, 娼婦
SIF アナル
	CALL EXPUP, "Ａ経験", アナル, 娼婦
SIF ヴァギナ || アナル
	CALL EXPUP, "性交経験", ヴァギナ+アナル, 娼婦
SIF 絶頂 || 射精
	CALL EXPUP, "絶頂経験", 絶頂+射精, 娼婦
SIF 射精
	CALL EXPUP, "射精経験", 射精, 娼婦
IF 中出し
	CALL EXPUP, "膣射経験", 中出し, 娼婦
	モブ中出され回数:娼婦:0 += 中出し
ENDIF
SIF アナル中出し
	モブアナル中出され回数:娼婦:0 += アナル中出し
SIF 客の射精
	CALL EXPUP, "精液経験", 客の射精, 娼婦
SIF 自慰
	CALL EXPUP, "自慰経験", 自慰, 娼婦
SIF フェラ
	CALL EXPUP, "フェラ経験", フェラ, 娼婦
SIF レズ
	CALL EXPUP, "レズ経験", レズ, 娼婦
SIF ゲイ
	CALL EXPUP, "ゲイ経験", ゲイ, 娼婦

SKIPDISP 0

IF ヴァギナ && TALENT:娼婦:処女
	TALENT:娼婦:処女 = 0
	IF TALENT:娼婦:性転換済
		CSTR:娼婦:性転換処女 = 娼館に訪れた客
	ELSE
		CSTR:娼婦:処女 = 娼館に訪れた客
	ENDIF
ENDIF

TALENT:娼婦:傷物++
モブ経験人数:娼婦:0++
人気度:(NO:娼婦) += 10

CALL NEWLINE

RETURN 収入

@ペア売春, ARG
#DIM DYNAMIC 収入
#DIM DYNAMIC 娼婦, 2
#DIM DYNAMIC 相性
#DIM DYNAMIC 相性ボーナス
#DIM DYNAMIC LCOUNT
#DIM DYNAMIC 娼婦計算用
#DIM DYNAMIC 対象
#DIM DYNAMIC 口上対象, 2
#DIM DYNAMIC 表示済み

#DIM DYNAMIC 客の性別
#DIM DYNAMIC 絶頂, 2
#DIM DYNAMIC 射精, 2
#DIM DYNAMIC 客の射精, 2
#DIM DYNAMIC 自慰, 2
#DIM DYNAMIC ヴァギナ, 2
#DIM DYNAMIC アナル, 2
#DIM DYNAMIC 中出し, 2
#DIM DYNAMIC アナル中出し, 2
#DIM DYNAMIC ゲイ, 2
#DIM DYNAMIC レズ, 2

#DIM DYNAMIC 自慰で射精, 2
#DIM DYNAMIC 自慰で絶頂, 2

#DIM DYNAMIC フェラ, 2
#DIM DYNAMIC フェラで射精
#DIM DYNAMIC 手コキ, 2
#DIM DYNAMIC 手コキで射精
#DIM DYNAMIC 足コキ, 2
#DIM DYNAMIC 足コキで射精
#DIM DYNAMIC 兜合わせ, 2
#DIM DYNAMIC 兜合わせで射精
#DIM DYNAMIC 素股, 2
#DIM DYNAMIC 素股で射精
#DIM DYNAMIC 娼婦兜合わせ
#DIM DYNAMIC 娼婦兜合わせ射精, 2
#DIM DYNAMIC ダブルパイズリ
#DIM DYNAMIC ダブルフェラ
#DIM DYNAMIC ダブル素股
#DIM DYNAMIC 二本フェラ
#DIM DYNAMIC 娼婦二本フェラ射精, 2
#DIM DYNAMIC 逆アナル責め
#DIM DYNAMIC 交互騎乗位
#DIM DYNAMIC パイズリで射精
#DIM DYNAMIC ダブル足コキで射精
#DIM DYNAMIC 逆アナル責めで射精
#DIM DYNAMIC 射精我慢勝負
#DIM DYNAMIC 先に射精
#DIM DYNAMIC 客に中出し, 2
#DIM DYNAMIC 拘束プレイ
#DIM DYNAMIC ダブル自慰
#DIM DYNAMIC 射精地獄, 2
#DIM DYNAMIC 絶頂地獄, 2

娼婦計算用 = 0
FOR LCOUNT, 1, CHARANUM
	SIF CFLAG:LCOUNT:娼館部屋番号 == ARG
		娼婦:(娼婦計算用++) = LCOUNT
NEXT

;1000パセリは保証
収入 = 1000
FOR LCOUNT, 0, 2
	CALL 娼婦補正, 娼婦:LCOUNT
	収入 += RESULT
NEXT

;互いの相性値を乗算してその割合分上乗せ 互いに300%だったら900%（9倍）で、互いに50%だったら25%（0.25倍）
相性 = 相性値(娼婦:0, 娼婦:1)*相性値(娼婦:1, 娼婦:0)/100

収入 = 収入*相性/100

;血縁関係にあればさらに2倍
;近親相姦式中関数は血縁関係かどうかを判断してるのでここでも使う
SIF 近親相姦(娼婦:0, 娼婦:1)
	収入 *= 2

;プレミアムフライデー
SIF PREMIUM_FRIDAY(YEAR, MONTH, DAYS)
	TIMES 収入, 1.10

SELECTCASE 娼館方針
	CASE 1
		絶頂:0 = RAND:3
		絶頂:1 = RAND:3
		IF PENIS(娼婦:0) && PENIS(娼婦:1)
			;娼婦両方にペニスあるとたまに兜合わせを命じられる
			IF RAND:5 == 0
				娼婦兜合わせ = 1
				IF RAND:5 == 0
					娼婦兜合わせ射精:0 = 1
					射精:0++
				ENDIF
				IF RAND:5 == 0
					娼婦兜合わせ射精:1 = 1
					射精:1++
				ENDIF
				SIF SEX(娼婦:0) == 1
					ゲイ:0 += 2
				SIF SEX(娼婦:1) == 1
					ゲイ:1 += 2
			;同じくらいの確率で客が二本フェラしてくる
			ELSEIF RAND:5 == 0
				二本フェラ = 1
				IF RAND:2 == 0
					娼婦二本フェラ射精:0 = 1
					射精:0++
				ENDIF
				IF RAND:2 == 0
					娼婦二本フェラ射精:1 = 1
					射精:1++
				ENDIF
			ENDIF
		ENDIF

		ダブル自慰 = RAND:2
		IF ダブル自慰
			IF PENIS(娼婦:0)
				自慰で射精:0 = RAND:2
				射精:0 += 自慰で射精:0
			ELSE
				自慰で絶頂:0 = RAND:2
				絶頂:0 += 自慰で絶頂:0
			ENDIF
			IF PENIS(娼婦:1)
				自慰で射精:1 = RAND:2
				射精:1 += 自慰で射精:1
			ELSE
				自慰で絶頂:1 = RAND:2
				絶頂:1 += 自慰で絶頂:1
			ENDIF
			自慰:0++
			自慰:1++
		ENDIF
		
		;相性が良いとそれに応じていろいろやる
		IF 相性 >= 200 && RAND:3 == 0
			IF SEX(娼婦:0) == 2 && SEX(娼婦:1) == 2
				IF RAND:2
					ダブルパイズリ = 1
					ダブルフェラ = 1
					パイズリで射精 = RAND:3
					フェラで射精 = RAND:3
					客の射精:0 += パイズリで射精+フェラで射精
					客の射精:1 += パイズリで射精+フェラで射精
					フェラ:0++
					フェラ:1++
				ELSE
					ダブルパイズリ = 1
					パイズリで射精 = RAND:4
					客の射精:0 += パイズリで射精
					客の射精:1 += パイズリで射精
					フェラ:0++
					フェラ:1++
				ENDIF
			ELSE
				ダブルフェラ = 1
				フェラで射精 = RAND:4
				客の射精:0 += フェラで射精
				客の射精:1 += フェラで射精
			ENDIF
		ELSE
			対象 = RAND:2
			フェラ:対象 = RAND(3, 5)
			フェラで射精 = RAND:3
			客の射精:対象 += フェラで射精
			対象 = RAND:2
			手コキ:対象 = RAND:3
			SIF 手コキ:対象 == 2
				手コキで射精 = RAND:2
			客の射精:対象 += 手コキで射精
		ENDIF

		IF 相性 >= 400 && VAGINA(娼婦:0) && VAGINA(娼婦:1) && RAND:3 == 0
			ダブル素股 = 1
			素股で射精 = RAND(1, 2)
			客の射精:0 += 素股で射精
			客の射精:1 += 素股で射精
		ELSE
			対象 = RAND:2
			IF PENIS(娼婦:対象)
				兜合わせ:対象 = 1
				兜合わせで射精 = RAND:2
				射精:対象 = RAND:3
				客の射精:対象 += 兜合わせで射精
			ELSE
				素股:対象 = 1
				素股で射精 = RAND:2
				客の射精:対象 += 素股で射精
			ENDIF
		ENDIF

		SIF SEX(娼婦:0) == 1
			ゲイ:0 = RAND(1, 5)
		SIF SEX(娼婦:1) == 1
			ゲイ:1 = RAND(1, 5)
	CASE 2
		;稀にふたなり女性客が来る
		SIF RAND:5 == 0
			客の性別 = 3
		SELECTCASE 娼館性別固定
			CASE 1
				客の性別 = 0
			CASE 2
				客の性別 = 3
		ENDSELECT
		;相性が良いと交互に騎乗位
		IF 相性 >= 400 && RAND:3 == 0
			交互騎乗位 = 1
			IF VAGINA(娼婦:0)
				ヴァギナ:0 = RAND(3, 6)
				中出し:0 = RAND(2, 4)
			ELSE
				アナル:0 = RAND(3, 6)
				アナル中出し:0 = RAND(2, 4)
			ENDIF
			IF VAGINA(娼婦:1)
				ヴァギナ:1 = RAND(3, 6)
				中出し:1 = RAND(2, 4)
			ELSE
				アナル:1 = RAND(3, 6)
				アナル中出し = RAND(2, 4)
			ENDIF
			絶頂:0 = RAND:6
			絶頂:1 = RAND:6
			SIF PENIS(娼婦:0)
				射精:0 = RAND:4
			SIF PENIS(娼婦:1)
				射精:1 = RAND:4
		ELSE
			;挿入パターンは3種類
			SELECTCASE RAND:3
				CASE 0
					IF VAGINA(娼婦:0)
						ヴァギナ:0 = RAND(5, 11)
						中出し:0 = RAND(1, 4)
					ELSE
						アナル:0 = RAND(5, 11)
						アナル中出し:0 = RAND(1, 4)
					ENDIF
					絶頂:0 = RAND:6
					SIF PENIS(娼婦:0)
						射精:0 = RAND:4
				CASE 1
					IF VAGINA(娼婦:1)
						ヴァギナ:1 = RAND(5, 11)
						中出し:1 = RAND(1, 4)
					ELSE
						アナル:1 = RAND(5, 11)
						アナル中出し:1 = RAND(1, 4)
					ENDIF
					絶頂:1 = RAND:6
					SIF PENIS(娼婦:1)
						射精:1 = RAND:4
				CASE 2
					IF VAGINA(娼婦:0)
						ヴァギナ:0 = RAND(3, 6)
						中出し:0 = RAND(1, 3)
					ELSE
						アナル:0 = RAND(3, 6)
						アナル中出し:0 = RAND(1, 3)
					ENDIF
					IF VAGINA(娼婦:1)
						ヴァギナ:1 = RAND(3, 6)
						中出し:1 = RAND(1, 3)
					ELSE
						アナル:1 = RAND(3, 6)
						アナル中出し = RAND(1, 3)
					ENDIF
					絶頂:0 = RAND:6
					絶頂:1 = RAND:6
					SIF PENIS(娼婦:0)
						射精:0 = RAND:4
					SIF PENIS(娼婦:1)
						射精:1 = RAND:4
			ENDSELECT
		ENDIF
		客の射精:0 += 中出し:0+アナル中出し:0
		客の射精:1 += 中出し:1+アナル中出し:1

		;相性が良いとダブルフェラ
		IF 相性 >= 200
			ダブルフェラ = 1
			フェラで射精 = RAND:2
			客の射精:0 += フェラで射精
			客の射精:1 += フェラで射精
			フェラ:0++
			フェラ:1++
		ELSE
			対象 = RAND:2
			フェラ:対象 = RAND(1, 3)
			フェラで射精 = RAND:2
			客の射精:対象 += フェラで射精
		ENDIF
		SIF SEX(娼婦:0) == 1 && 客の性別 <= 1
			ゲイ:0 = RAND(3, 10)
		SIF SEX(娼婦:1) == 1 && 客の性別 <= 1
			ゲイ:1 = RAND(3, 10)
		SIF SEX(娼婦:0) == 2 && 客の性別 >= 2
			レズ:0 = RAND(3, 10)
		SIF SEX(娼婦:1) == 2 && 客の性別 >= 2
			レズ:1 = RAND(3, 10)
	CASE 3
		客の性別 = RAND:4
		SELECTCASE 娼館性別固定
			CASE 1
				客の性別 = 0
			CASE 2
				客の性別 = RAND(2, 4)
		ENDSELECT
		;たまにマゾが来る
		IF 客の性別 <= 1 && RAND:5 == 0
			対象 = RAND:2
			手コキ:対象 = 1
			手コキで射精 = RAND(1, 4)
			客の射精:対象 += 手コキで射精
			IF 相性 >= 200
				ダブル足コキで射精 = RAND(2, 5)
				客の射精:0 += ダブル足コキで射精
				客の射精:1 += ダブル足コキで射精
			ELSE
				足コキ:(!手コキ:1) = 1
				足コキで射精 = RAND(1, 4)
				客の射精:(!手コキ:1) += 足コキで射精
			ENDIF
			;相性が良いと逆アナルコンビネーション
			IF 相性 >= 300
				逆アナル責めで射精 = RAND(2, 5)
				客の射精:0 += 逆アナル責めで射精
				客の射精:1 += 逆アナル責めで射精
			ENDIF
		ELSE
			;どっちもペニスありなら我慢勝負を命じられる
			IF PENIS(娼婦:0) && PENIS(娼婦:1) && RAND:3 == 0
				射精我慢勝負 = 1
				先に射精 = RAND:2
				射精:先に射精 += 1
				;客が女性の場合、我慢できた方にご褒美
				IF 客の性別 == 2
					客に中出し:(!先に射精) = RAND(1, 3)
					射精:(!先に射精) += 客に中出し:(!先に射精)
				;客がペニスありの場合、先に射精したほうにお仕置きレイプ
				ELSE
					IF VAGINA(先に射精)
						ヴァギナ:先に射精 = RAND(1, 4)
						絶頂:先に射精 = RAND:4
						中出し:先に射精 = RAND(1, 3)
						客の射精:先に射精 += 中出し:先に射精
					ELSE
						アナル:先に射精 = RAND(1, 4)
						絶頂:先に射精 = RAND:4
						アナル中出し:先に射精 = RAND(1, 3)
						客の射精:先に射精 += アナル中出し:先に射精
					ENDIF
				ENDIF
			;どっちも無しなら拘束プレイすることがある
			ELSEIF !PENIS(娼婦:0) && !PENIS(娼婦:1) && RAND:3 == 0
				拘束プレイ = 1
				;客が女性の場合、どっちも必ずイかされる
				IF 客の性別 == 2
					絶頂:0 = RAND(1, 4)
					絶頂:1 = RAND(1, 4)
				;竿ありだとどっちも必ず中出しされる
				ELSE
					ヴァギナ:0 = RAND(2, 5)
					絶頂:0 = RAND:4
					中出し:0 = RAND(2, 5)
					客の射精:0 += 中出し:0
					ヴァギナ:1 = RAND(2, 5)
					絶頂:1 = RAND:4
					中出し:1 = RAND(2, 5)
					客の射精:1 = 中出し:1
				ENDIF
			;上記の条件に満たなければダブル自慰
			ELSE
				ダブル自慰 = 1
				IF PENIS(娼婦:0)
					自慰で射精:0 = RAND:2
					射精:0 += 自慰で射精:0
				ELSE
					自慰で絶頂:0 = RAND:2
					絶頂:0 += 自慰で絶頂:0
				ENDIF
				IF PENIS(娼婦:1)
					自慰で射精:1 = RAND:2
					射精:1 += 自慰で射精:1
				ELSE
					自慰で絶頂:1 = RAND:2
					絶頂:1 += 自慰で絶頂:1
				ENDIF
				自慰:0++
				自慰:1++
				;どちらかがイかされ地獄の餌食になる
				対象 = RAND:2
				IF PENIS(娼婦:対象)
					射精地獄:対象 = RAND(4, 8)
					射精:対象 += 射精地獄:対象
					アナル:対象 += RAND(2, 5)
					絶頂:対象 += RAND:2
					IF 客の性別 != 2
						アナル中出し:対象 += RAND(1, 4)
						客の射精 += アナル中出し:対象
					ENDIF
				ELSE
					絶頂地獄:対象 = RAND(4, 8)
					絶頂:対象 += 絶頂地獄:対象
					ヴァギナ:対象 = RAND(2, 5)
					アナル:対象 = RAND(2, 5)
					IF 客の性別 != 2
						中出し:対象 = RAND(1, 4)
						アナル中出し:対象 = RAND(1, 4)
						客の射精:対象 += 中出し:対象+アナル中出し:対象
					ENDIF
				ENDIF
			ENDIF
		ENDIF

		;相性が良いとダブルフェラ
		IF 客の性別 != 2
			IF 相性 >= 200
				ダブルフェラ = 1
				フェラで射精 = RAND:2
				客の射精:0 += フェラで射精
				客の射精:1 += フェラで射精
				フェラ:0++
				フェラ:1++
			ELSE
				対象 = RAND:2
				フェラ:対象 = RAND(1, 3)
				フェラで射精 = RAND:2
				客の射精:対象 += フェラで射精
			ENDIF
		ENDIF
		SIF SEX(娼婦:0) == 1 && 客の性別 <= 1
			ゲイ:0 = RAND(3, 10)
		SIF SEX(娼婦:1) == 1 && 客の性別 <= 1
			ゲイ:1 = RAND(3, 10)
		SIF SEX(娼婦:0) == 2 && 客の性別 >= 2
			レズ:0 = RAND(3, 10)
		SIF SEX(娼婦:1) == 2 && 客の性別 >= 2
			レズ:1 = RAND(3, 10)
	CASE 4
		SELECTCASE 娼館性別固定
			CASE 1
				客の性別 = 0
			CASE 2
				客の性別 = 3
		ENDSELECT
		拘束プレイ = RAND:2
		IF VAGINA(娼婦:0)
			ヴァギナ:0 = RAND(10, 30)
			中出し:0 = RAND(15, 40)
			客の射精:0 += 中出し:0
		ELSE
			アナル:0 = RAND(10, 30)
			アナル中出し:0 = RAND(15, 40)
			客の射精:0 += アナル中出し:0
		ENDIF
		IF VAGINA(娼婦:1)
			ヴァギナ:1 = RAND(10, 30)
			中出し:1 = RAND(15, 40)
			客の射精:1 += 中出し:1
		ELSE
			アナル:1 = RAND(10, 30)
			アナル中出し = RAND(15, 40)
			客の射精:1 += アナル中出し:1
		ENDIF
		絶頂:0 = RAND(5, 20)
		絶頂:1 = RAND(5, 20)
		SIF PENIS(娼婦:0)
			射精:0 = RAND(4, 10)
		SIF PENIS(娼婦:1)
			射精:1 = RAND(4, 10)

		SIF SEX(娼婦:0) == 1 && 客の性別 <= 1
			ゲイ:0 = RAND(10, 20)
		SIF SEX(娼婦:1) == 1 && 客の性別 <= 1
			ゲイ:1 = RAND(10, 20)
		SIF SEX(娼婦:0) == 2 && 客の性別 >= 2
			レズ:0 = RAND(10, 20)
		SIF SEX(娼婦:1) == 2 && 客の性別 >= 2
			レズ:1 = RAND(10, 20)
ENDSELECT

IF FLAG:娼館報告 && 娼館方針
	IF FLAG:口上表示
		;番号が小さい方を前に並べる
		口上対象:0 = MIN(NO:(娼婦:0), NO:(娼婦:1))
		口上対象:1 = MAX(NO:(娼婦:0), NO:(娼婦:1))
		TRYCCALLFORM BR_PLAY_%CSVNAMERPS(口上対象:0)%_%CSVNAMERPS(口上対象:1)%, 客の性別, 絶頂, 射精, 客の射精, 自慰, 自慰で射精, フェラ, フェラで射精, ヴァギナ, 中出し, アナル, アナル中出し, 手コキ, 手コキで射精, 足コキ, 足コキで射精, 兜合わせ, 兜合わせで射精, 素股, 素股で射精, ゲイ, レズ, 
		CATCH
			$NOTKOJO
			表示済み = 0
			IF 娼館方針 == 4
				PRINTFORML 娼館で働いてる%CALLNAME:(娼婦:0)%と%CALLNAME:(娼婦:1)%の様子を見に行くと、何度も犯されて身動きが取れないほど消耗したふたりが居た
			ELSE
				PRINTFORML %CALLNAME:(娼婦:0)%と%CALLNAME:(娼婦:1)%が今日の仕事を報告してきた。
				PRINT 今日は
				SIF 娼館方針 == 3 && 手コキで射精
					PRINT マゾヒストの
				SELECTCASE 客の性別
					CASE IS <= 1
						PRINT 男性客を相手に
					CASE 2
						PRINT 女性客を相手に
					CASE 3
						PRINT ふたなり女性客を相手に
				ENDSELECT
			ENDIF
			
			;マゾヒスト用
			IF 手コキで射精
				対象 = FINDELEMENT(手コキ, 1)
				PRINTFORM まずは%CALLNAME:(娼婦:対象)%が手で扱いて{手コキで射精}回抜いた後、
				IF ダブル足コキで射精
					PRINTFORML ふたりで言葉責めをしながら足コキをして{ダブル足コキで射精}回射精ようだ。
				ELSE
					対象 = FINDELEMENT(足コキ, 1)
					PRINTFORML %CALLNAME:(娼婦:対象)%が足コキで{足コキで射精}回射精ようだ。
				ENDIF
				SIF 逆アナル責めで射精
					PRINTFORML 次にふたりは客を拘束し、ふたりでアナルや乳首、前立腺を責めながら{逆アナル責めで射精}回射精させることに成功したらしい。
				表示済み = 1
			ENDIF
			
			IF 娼婦兜合わせ
				PRINTFORM %CALLNAME:(娼婦:0)%と%CALLNAME:(娼婦:1)%で兜合わせをするように命じられ、
				IF 娼婦兜合わせ射精:0 && 娼婦兜合わせ射精:1
					PRINTL お互いにそれで射精してしまったようだ。
				ELSEIF 娼婦兜合わせ射精:0
					PRINTFORML %CALLNAME:(娼婦:0)%はそれで射精してしまったようだ。
				ELSEIF 娼婦兜合わせ射精:1
					PRINTFORML %CALLNAME:(娼婦:1)%はそれで射精してしまったようだ。
				ELSE
					PRINTL 互いのペニスを擦り合わせて見せつけたようだ。
				ENDIF
				表示済み = 1
			ELSEIF 二本フェラ
				PRINT ペニスを交互にフェラされ、
				IF 娼婦二本フェラ射精:0 && 娼婦二本フェラ射精:1
					PRINTL ふたりとも客の舌使いでイかされてしまったようだ。
				ELSEIF 娼婦二本フェラ射精:0
					PRINTFORML %CALLNAME:(娼婦:0)%は客の口の中に射精してしまったようだ。
				ELSEIF 娼婦二本フェラ射精:1
					PRINTFORML %CALLNAME:(娼婦:1)%は客の口の中に射精してしまったようだ。
				ELSE
					PRINTL 客は満足そうに二本のペニスを弄んでいたようだ。
				ENDIF
				表示済み = 1
			ENDIF
			
			IF 交互騎乗位
				PRINT 交互に騎乗位をして、
				IF MAX(中出し:0, アナル中出し:0) == MAX(中出し:1, アナル中出し:1)
					PRINTFORML ふたりとも{MAX(中出し:0, アナル中出し:0)}回づつ搾り取ったようだ。
				ELSE
					PRINTFORM %CALLNAME:(娼婦:0)%が
					IF 中出し:0
						PRINTFORM 膣で{中出し:0}回、
					ELSE
						PRINTFORM アナルで{アナル中出し:0}回、
					ENDIF
					PRINTFORM %CALLNAME:(娼婦:1)%
					IF 中出し:1
						IF 中出し:0
							PRINT も
						ELSE
							PRINT が
						ENDIF
						PRINTFORM 膣で{中出し:1}回
					ELSE
						IF 中出し:1
							PRINT も
						ELSE
							PRINT が
						ENDIF
						PRINTFORM アナルで{アナル中出し:1}回
					ENDIF
					PRINTL 搾り取ったようだ。
				ENDIF
				表示済み = 1
			ELSEIF 射精我慢勝負
				PRINTFORML 「先に射精したほうが負け」というルールで同時にペニスを弄られ、我慢も虚しく%CALLNAME:(娼婦:先に射精)%が先に射精してしまった。
				IF 客の性別 == 2
					PRINTFORML 我慢できた%CALLNAME:(娼婦:ABS(先に射精-1))%はご褒美に客の膣内に射精させてもらったようだ。
				ELSE
					PRINTFORM 我慢できなかった%CALLNAME:(娼婦:先に射精)%はお仕置きに
					IF VAGINA(娼婦:先に射精)
						PRINT 膣を激しく犯され、
					ELSE
						PRINT アナルを激しく犯され、
					ENDIF
					PRINTFORM {MAX(中出し:先に射精, アナル中出し:先に射精)}回中出しされた。
					SIF 絶頂:先に射精
						PRINTFORM %CALLNAME:(娼婦:先に射精)%も犯されながら{絶頂:先に射精}回イったようだ。
					PRINTL 
				ENDIF
				表示済み = 1
			ELSEIF ダブル自慰
				PRINT ふたりで自慰をするように命じられ
				IF 自慰で射精:0 && 自慰で射精:1
					PRINTL 、客に見られながらふたり一緒に自慰で射精した。
				ELSEIF (自慰で絶頂:0 || 自慰で射精:0) && (自慰で絶頂:1 || 自慰で射精:1)
					PRINTL 、客に見られながらふたり一緒に自慰で絶頂に達した。
				ELSEIF 自慰で射精:0 || 自慰で絶頂:0
					PRINTFORM 、%CALLNAME:(娼婦:0)%は
					IF 自慰で射精:0
						PRINT 自慰で射精したが、
					ELSE
						PRINT 絶頂に達したが、
					ENDIF
					IF PENIS(娼婦:1)
						PRINTFORML %CALLNAME:(娼婦:1)%は射精には達せなかった。
					ELSE
						PRINTFORML %CALLNAME:(娼婦:1)%は絶頂には達せなかった。
					ENDIF
				ELSEIF 自慰で射精:1 || 自慰で絶頂:1
					PRINTFORM 、%CALLNAME:(娼婦:1)%は
					IF 自慰で射精:1
						PRINT 自慰で射精したが、
					ELSE
						PRINT 絶頂に達したが、
					ENDIF
					IF PENIS(娼婦:0)
						PRINTFORML %CALLNAME:(娼婦:0)%は射精には達せなかった。
					ELSE
						PRINTFORML %CALLNAME:(娼婦:0)%は絶頂には達せなかった。
					ENDIF
				ELSE
					PRINTFORML 客の前で自慰を披露した。
				ENDIF
				IF 娼館方針 == 3
					IF 射精地獄:0 || 絶頂地獄:0
						対象 = 0
					ELSE
						対象 = 1
					ENDIF
					PRINTFORM 客は%CALLNAME:(娼婦:対象)%に目をつけて拘束すると、
					IF 射精地獄:対象
						PRINTL 激しくペニスを弄り始めた。
						PRINT 一度二度射精するだけでは手が止まらず、
						IF 客の性別 != 2
							PRINT アナルを犯しながら
						ELSE
							PRINT アナルを責めながら
						ENDIF
						PRINTFORML 精液を搾り取り、最終的に潮を噴いてしまうまで%CALLNAME:(娼婦:対象)%は{射精地獄:対象}回連続で射精させられた。
					ELSEIF 絶頂地獄:対象
						IF 客の性別 != 2
							PRINTL 膣とアナルを交互に激しく犯し始めた。
						ELSE
							PRINTL 膣とアナルを指や道具で激しく責め始めた。
						ENDIF
						PRINTFORML %CALLNAME:(娼婦:対象)%が何度イっても終わることはなく、{絶頂地獄:対象}回ほど連続で絶頂させられて気を失いかけたようだ。
					ENDIF
				ENDIF
				表示済み = 1
			ELSE
				IF MAX(中出し:0, アナル中出し:0) >= 1 && MAX(中出し:1, アナル中出し:1) >= 1
					IF 拘束プレイ
						PRINT ふたりは動けないように拘束されたまま
					ELSEIF 娼館方針 == 4
						PRINT ふたりは
					ENDIF
					PRINT 交互に犯され、
					IF 中出し:0 && 中出し:1
						IF 中出し:0 == 中出し:1
							PRINTFORML 互いに{中出し:1}回づつ膣内に中出しされたようだ。
						ELSE
							PRINTFORML %CALLNAME:(娼婦:0)%は{中出し:0}回、%CALLNAME:(娼婦:1)%は{中出し:1}回、膣内に中出しされたようだ。
						ENDIF
					ELSEIF アナル中出し:0 && アナル中出し:1
						IF アナル中出し:0 == アナル中出し:1
							PRINTFORML 互いに{アナル中出し:1}回づつアナルに中出しされたようだ。
						ELSE
							PRINTFORML %CALLNAME:(娼婦:0)%は{アナル中出し:0}回、%CALLNAME:(娼婦:1)%は{アナル中出し:1}回、アナルに中出しされたようだ。
						ENDIF
					ELSE
						IF 中出し:0 && アナル中出し:1
							IF 中出し:0 == アナル中出し:1
								PRINTFORML {中出し:0}回づつ、%CALLNAME:(娼婦:0)%は膣内に、%CALLNAME:(娼婦:1)%はアナルに中出しされたようだ。
							ELSE
								PRINTFORML %CALLNAME:(娼婦:0)%は{中出し:0}回膣内に、%CALLNAME:(娼婦:1)%は{アナル中出し:1}回アナルに中出しされたようだ。
							ENDIF
						ELSEIF アナル中出し:0 && 中出し:1
							IF アナル中出し:0 == 中出し:1
								PRINTFORML {アナル中出し:0}回づつ、%CALLNAME:(娼婦:0)%はアナルに、%CALLNAME:(娼婦:1)%は膣内に中出しされたようだ。
							ELSE
								PRINTFORML %CALLNAME:(娼婦:0)%は{アナル中出し:0}回アナルに、%CALLNAME:(娼婦:1)%は{中出し:1}回膣内に中出しされたようだ。
							ENDIF
						ENDIF
					ENDIF
					表示済み = 1
				ELSEIF 中出し:0 || アナル中出し:0
					PRINTL 体中を触られた後、
					PRINTFORM %CALLNAME:(娼婦:0)%の方を気に入った客は%CALLNAME:(娼婦:0)%と
					IF 中出し:0
						PRINTFORM 性交に及び、{中出し:0}回
					ELSEIF アナル中出し:0
						PRINTFORM アナルセックスに及び、{アナル中出し:0}回
					ENDIF
					PRINTL 中出ししたようだ。
					表示済み = 1
				ELSEIF 中出し:1 || アナル中出し:1
					PRINTFORM %CALLNAME:(娼婦:1)%の方を気に入った客は%CALLNAME:(娼婦:1)%と
					IF 中出し:1
						PRINTFORM 性交に及び、{中出し:1}回
					ELSEIF アナル中出し:1
						PRINTFORM アナルセックスに及び、{アナル中出し:1}回
					ENDIF
					PRINTL 中出ししたようだ。
					表示済み = 1
				ENDIF
			ENDIF
			
			IF 娼館方針 == 4
				IF 拘束プレイ
					PRINTL 家畜のように縛られて放置されるふたりは並外れた回数の中出しに、妊娠したように腹を膨らませ、未だ収まりきらない激しい絶頂の余韻に足をがくがくと震わせている。
				ELSE
					PRINTL 散々犯されてぼろ雑巾のように打ち捨てられるふたりは、未だに体をびくびくと痙攣させている。
					対象 = RAND:2
					IF VAGINA(娼婦:対象)
						PRINTFORM %CALLNAME:(娼婦:対象)%は膣内から産み落とすように精液の塊を零し、
						SELECTCASE RAND:2
							CASE 0
								PRINTL 絶頂に緩んだ尿道から勢い無く尿を漏らしている……
							CASE 1
								PRINTL 膣内を這う濃厚な精液に小さい嬌声を上げた……
						ENDSELECT
					ELSE
						PRINTFORM %CALLNAME:(娼婦:対象)%は下品な音を立てて排泄のようにアナルから白濁液を漏らし、
						SELECTCASE RAND:2
							CASE 0
								PRINTL 犯される快感で出したのであろう精液が、拭うことも叶わずに先端から滲み出ている……
							CASE 1
								PRINTL 周囲には当人や客が出したのであろう体液が散乱している……
						ENDSELECT
					ENDIF
				ENDIF
				表示済み = 1
			ELSE
				IF ダブルフェラ || ダブルパイズリ
					SIF 表示済み
						PRINT その後、
					PRINT ふたり一緒に客のペニスを
					IF ダブルフェラ && ダブルパイズリ
						PRINT 胸で擦りながら舐め回し
					ELSEIF ダブルフェラ
						PRINT 舐め回し
					ELSE
						PRINT 乳房で扱い
					ENDIF
					IF パイズリで射精 || フェラで射精
						SELECTCASE 娼館方針
							CASE 2, 3
								PRINTFORML て{パイズリで射精+フェラで射精}回射精させた。
							CASEELSE
								PRINTFORM て{パイズリで射精+フェラで射精}回射精させた後、
						ENDSELECT
					ELSE
						SELECTCASE 娼館方針
							CASE 2, 3
								PRINTL てお掃除したそうだ。
							CASEELSE
								PRINT た後、
						ENDSELECT
					ENDIF
				ELSEIF 客の性別 != 2
					SIF 表示済み
						PRINT その後、
					IF 娼館方針 == 2 || 娼館方針 == 3
						IF フェラ:0
							PRINTFORM %CALLNAME:(娼婦:0)%が口で奉仕
						ELSEIF フェラ:1
							PRINTFORM %CALLNAME:(娼婦:1)%が口で奉仕
						ENDIF
						IF フェラで射精
							PRINTFORML して{フェラで射精}回射精させた。
						ELSE
							PRINTL して綺麗にお掃除したそうだ。
						ENDIF
					ELSE
						IF フェラ:0 && 手コキ:0
							PRINTFORM %CALLNAME:(娼婦:0)%が口と手で奉仕
						ELSEIF フェラ:1 && 手コキ:1
							PRINTFORM %CALLNAME:(娼婦:1)%が口と手で奉仕
						ELSEIF フェラ:0 && 手コキ:1
							PRINTFORM %CALLNAME:(娼婦:0)%が口で、%CALLNAME:(娼婦:1)%が手で奉仕
						ELSEIF フェラ:1 && 手コキ:0
							PRINTFORM %CALLNAME:(娼婦:1)%が口で、%CALLNAME:(娼婦:0)%が手で奉仕
						ELSEIF フェラ:0
							PRINTFORM %CALLNAME:(娼婦:0)%が口で奉仕
						ELSEIF フェラ:1
							PRINTFORM %CALLNAME:(娼婦:1)%が口で奉仕
						ENDIF
						IF フェラで射精 || 手コキで射精
							PRINTFORM して{フェラで射精+手コキで射精}回射精させた後、
						ELSE
							PRINT した後、
						ENDIF
					ENDIF
				ENDIF
				
				IF ダブル素股
					PRINTFORML 互いの陰唇で客のペニスを挟み込み、{素股で射精}回精液を搾り取ったらしい。
				ELSE
					IF 兜合わせ:0 || 兜合わせ:1
						IF 兜合わせ:0
							PRINTFORM %CALLNAME:(娼婦:0)%
						ELSE
							PRINTFORM %CALLNAME:(娼婦:1)%
						ENDIF
						PRINT が客と陰茎を擦り合わせ
						IF 兜合わせで射精
							PRINTFORML て{兜合わせで射精}回射精させた。
						ELSE
							PRINTL たが、射精させるには至らなかった。
						ENDIF
					ENDIF
					IF 素股:0 || 素股:1
						IF 素股:0
							PRINTFORM %CALLNAME:(娼婦:0)%
						ELSE
							PRINTFORM %CALLNAME:(娼婦:1)%
						ENDIF
						PRINTFORM が性行為の代わりに秘部を擦り合わせ
						IF 素股で射精
							PRINTFORML て{素股で射精}回射精させた。
						ELSE
							PRINTL たが、射精させるには至らなかった。
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDCATCH
	ELSE
		GOTO NOTKOJO
	ENDIF
ENDIF

FOR LCOUNT, 0, 2
	SIF !FLAG:娼館報告
		SKIPDISP 1
	SIF ヴァギナ:LCOUNT
		CALL EXPUP, "Ｖ経験", ヴァギナ:LCOUNT, 娼婦:LCOUNT
	SIF アナル:LCOUNT
		CALL EXPUP, "Ａ経験", アナル:LCOUNT, 娼婦:LCOUNT
	SIF ヴァギナ:LCOUNT || アナル:LCOUNT
		CALL EXPUP, "性交経験", ヴァギナ:LCOUNT+アナル:LCOUNT, 娼婦:LCOUNT
	SIF 絶頂:LCOUNT || 射精:LCOUNT
		CALL EXPUP, "絶頂経験", 絶頂:LCOUNT+射精:LCOUNT, 娼婦:LCOUNT
	SIF 射精:LCOUNT
		CALL EXPUP, "射精経験", 射精:LCOUNT, 娼婦:LCOUNT
	IF 中出し:LCOUNT
		CALL EXPUP, "膣射経験", 中出し:LCOUNT, 娼婦:LCOUNT
		モブ中出され回数:(娼婦:LCOUNT):0 += 中出し:LCOUNT
	ENDIF
	SIF アナル中出し:LCOUNT
		モブアナル中出され回数:(娼婦:LCOUNT):0 += アナル中出し:LCOUNT
	SIF 客の射精:LCOUNT
		CALL EXPUP, "精液経験", 客の射精:LCOUNT, 娼婦:LCOUNT
	SIF 自慰:LCOUNT
		CALL EXPUP, "自慰経験", 自慰:LCOUNT, 娼婦:LCOUNT
	SIF フェラ:LCOUNT
		CALL EXPUP, "フェラ経験", フェラ:LCOUNT, 娼婦:LCOUNT
	SIF ダブルパイズリ
		CALL EXPUP, "パイズリ経験", 1, 娼婦:LCOUNT
	SIF レズ:LCOUNT
		CALL EXPUP, "レズ経験", レズ:LCOUNT, 娼婦:LCOUNT
	SIF ゲイ:LCOUNT
		CALL EXPUP, "ゲイ経験", ゲイ:LCOUNT, 娼婦:LCOUNT
	SKIPDISP 0
	IF ヴァギナ:LCOUNT && TALENT:(娼婦:LCOUNT):処女
		IF TALENT:(娼婦:LCOUNT):性転換済
			CSTR:(娼婦:LCOUNT):性転換処女 = 娼館に訪れた客
		ELSE
			CSTR:(娼婦:LCOUNT):処女 = 娼館に訪れた客
		ENDIF
		TALENT:(娼婦:LCOUNT):処女 = 0
		TALENT:(娼婦:LCOUNT):再生処女 = 0
	ENDIF
	TALENT:(娼婦:LCOUNT):傷物++
	人気度:(娼婦:LCOUNT) += 10
	モブ経験人数:(娼婦:LCOUNT):0++
	SKIPDISP 0
NEXT

SIF !LINEISEMPTY()
	WAIT

RETURN 収入

;ソロ売春とペア売春の補正が同じだけどゆくゆくは別の補正をかけるようにしたい
@娼婦補正, 娼婦
#DIM DYNAMIC 娼婦
#DIM DYNAMIC 適性
#DIM DYNAMIC 不適性
#DIM DYNAMIC 収入
#DIM DYNAMIC 消耗量

;方針による補正
SELECTCASE 娼館方針
	;ソフト
	CASE 1
		;まずはプラス素質から計算
		IF TALENT:娼婦:淫乱
			収入 += 300
			適性 += 2
		ENDIF
		IF TALENT:娼婦:娼婦
			収入 += 500
			適性 += 3
		ENDIF
		IF TALENT:娼婦:素直
			収入 += 200
			適性 += 2
		ENDIF
		SIF TALENT:娼婦:臆病
			収入 += 100
		
		IF TALENT:娼婦:プライド低い
			収入 += 150
			適性++
		ENDIF
		IF TALENT:娼婦:大人しい
			収入 += 50
			適性++
		ENDIF
		IF TALENT:娼婦:好奇心
			収入 += 150
			適性++
		ENDIF
		SIF TALENT:娼婦:恥じらい
			収入 += 50
		SIF TALENT:娼婦:恥薄い
			適性++
		SIF TALENT:娼婦:痛みに強い
			適性 += 2
		SIF TALENT:娼婦:舌使い
			収入 += 200
		IF TALENT:娼婦:自慰しやすい
			収入 += 50
			適性++
		ENDIF
		SIF TALENT:娼婦:汚臭鈍感
			適性++
		SIF TALENT:娼婦:汚れ無視
			適性++
		IF TALENT:娼婦:献身的
			収入 += 150
			適性 += 2
		ENDIF
		IF TALENT:娼婦:快感に素直
			収入 += 100
			適性++
		ENDIF
		IF TALENT:娼婦:淫核
			収入 += 150
			適性++
		ENDIF
		IF TALENT:娼婦:両刀
			収入 += 50
			適性++
		ENDIF
		IF TALENT:娼婦:男好き
			収入 += 100
			適性 += 2
		ENDIF
		SIF TALENT:娼婦:小悪魔
			収入 += 50
		SIF TALENT:娼婦:魅力
			収入 += 50
		SIF TALENT:娼婦:魅惑
			収入 += 50
		SIF TALENT:娼婦:謎の魅力
			収入 += 100
		;客がロリコンの確率は半々
		IF TALENT:娼婦:小柄体型
			IF RAND:2 == 0
				収入 += 100
			ELSE
				収入 -= 50
			ENDIF
			;どちらにせよ負担が大きいので不適性
			不適性++
		ENDIF
		;大きいのが好きか小さいのが好きかはランダム
		IF RAND:2 == 0
			収入 += (7-TALENT:娼婦:バストサイズ)*10
		ELSE
			収入 += TALENT:娼婦:バストサイズ*10
		ENDIF
		SIF TALENT:娼婦:ファーリー
			収入 += 30
		SIF TALENT:娼婦:尻尾
			収入 += 30
		SIF TALENT:娼婦:動物耳
			収入 += 30
		;小人も人による
		IF TALENT:娼婦:小人体型
			IF RAND:3 == 0
				収入 += 200
			ELSE
				収入 -= 100
			ENDIF
			不適性 += 2
		ENDIF
		SIF TALENT:娼婦:ふたなり
			収入 += 50
		IF TALENT:娼婦:人気
			収入 += 100
			適性++
		ENDIF

		;ここからマイナス素質
		IF TALENT:娼婦:恋慕
			収入 -= 50
			不適性++
		ENDIF
		IF TALENT:娼婦:親愛
			収入 -= 100
			不適性 += 2
		ENDIF
		IF TALENT:娼婦:生意気
			収入 -= 50
			不適性++
		ENDIF
		IF TALENT:娼婦:反抗的
			収入 -= 50
			不適性++
		ENDIF
		IF TALENT:娼婦:プライド高い
			収入 -= 30
			不適性++
		ENDIF
		SIF TALENT:娼婦:ツンデレ
			収入 -= 30
		SIF TALENT:娼婦:無関心
			収入 -= 30
		SIF TALENT:娼婦:保守的
			不適性++
		SIF TALENT:娼婦:悲観的
			不適性++
		SIF TALENT:娼婦:抵抗
			不適性 += 2
		SIF TALENT:娼婦:痛みに弱い
			不適性 += 2
		SIF TALENT:娼婦:汚臭敏感
			不適性++
		SIF TALENT:娼婦:潔癖症
			不適性++
		IF TALENT:娼婦:男嫌い
			収入 -= 50
			不適性 += 2
		ENDIF
		IF TALENT:娼婦:同族嫌悪
			収入 -= 50
			不適性++
		ENDIF
		;ソフトでは適性-10
		不適性 += 10
		;ここから能力で倍率計算
		IF 統率者("娼館", CFLAG:娼婦:娼館部屋番号) && !TALENT:娼婦:統率
			収入 += (収入/10)*(ABL:娼婦:従順+1)
			適性 += (ABL:娼婦:従順+1)/3

			収入 += (収入/5)*(ABL:娼婦:欲望+1)
			適性 += (ABL:娼婦:欲望+1)/3

			収入 += (収入/2)*(ABL:娼婦:技巧+1)
			適性 += (ABL:娼婦:技巧+1)/2

			収入 += (収入/5)*(ABL:娼婦:奉仕精神+1)
			適性 += (ABL:娼婦:奉仕精神+1)/2
		ELSE
			収入 += (収入/10)*ABL:娼婦:従順
			適性 += ABL:娼婦:従順/3

			収入 += (収入/5)*ABL:娼婦:欲望
			適性 += ABL:娼婦:欲望/3

			収入 += (収入/2)*ABL:娼婦:技巧
			適性 += ABL:娼婦:技巧/2

			収入 += (収入/5)*ABL:娼婦:奉仕精神
			適性 += ABL:娼婦:奉仕精神/2
		ENDIF
	;ハード
	CASE 2
		;まずはプラス素質から計算
		SIF TALENT:娼婦:処女
			収入 += 2000
		IF TALENT:娼婦:淫乱
			収入 += 500
			適性++
		ENDIF
		IF TALENT:娼婦:娼婦
			収入 += 1000
			適性 += 2
		ENDIF
		IF TALENT:娼婦:素直
			収入 += 300
			適性++
		ENDIF
		IF TALENT:娼婦:プライド低い
			収入 += 200
			適性++
		ENDIF
		IF TALENT:娼婦:大人しい
			収入 += 100
			適性++
		ENDIF
		IF TALENT:娼婦:好奇心
			収入 += 200
			適性++
		ENDIF
		IF TALENT:娼婦:貞操無頓着
			収入 += 100
			適性 += 2
		ENDIF
		SIF TALENT:娼婦:恥じらい
			収入 += 150
		SIF TALENT:娼婦:恥薄い
			適性++
		SIF TALENT:娼婦:痛みに強い
			適性 += 2
		SIF TALENT:娼婦:舌使い
			収入 += 100
		SIF TALENT:娼婦:汚れ無視
			適性++
		IF TALENT:娼婦:献身的
			収入 += 300
			適性 += 2
		ENDIF
		IF TALENT:娼婦:快感に素直
			収入 += 200
			適性 += 2
		ENDIF
		IF TALENT:娼婦:淫膣
			収入 += 300
			適性 += 2
		ENDIF
		IF TALENT:娼婦:両刀
			収入 += 100
		ENDIF
		IF TALENT:娼婦:男好き
			収入 += 100
			適性++
		ENDIF
		SIF TALENT:娼婦:魅力
			収入 += 100
		SIF TALENT:娼婦:魅惑
			収入 += 100
		SIF TALENT:娼婦:謎の魅力
			収入 += 200
		;客がロリコンの確率は半々
		IF TALENT:娼婦:小柄体型
			IF RAND:2 == 0
				収入 += 300
			ELSE
				収入 -= 100
			ENDIF
			;どちらにせよ負担が大きいので不適性
			不適性++
		ENDIF
		SIF TALENT:娼婦:Ｖ敏感
			適性++
		SIF TALENT:娼婦:Ａ敏感
			適性++
		;大きいのが好きか小さいのが好きかはランダム
		IF RAND:2 == 0
			収入 += (7-TALENT:娼婦:バストサイズ)*20
		ELSE
			収入 += TALENT:娼婦:バストサイズ*20
		ENDIF
		SIF TALENT:娼婦:ファーリー
			収入 += 50
		SIF TALENT:娼婦:尻尾
			収入 += 50
		SIF TALENT:娼婦:動物耳
			収入 += 50
		;小人も人による
		IF TALENT:娼婦:小人体型
			IF RAND:3 == 0
				収入 += 500
			ELSE
				収入 -= 300
			ENDIF
			不適性 += 2
		ENDIF
		SIF TALENT:娼婦:ふたなり
			収入 += 100
		IF TALENT:娼婦:人気
			収入 += 200
			適性++
		ENDIF

		;ここからマイナス素質
		IF TALENT:娼婦:恋慕
			収入 -= 150
			不適性++
		ENDIF
		IF TALENT:娼婦:親愛
			収入 -= 300
			不適性 += 2
		ENDIF
		IF TALENT:娼婦:生意気
			収入 -= 100
			不適性++
		ENDIF
		IF TALENT:娼婦:反抗的
			収入 -= 100
			不適性++
		ENDIF
		IF TALENT:娼婦:プライド高い
			収入 -= 50
			不適性 += 2
		ENDIF
		SIF TALENT:娼婦:ツンデレ
			収入 -= 50
		SIF TALENT:娼婦:無関心
			収入 -= 50
		SIF TALENT:娼婦:保守的
			不適性++
		SIF TALENT:娼婦:悲観的
			不適性++
		IF TALENT:娼婦:貞操観念
			収入 -= 50
			不適性++
		ENDIF
		SIF TALENT:娼婦:抵抗
			不適性 += 2
		SIF TALENT:娼婦:痛みに弱い
			不適性 += 2
		SIF TALENT:娼婦:潔癖症
			不適性 += 2
		IF TALENT:娼婦:男嫌い
			収入 -= 200
			不適性 += 3
		ENDIF
		IF TALENT:娼婦:同族嫌悪
			収入 -= 100
			不適性++
		ENDIF
		SIF TALENT:娼婦:Ｖ鈍感
			不適性++
		SIF TALENT:娼婦:Ａ鈍感
			不適性++
		;ハードは適性-15
		不適性 += 15
		;ここから能力で倍率計算
		IF 統率者("娼館", CFLAG:娼婦:娼館部屋番号) && !TALENT:娼婦:統率
			収入 += (収入/5)*(ABL:娼婦:従順+1)
			適性 += (ABL:娼婦:従順+1)/3

			収入 += (収入/5)*(ABL:娼婦:欲望+1)
			適性 += (ABL:娼婦:欲望+1)/2

			収入 += (収入/2)*(ABL:娼婦:技巧+1)
			適性 += (ABL:娼婦:技巧+1)/3

			IF VAGINA(娼婦)
				収入 += (収入/10)*(ABL:娼婦:Ｖ感覚+1)
				適性 += (ABL:娼婦:Ｖ感覚+1)/5
			ENDIF

			収入 += (収入/10)*(ABL:娼婦:Ａ感覚+1)
			適性 += (ABL:娼婦:Ａ感覚+1)/5

			収入 += (収入/5)*(ABL:娼婦:奉仕精神+1)
			適性 += (ABL:娼婦:奉仕精神+1)/3

			収入 += (収入/2)*(ABL:娼婦:性交中毒+1)
			適性 += (ABL:娼婦:性交中毒+1)/2
		ELSE
			収入 += (収入/5)*ABL:娼婦:従順
			適性 += ABL:娼婦:従順/3

			収入 += (収入/5)*ABL:娼婦:欲望
			適性 += ABL:娼婦:欲望/2

			収入 += (収入/2)*ABL:娼婦:技巧
			適性 += ABL:娼婦:技巧/3

			IF VAGINA(娼婦)
				収入 += (収入/10)*ABL:娼婦:Ｖ感覚
				適性 += ABL:娼婦:Ｖ感覚/5
			ENDIF

			収入 += (収入/10)*ABL:娼婦:Ａ感覚
			適性 += ABL:娼婦:Ａ感覚/5

			収入 += (収入/5)*ABL:娼婦:奉仕精神
			適性 += ABL:娼婦:奉仕精神/3

			収入 += (収入/2)*ABL:娼婦:性交中毒
			適性 += ABL:娼婦:性交中毒/2
		ENDIF
	;SM
	CASE 3
		;まずはプラス素質から計算
		;SMは我が強い子が結構稼げる 責めに回っても受けに回っても需要がある
		SIF TALENT:娼婦:処女
			収入 += 1000
		SIF TALENT:娼婦:生意気
			収入 += 200
		SIF TALENT:娼婦:反抗的
			収入 += 200
		SIF TALENT:娼婦:気丈
			収入 += 100
		SIF TALENT:娼婦:衝動的
			収入 += 150
		SIF TALENT:娼婦:プライド高い
			収入 += 150
		SIF TALENT:娼婦:保守的
			収入 += 100
		SIF TALENT:娼婦:一線越えない
			収入 += 100
		SIF TALENT:娼婦:貞操観念
			収入 += 150
		SIF TALENT:娼婦:抑圧
			収入 += 100
		SIF TALENT:娼婦:抵抗
			収入 += 150
		SIF TALENT:娼婦:弱味
			収入 += 50
		IF TALENT:娼婦:痛みに強い
			収入 += 50
			適性 += 3
		ENDIF
		SIF TALENT:娼婦:針さばき
			収入 += 100
		SIF TALENT:娼婦:おもらし癖
			収入 += 100
		SIF TALENT:娼婦:快感に素直
			適性 += 2
		SIF TALENT:娼婦:快感の否定
			収入 += 50
		SIF TALENT:娼婦:即落ち
			収入 += 50
		SIF TALENT:娼婦:倒錯的
			収入 += 200
		SIF TALENT:娼婦:両刀
			収入 += 50
		SIF TALENT:娼婦:サド
			収入 += 100
		SIF TALENT:娼婦:マゾ
			収入 += 100
		IF TALENT:娼婦:戦士
			収入 += 100
			適性++
		ENDIF
		IF TALENT:娼婦:強気
			収入 += 150
			適性++
		ENDIF
		SIF TALENT:娼婦:ふたなり
			収入 += 150
		;マイナス
		IF TALENT:娼婦:臆病
			収入 -= 100
			不適性++
		ENDIF
		IF TALENT:娼婦:素直
			収入 -= 50
			不適性++
		ENDIF
		IF TALENT:娼婦:大人しい
			収入 -= 100
			不適性++
		ENDIF
		IF TALENT:娼婦:無関心
			収入 -= 150
			不適性++
		ENDIF
		IF TALENT:娼婦:感情乏しい
			収入 -= 100
			不適性++
		ENDIF
		IF TALENT:娼婦:恥じらい
			収入 -= 50
			不適性 += 2
		ENDIF
		IF TALENT:娼婦:寂しがり屋
			収入 -= 100
			不適性++
		ENDIF
		IF TALENT:娼婦:痛みに弱い
			収入 -= 50
			不適性 += 5
		ENDIF
		SIF TALENT:娼婦:弱気
			不適性 += 3
		;SMは適性がかなり上がりにくいので適性-5
		不適性 += 5
		IF 統率者("娼館", CFLAG:娼婦:娼館部屋番号) && !TALENT:娼婦:統率
			;ここから能力で倍率計算
			収入 += (収入/10)*(ABL:娼婦:従順+1)
			適性 += (ABL:娼婦:従順+1)/3+1

			収入 += (収入/10)*(ABL:娼婦:欲望+1)
			適性 += (ABL:娼婦:欲望+1)/5

			収入 += (収入/10)*(ABL:娼婦:技巧+1)
			適性 += (ABL:娼婦:技巧+1)/5

			IF VAGINA(娼婦)
				収入 += (収入/10)*(ABL:娼婦:Ｖ感覚+1)
				適性 += (ABL:娼婦:Ｖ感覚+1)/5
			ENDIF

			収入 += (収入/10)*(ABL:娼婦:Ａ感覚+1)
			適性 += (ABL:娼婦:Ａ感覚+1)/5

			収入 += (収入/5)*(ABL:娼婦:露出癖+1)
			適性 += (ABL:娼婦:露出癖+1)/5

			収入 += (収入/2)*(ABL:娼婦:マゾっ気+1)
			適性 += (ABL:娼婦:マゾっ気+1)/2

			収入 += (収入/2)*(ABL:娼婦:サドっ気+1)
			適性 += (ABL:娼婦:サドっ気+1)/2
		ELSE
			;ここから能力で倍率計算
			収入 += (収入/10)*ABL:娼婦:従順
			適性 += ABL:娼婦:従順/3+1

			収入 += (収入/10)*ABL:娼婦:欲望
			適性 += ABL:娼婦:欲望/5

			収入 += (収入/10)*ABL:娼婦:技巧
			適性 += ABL:娼婦:技巧/5

			IF VAGINA(娼婦)
				収入 += (収入/10)*ABL:娼婦:Ｖ感覚
				適性 += ABL:娼婦:Ｖ感覚/5
			ENDIF

			収入 += (収入/10)*ABL:娼婦:Ａ感覚
			適性 += ABL:娼婦:Ａ感覚/5

			収入 += (収入/5)*ABL:娼婦:露出癖
			適性 += ABL:娼婦:露出癖/5

			収入 += (収入/2)*ABL:娼婦:マゾっ気
			適性 += ABL:娼婦:マゾっ気/2

			収入 += (収入/2)*ABL:娼婦:サドっ気
			適性 += ABL:娼婦:サドっ気/2
		ENDIF
	;ルナティック
	CASE 4
		;まずはプラス素質から計算
		IF TALENT:娼婦:崩壊
			収入 += 2000
			適性++
		ENDIF
		IF TALENT:娼婦:弱味
			収入 += 300
			適性++
		ENDIF
		IF TALENT:娼婦:倒錯的
			収入 += 500
			適性++
		ENDIF
		IF TALENT:娼婦:妄信
			収入 += 500
			適性++
		ENDIF
		SIF TALENT:娼婦:狐
			収入 += 300
		IF TALENT:娼婦:ネクロマンサー
			収入 += 300
			適性++
		ENDIF
		SIF TALENT:娼婦:バストサイズ == 6
			収入 += 200
		SIF TALENT:娼婦:ファーリー
			収入 += 200
		IF TALENT:娼婦:無機物
			収入 += 500
			適性++
		ENDIF
		SIF TALENT:娼婦:羽
			収入 += 100
		SIF TALENT:娼婦:小人体型
			収入 += 1000
		SIF TALENT:娼婦:性器破損
			収入 += 500
		IF TALENT:娼婦:ふたなり
			収入 += 300
			適性++
		ENDIF
		SIF TALENT:娼婦:吸血鬼
			収入 += 500
		SIF TALENT:娼婦:幼児／幼児退行
			収入 += 300
		SIF TALENT:娼婦:幼稚
			収入 += 300
		IF TALENT:娼婦:狂気
			収入 += 1000
			適性++
		ENDIF
		SIF TALENT:娼婦:夢喰い
			収入 += 200
		SIF TALENT:娼婦:ドラゴン使い
			収入 += 200
		IF TALENT:娼婦:リミットバースト
			収入 += 500
			適性++
		ENDIF
		;マイナス
		不適性 = 20
		;娼館レベルに応じて変動
		収入 = 収入*娼館レベル/50
		;ここから能力で倍率計算
		IF 統率者("娼館", CFLAG:娼婦:娼館部屋番号) && !TALENT:娼婦:統率
			収入 += (収入/10)*(ABL:娼婦:従順+1)
			適性 += (ABL:娼婦:従順+1)/3

			収入 += (収入/10)*(ABL:娼婦:欲望+1)
			適性 += (ABL:娼婦:欲望+1)/3

			収入 += (収入/10)*(ABL:娼婦:技巧+1)
			適性 += (ABL:娼婦:技巧+1)/3
		ELSE
			収入 += (収入/10)*ABL:娼婦:従順
			適性 += ABL:娼婦:従順/3

			収入 += (収入/10)*ABL:娼婦:欲望
			適性 += ABL:娼婦:欲望/3

			収入 += (収入/10)*ABL:娼婦:技巧
			適性 += ABL:娼婦:技巧/3
		ENDIF
ENDSELECT
;体力気力消費計算
消耗量 = MAX(不適性-適性, 1)
SELECTCASE 娼館方針
	;ソフト
	CASE 1
		BASE:娼婦:体力 -= 消耗量*50
		BASE:娼婦:気力 -= 消耗量*30
	;ハード
	CASE 2
		BASE:娼婦:体力 -= 消耗量*100
		BASE:娼婦:気力 -= 消耗量*50
	;SM
	CASE 3
		BASE:娼婦:体力 -= 消耗量*300
		BASE:娼婦:気力 -= 消耗量*70
	;狂気
	CASE 4
		BASE:娼婦:体力 -= 消耗量*200
		BASE:娼婦:気力 -= 消耗量*150
ENDSELECT
SIF BASE:娼婦:体力 <= 0
	BASE:娼婦:体力 = 1

;最低1000は保証
CALL SETMAX, 収入, 1000

収入 += 収入*娼館レベル/100

SELECTCASE 娼館方針
	CASE 1
		収入 += ソフトポイント*10
	CASE 2
		収入 += ハードポイント*10
	CASE 3
		収入 += SMポイント*10
	CASE 4
		収入 += 狂気ポイント*10
ENDSELECT

;お風呂場があるとストレス溜まりづらくなる
IF ITEM:お風呂場
	CFLAG:娼婦:ストレス値 += MAX(不適性-適性, 0)
ELSE
	CFLAG:娼婦:ストレス値 += MAX((不適性-適性)*2, 0)
ENDIF
;換気口あるとさらに軽減
SIF ITEM:換気口
	CFLAG:娼婦:ストレス値 -= 2
;実務経験を加算
EXP:娼婦:実務経験++

;適性-不適性をモチベーションに加算
CFLAG:娼婦:モチベーション = LIMIT(CFLAG:娼婦:モチベーション+適性-不適性, 1, 100)

;適性*10が習得に入る
SIF 適性 > 0
	JUEL:娼婦:習得 += 適性*10

RETURN 収入
