@上級売春
#DIM DYNAMIC 客の性別
#DIM DYNAMIC 素質数
#DIM DYNAMIC テーブル
#DIM DYNAMIC ポイント
VARSET LOCAL, 0

DRAWLINE
ADDVOIDCHARA
TARGET = CHARANUM-1
MASTER = FINDCHARA(CFLAG:上級娼婦, 1)
上級売春中 = 1

NAME:TARGET = 売春相手
CALLNAME:TARGET = 売春相手

PRINTFORM %CALLNAME:MASTER%の、今日の売春相手は
SELECTCASE RAND:6
	CASE 0
		PRINT 人間の
		CSTR:種族 = 人間
	CASE 1
		PRINT 精霊の
		CSTR:種族 = 精霊
	CASE 2
		PRINT 悪魔の
		CSTR:種族 = 悪魔
	CASE 3
		PRINT 鳳凰の
		CSTR:種族 = 鳳凰
	CASE 4
		PRINT 獣人の
		CSTR:種族 = 獣人
	CASE 5
		PRINT 人魚の
		CSTR:種族 = 人魚
ENDSELECT

;欲望は常に5
ABL:欲望 = 5
;従順は2
ABL:従順 = 2
;奉仕精神は1
ABL:奉仕精神 = 1
;技巧はランダム
ABL:技巧 = RAND(1, 6)

IF RAND:4 == 0
	PRINT 幼い
	TALENT:小柄体型 = 1
	;子供は技巧を消して従順と奉仕精神に割り振る
	ABL:従順 += ABL:技巧/2
	ABL:奉仕精神 += ABL:技巧/2
	ABL:技巧 = 0
ENDIF

SELECTCASE RAND:5
	CASE 0, 1
		PRINTW 男性だ
		TALENT:性別 = 1
	CASE 2
		PRINTW 女性だ
		TALENT:性別 = 2
	CASE 3
		PRINTW ふたなり男性だ
		TALENT:性別 = 1
		TALENT:ふたなり = 1
		EXP:射精経験 = 10
	CASE 4
		PRINTW ふたなり女性だ
		TALENT:性別 = 2
		TALENT:ふたなり = 1
		EXP:射精経験 = 10
ENDSELECT

;指名制だと思われるのでそれに応じた性嗜好を
IF TALENT:性別 == TALENT:MASTER:性別
	SELECTCASE SEX(TARGET)
		CASE 1
			TALENT:男好き = 1
			ABL:ホモっ気 = 3
			ABL:ゲイ中毒 = 2
		CASE 2
			TALENT:女好き = 1
			ABL:レズっ気 = 3
			ABL:レズ中毒 = 2
	ENDSELECT
ENDIF

;それぞれの部位感度は10のポイントからランダムで割り振られる
ポイント = 10
DO
	LOCAL = RAND:(ポイント+1)
	SELECTCASE RAND:4
		CASE 0
			SIF VAGINA(TARGET)
				ABL:Ｖ感覚 += LOCAL
		CASE 1
			ABL:Ｃ感覚 += LOCAL
		CASE 2
			ABL:Ａ感覚 += LOCAL
		CASE 3
			ABL:Ｂ感覚 += LOCAL
	ENDSELECT
	ポイント -= LOCAL
LOOP ポイント > 0

;ABLに応じて経験が付く
EXP:Ｖ経験 = ABL:Ｖ感覚*50
EXP:Ａ経験 = ABL:Ａ感覚*50

;反発刻印は付かない
MARK:反発刻印履歴 = 3
;最初から勃ってたり濡れてたりする
SIF VAGINA(TARGET)
	PALAM:潤滑 = 3000
SIF PENIS(TARGET)
	PALAM:欲情 = 3000

SELECTCASE 娼館方針
	;ソフトとハードは同じ
	CASE 1, 2
		LOCAL = RAND(4, 11)
		DO
			テーブル = RAND(1, 21)
			;既に決定済みのテーブルならやり直し
			SIF LOCAL:テーブル
				CONTINUE
			;素質の種類ごとにテーブルを置く
			SELECTCASE テーブル
				;生意気、臆病、ツンデレ
				CASE 1
					SELECTCASE RAND:3
						CASE 0
							TALENT:生意気 = 1
						CASE 1
							TALENT:臆病 = 1
						CASE 2
							TALENT:ツンデレ = 1
					ENDSELECT
				;素直、反抗的、衝動的
				CASE 2
					SELECTCASE RAND:3
						CASE 0
							TALENT:素直 = 1
						CASE 1
							TALENT:反抗的 = 1
						CASE 2
							TALENT:衝動的 = 1
					ENDSELECT
				;プライド高い、プライド低い
				CASE 3
					SELECTCASE RAND:2
						CASE 0
							TALENT:プライド高い = 1
						CASE 1
							TALENT:プライド低い = 1
					ENDSELECT
				;ハイテンション、大人しい
				CASE 4
					SELECTCASE RAND:2
						CASE 0
							TALENT:ハイテンション = 1
						CASE 1
							TALENT:大人しい = 1
					ENDSELECT
				;自制心、無関心、感情乏しい、好奇心
				CASE 5
					SELECTCASE RAND:4
						CASE 0
							TALENT:自制心 = 1
						CASE 1
							TALENT:無関心 = 1
						CASE 2
							TALENT:感情乏しい = 1
						CASE 3
							TALENT:好奇心 = 1
					ENDSELECT
				;保守的、楽観的、悲観的
				CASE 6
					SELECTCASE RAND:3
						CASE 0
							TALENT:保守的 = 1
						CASE 1
							TALENT:楽観的 = 1
						CASE 2
							TALENT:悲観的 = 1
					ENDSELECT
				;貞操観念、貞操無頓着
				CASE 7
					SELECTCASE RAND:2
						CASE 0
							TALENT:貞操観念 = 1
						CASE 1
							TALENT:貞操無頓着 = 1
					ENDSELECT
				;恥じらい、恥薄い、寂しがり屋
				CASE 8
					SELECTCASE RAND:3
						CASE 0
							TALENT:恥じらい = 1
						CASE 1
							TALENT:恥薄い = 1
						CASE 2
							TALENT:寂しがり屋 = 1
					ENDSELECT
				;痛みに弱い、痛みに強い
				CASE 9
					SELECTCASE RAND:2
						CASE 0
							TALENT:痛みに弱い = 1
						CASE 1
							TALENT:痛みに強い = 1
					ENDSELECT
				;濡れやすい、濡れにくい
				CASE 10
					SELECTCASE RAND:2
						CASE 0
							TALENT:濡れやすい = 1
						CASE 1
							TALENT:濡れにくい = 1
					ENDSELECT
				;習得早い、習得遅い
				CASE 11
					SELECTCASE RAND:2
						CASE 0
							TALENT:習得早い = 1
						CASE 1
							TALENT:習得遅い = 1
					ENDSELECT
				;汚臭鈍感、汚臭敏感
				CASE 12
					SELECTCASE RAND:2
						CASE 0
							TALENT:汚臭鈍感 = 1
						CASE 1
							TALENT:汚臭敏感 = 1
					ENDSELECT
				;汚れ無視、潔癖症
				CASE 13
					SELECTCASE RAND:2
						CASE 0
							TALENT:汚れ無視 = 1
						CASE 1
							TALENT:潔癖症 = 1
					ENDSELECT
				;快感に素直、快感の否定
				CASE 14
					SELECTCASE RAND:2
						CASE 0
							TALENT:快感に素直 = 1
						CASE 1
							TALENT:快感の否定 = 1
					ENDSELECT
				;サド、マゾ
				CASE 15
					SELECTCASE RAND:2
						CASE 0
							TALENT:サド = 1
						CASE 1
							TALENT:マゾ = 1
					ENDSELECT
				;Ｖ敏感鈍感
				CASE 16
					;男ならやり直し
					SIF TALENT:性別 == 1
						CONTINUE
					SELECTCASE RAND:2
						CASE 0
							TALENT:Ｖ敏感 = 1
						CASE 1
							TALENT:Ｖ鈍感 = 1
					ENDSELECT
				;Ｃ敏感鈍感
				CASE 17
					SELECTCASE RAND:2
						CASE 0
							TALENT:Ｃ敏感 = 1
						CASE 1
							TALENT:Ｃ鈍感 = 1
					ENDSELECT
				;Ａ敏感鈍感
				CASE 18
					SELECTCASE RAND:2
						CASE 0
							TALENT:Ａ敏感 = 1
						CASE 0
							TALENT:Ａ鈍感 = 1
					ENDSELECT
				;Ｂ敏感鈍感
				CASE 19
					SELECTCASE RAND:2
						CASE 0
							TALENT:Ｂ敏感 = 1
						CASE 1
							TALENT:Ｂ鈍感 = 1
					ENDSELECT
				;貞操と絶倫
				CASE 20
					;お子様は無条件で経験無し 大人でも5分の1で経験無し
					IF TALENT:小柄体型 || !RAND:5
						SIF PENIS(TARGET)
							TALENT:童貞 = 1
						IF VAGINA(TARGET)
							TALENT:処女 = 1
							ABL:Ｖ感覚 = 0
							EXP:Ｖ経験 = 0
						ENDIF
					ELSE
						SIF PENIS(TARGET)
							TALENT:絶倫 = 1
						IF TALENT:性別 == 2
							TALENT:母乳体質 = 1
							EXP:噴乳経験 = 10
						ENDIF
					ENDIF
			ENDSELECT
			LOCAL:テーブル = 1
			素質数++
		LOOP LOCAL != 素質数
	CASE 3
		;サドかマゾは必ず付く
		SELECTCASE RAND:5
			CASE 0
				TALENT:マゾ = 1
			CASE 1
				TALENT:サド = 1
		ENDSELECT
		LOCAL = RAND(6, 9)
		DO
			テーブル = RAND(1, 15)
			;既に決定済みのテーブルならやり直し
			SIF LOCAL:テーブル
				CONTINUE
			;素質の種類ごとにテーブルを置く
			SELECTCASE テーブル
				;生意気、臆病、ツンデレ
				CASE 1
					SELECTCASE RAND:2
						CASE 0
							TALENT:生意気 = 1
						CASE 1
							TALENT:ツンデレ = 1
					ENDSELECT
				;素直、反抗的、衝動的
				CASE 2
					TALENT:衝動的 = 1
				;ハイテンション、大人しい
				CASE 3
					SELECTCASE RAND:2
						CASE 0
							TALENT:ハイテンション = 1
						CASE 1
							TALENT:大人しい = 1
					ENDSELECT
				;プライド高い、プライド低い
				CASE 4
					IF TALENT:サド
						TALENT:プライド高い = 1
					ELSE
						TALENT:プライド低い = 1
					ENDIF
				;保守的、楽観的、悲観的
				CASE 5
					SELECTCASE RAND:3
						CASE 0
							TALENT:保守的 = 1
						CASE 1
							TALENT:楽観的 = 1
						CASE 2
							TALENT:悲観的 = 1
					ENDSELECT
				;痛みに弱い、痛みに強い
				CASE 6
					SELECTCASE RAND:2
						CASE 0
							TALENT:痛みに弱い = 1
						CASE 1
							TALENT:痛みに強い = 1
					ENDSELECT
				;濡れやすい、濡れにくい
				CASE 7
					SELECTCASE RAND:2
						CASE 0
							TALENT:濡れやすい = 1
						CASE 1
							TALENT:濡れにくい = 1
					ENDSELECT
				;汚臭鈍感、汚臭敏感
				CASE 8
					SELECTCASE RAND:2
						CASE 0
							TALENT:汚臭鈍感 = 1
						CASE 1
							TALENT:汚臭敏感 = 1
					ENDSELECT
				;汚れ無視、潔癖症
				CASE 9
					SELECTCASE RAND:2
						CASE 0
							TALENT:汚れ無視 = 1
						CASE 1
							TALENT:潔癖症 = 1
					ENDSELECT
				;快感に素直、快感の否定
				CASE 10
					SELECTCASE RAND:2
						CASE 0
							TALENT:快感に素直 = 1
						CASE 1
							TALENT:快感の否定 = 1
					ENDSELECT
				;Ｖ敏感鈍感
				CASE 11
					;男ならやり直し
					SIF TALENT:性別 == 1
						CONTINUE
					SELECTCASE RAND:2
						CASE 0
							TALENT:Ｖ敏感 = 1
						CASE 1
							TALENT:Ｖ鈍感 = 1
					ENDSELECT
				;Ｃ敏感鈍感
				CASE 12
					SELECTCASE RAND:2
						CASE 0
							TALENT:Ｃ敏感 = 1
						CASE 1
							TALENT:Ｃ鈍感 = 1
					ENDSELECT
				;Ａ敏感鈍感
				CASE 13
					SELECTCASE RAND:2
						CASE 0
							TALENT:Ａ敏感 = 1
						CASE 0
							TALENT:Ａ鈍感 = 1
					ENDSELECT
				;Ｂ敏感鈍感
				CASE 14
					SELECTCASE RAND:2
						CASE 0
							TALENT:Ｂ敏感 = 1
						CASE 1
							TALENT:Ｂ鈍感 = 1
					ENDSELECT
			ENDSELECT
			LOCAL:テーブル = 1
			素質数++
		LOOP LOCAL != 素質数
	CASE 4
		LOCAL = RAND(3, 6)
		DO
			テーブル = RAND(1, 8)
			;既に決定済みのテーブルならやり直し
			SIF LOCAL:テーブル
				CONTINUE
			;素質の種類ごとにテーブルを置く
			SELECTCASE テーブル
				;痛みに弱い、痛みに強い
				CASE 1
					SELECTCASE RAND:2
						CASE 0
							TALENT:痛みに弱い = 1
						CASE 1
							TALENT:痛みに強い = 1
					ENDSELECT
				;濡れやすい、濡れにくい
				CASE 2
					SELECTCASE RAND:2
						CASE 0
							TALENT:濡れやすい = 1
						CASE 1
							TALENT:濡れにくい = 1
					ENDSELECT
				;サド、マゾ
				CASE 3
					SELECTCASE RAND:2
						CASE 0
							TALENT:サド = 1
						CASE 1
							TALENT:マゾ = 1
					ENDSELECT
				;Ｖ敏感鈍感
				CASE 4
					;男ならやり直し
					SIF TALENT:性別 == 1
						CONTINUE
					SELECTCASE RAND:2
						CASE 0
							TALENT:Ｖ敏感 = 1
						CASE 1
							TALENT:Ｖ鈍感 = 1
					ENDSELECT
				;Ｃ敏感鈍感
				CASE 5
					SELECTCASE RAND:2
						CASE 0
							TALENT:Ｃ敏感 = 1
						CASE 1
							TALENT:Ｃ鈍感 = 1
					ENDSELECT
				;Ａ敏感鈍感
				CASE 6
					SELECTCASE RAND:2
						CASE 0
							TALENT:Ａ敏感 = 1
						CASE 0
							TALENT:Ａ鈍感 = 1
					ENDSELECT
				;Ｂ敏感鈍感
				CASE 7
					SELECTCASE RAND:2
						CASE 0
							TALENT:Ｂ敏感 = 1
						CASE 1
							TALENT:Ｂ鈍感 = 1
					ENDSELECT
			ENDSELECT
		LOOP LOCAL != 素質数
ENDSELECT


;BEGIN TRAIN

CALL EVENTUSERTRAIN
DO
	CALL SHOW_STATUS
	CALL SHOW_USERCOM
	INPUT
	CALL USERCOM
LOOP 上級売春中 != 2

DELCHARA TARGET

