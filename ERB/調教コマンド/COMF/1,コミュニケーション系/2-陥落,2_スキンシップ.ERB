;-------------------------------------------------
;スキンシップ
;-------------------------------------------------
@USERCOM_ABLE_スキンシップ, ARG
#FUNCTION
;スキンシップ
;奴隷が恋慕か親愛で実行者が主人でないとダメ
SIF FALLTYPE(TARGET) != 1 || PLAYER != MASTER
	RETURNF 0
;拘束中はダメ
SIF TEQUIP:アイマスク || TEQUIP:縄 || TEQUIP:触手
	RETURNF 0

COMRESULT = 1
RETURNF 1

@COM_スキンシップ
PRINTL スキンシップ
CALL KOJO_MESSAGE_COM

;-------------------------------------------------
;射精ゲージチェック（奴隷）
;-------------------------------------------------
;何かのはずみで触れてしまったら
IF RAND:2 == 0
	LOCAL = 50
ELSE
	LOCAL = 0
ENDIF

;ABL:調教者の技巧をみる
LOCAL += LOCAL*ABL:PLAYER:技巧

;ABL:欲望をみる
LOCAL += (LOCAL/5)*ABL:欲望

CALL 射精ゲージ増加, LOCAL, TARGET

;-------------------------------------------------
;ソース追加処理
;-------------------------------------------------
;消費体力、気力
LOSEBASE:体力 += 10
LOSEBASE:気力 += 20

SOURCE:情愛 = 500
SOURCE:性行動 = 500
SOURCE:逸脱 = 10
SOURCE:達成 = 300

;-------------------------------------------------
;絶頂チェック
;-------------------------------------------------
CALL SOURCE_CHECK_CVAB

;-------------------------------------------------
;射精チェック
;-------------------------------------------------
CALL SAMEN_CHECK_T

CALL SAMEN_SHOOT_T, 0, NOWEX:射精

;-------------------------------------------------
;経験の処理
;-------------------------------------------------
;愛情経験
PRINTL 愛情経験+1
EXP:愛情経験 += 1

;依存度補正値(恋慕で1、親愛で2）
IF TALENT:恋慕
	TFLAG:依存度補正 += 1
ELSEIF TALENT:親愛
	TFLAG:依存度補正 += 2
ENDIF

RETURN 1

