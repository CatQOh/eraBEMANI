;-------------------------------------------------
;数珠繋ぎ
;セックス系派生コマンド
;-------------------------------------------------
@USERCOM_ABLE512
;1=MASTER 2=ASSI 3=TARGET
;132だったら主人→奴隷→助手
;312だったら奴隷→主人→助手
;といった具合
;数珠繋ぎ実行判定
;助手がいないとダメ
SIF ASSI < 1
	RETURN 0
;ペニスバンド使ってるとダメ、入れられる側が処女でもダメ
SELECTCASE TFLAG:数珠繋ぎ
	;主人→助手→奴隷
	CASE 123
		SIF !PENIS(MASTER)
			RETURN 0
		SIF !PENIS(ASSI)
			RETURN 0
		SIF TALENT:ASSI:処女 && TFLAG:主人挿入箇所 == 1
			RETURN 0
		SIF TALENT:処女 && TFLAG:助手挿入箇所 == 1
			RETURN 0
	CASE 132
		SIF !PENIS(MASTER)
			RETURN 0
		SIF !PENIS(TARGET)
			RETURN 0
		SIF TALENT:ASSI:処女 && TFLAG:奴隷挿入箇所 == 1
			RETURN 0
		SIF TALENT:処女 && TFLAG:主人挿入箇所 == 1
			RETURN 0
	CASE 231
		SIF !PENIS(TARGET)
			RETURN 0
		SIF !PENIS(ASSI)
			RETURN 0
		SIF TALENT:処女 && TFLAG:助手挿入箇所 == 1
			RETURN 0
		SIF TALENT:MASTER:処女 && TFLAG:奴隷挿入箇所 == 1
			RETURN 0
	CASE 312
		SIF !PENIS(MASTER)
			RETURN 0
		SIF !PENIS(TARGET)
			RETURN 0
		SIF TALENT:MASTER:処女 && TFLAG:奴隷挿入箇所 == 1
			RETURN 0
		SIF TALENT:ASSI:処女 && TFLAG:主人挿入箇所 == 1
			RETURN 0
ENDSELECT

RETURN 1

@COM512
PRINT 数珠繋ぎ
SELECTCASE TFLAG:数珠繋ぎ
	CASE 123
		PRINTFORML (%CALLNAME:MASTER%→%CALLNAME:ASSI%→%CALLNAME:TARGET%)
	CASE 132
		PRINTFORML (%CALLNAME:MASTER%→%CALLNAME:TARGET%→%CALLNAME:ASSI%)
	CASE 231
		PRINTFORML (%CALLNAME:ASSI%→%CALLNAME:TARGET%→%CALLNAME:MASTER%)
	CASE 312
		PRINTFORML (%CALLNAME:TARGET%→%CALLNAME:MASTER%→%CALLNAME:ASSI%)
ENDSELECT
SELECTCOMS = 数珠繋ぎ
SELECTCOM = 512
CALL KOJO_MESSAGE_COM

;V経験を伴うコマンドのフラグ(処女膜再生対応)
SELECTCASE TFLAG:数珠繋ぎ
	CASE 123
		IF TALENT:MASTER:童貞
			TALENT:MASTER:童貞 = 0
			IF TALENT:MASTER:性転換済
				VIRGIN:MASTER:10 = %NAME:ASSI%
			ELSE
				VIRGIN:MASTER:0 = %NAME:ASSI%
			ENDIF
		ENDIF
		IF TALENT:ASSI:童貞
			TALENT:ASSI:童貞 = 0
			IF TALENT:ASSI:性転換済
				VIRGIN:ASSI:10 = %NAME:TARGET%
			ELSE
				VIRGIN:ASSI:0 = %NAME:TARGET%
			ENDIF
		ENDIF
	CASE 132
		IF TALENT:MASTER:童貞
			TALENT:MASTER:童貞 = 0
			IF TALENT:MASTER:性転換済
				VIRGIN:MASTER:10 = %NAME:TARGET%
			ELSE
				VIRGIN:MASTER:0 = %NAME:TARGET%
			ENDIF
		ENDIF
		IF TALENT:童貞
			TALENT:童貞 = 0
			IF TALENT:性転換済
				VIRGIN:10 = %NAME:ASSI%
			ELSE
				VIRGIN:0 = %NAME:ASSI%
			ENDIF
		ENDIF
	CASE 231
		IF TALENT:ASSI:童貞
			TALENT:ASSI:童貞 = 0
			IF TALENT:ASSI:性転換済
				VIRGIN:ASSI:10 = %NAME:TARGET%
			ELSE
				VIRGIN:ASSI:0 = %NAME:TARGET%
			ENDIF
		ENDIF
		IF TALENT:童貞
			TALENT:童貞 = 0
			IF TALENT:性転換済
				VIRGIN:10 = %NAME:MASTER%
			ELSE
				VIRGIN:0 = %NAME:MASTER%
			ENDIF
		ENDIF
	CASE 312
		IF TALENT:童貞
			TALENT:童貞 = 0
			IF TALENT:性転換済
				VIRGIN:10 = %NAME:MASTER%
			ELSE
				VIRGIN:0 = %NAME:MASTER%
			ENDIF
		ENDIF
		IF TALENT:MASTER:童貞
			TALENT:MASTER:童貞 = 0
			IF TALENT:MASTER:性転換済
				VIRGIN:MASTER:10 = %NAME:ASSI%
			ELSE
				VIRGIN:MASTER:0 = %NAME:ASSI%
			ENDIF
		ENDIF
ENDSELECT

;-------------------------------------------------
;脱衣
;-------------------------------------------------
IF OVER_GENITAL(TARGET) != ""
	IF CFLAG:挿入可
		TEQUIP:下半身下着 = 0
	ELSE
		TEQUIP:下半身下着 = 0
		TEQUIP:下半身上着 = 0
		TEQUIP:全身上着 = 0
	ENDIF
ENDIF
IF OVER_GENITAL(MASTER) != ""
	IF CFLAG:MASTER:挿入可
		TEQUIP:MASTER:下半身下着 = 0
	ELSE
		TEQUIP:MASTER:下半身下着 = 0
		TEQUIP:MASTER:下半身上着 = 0
		TEQUIP:MASTER:全身上着 = 0
	ENDIF
ENDIF
IF OVER_GENITAL(ASSI) != ""
	IF CFLAG:ASSI:挿入可
		TEQUIP:ASSI:下半身下着 = 0
	ELSE
		TEQUIP:ASSI:下半身下着 = 0
		TEQUIP:ASSI:下半身上着 = 0
		TEQUIP:ASSI:全身上着 = 0
	ENDIF
ENDIF

;-------------------------------------------------
;射精ゲージチェック（主人）
;-------------------------------------------------
LOCAL = 1800

;ABL:技巧を見る
SELECTCASE ABL:技巧
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 1.20
	CASE 2
		TIMES LOCAL , 1.40
	CASE 3
		TIMES LOCAL , 1.60
	CASE 4
		TIMES LOCAL , 1.80
	CASEELSE
		TIMES LOCAL , 2.00
ENDSELECT
SELECTCASE ABL:ASSI:技巧
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 1.20
	CASE 2
		TIMES LOCAL , 1.40
	CASE 3
		TIMES LOCAL , 1.60
	CASE 4
		TIMES LOCAL , 1.80
	CASEELSE
		TIMES LOCAL , 2.00
ENDSELECT

;ABL:従順をみる
SELECTCASE ABL:従順
	CASE 0
		TIMES LOCAL , 0.80
	CASE 1
		TIMES LOCAL , 0.90
	CASE 2
		TIMES LOCAL , 1.00
	CASE 3
		TIMES LOCAL , 1.10
	CASE 4
		TIMES LOCAL , 1.20
	CASEELSE
		TIMES LOCAL , 1.30
ENDSELECT
SELECTCASE ABL:ASSI:従順
	CASE 0
		TIMES LOCAL , 0.80
	CASE 1
		TIMES LOCAL , 0.90
	CASE 2
		TIMES LOCAL , 1.00
	CASE 3
		TIMES LOCAL , 1.10
	CASE 4
		TIMES LOCAL , 1.20
	CASEELSE
		TIMES LOCAL , 1.30
ENDSELECT

;ABL:欲望をみる
SELECTCASE ABL:欲望
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 1.10
	CASE 2
		TIMES LOCAL , 1.20
	CASE 3
		TIMES LOCAL , 1.30
	CASE 4
		TIMES LOCAL , 1.40
	CASEELSE
		TIMES LOCAL , 1.50
ENDSELECT
SELECTCASE ABL:ASSI:欲望
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 1.10
	CASE 2
		TIMES LOCAL , 1.20
	CASE 3
		TIMES LOCAL , 1.30
	CASE 4
		TIMES LOCAL , 1.40
	CASEELSE
		TIMES LOCAL , 1.50
ENDSELECT

;奴隷に挿入時、PALAM:潤滑をみる
SELECTCASE TFLAG:数珠繋ぎ
	CASE 132
		IF PALAM:潤滑 < PALAMLV:1
			TIMES LOCAL , 0.60
		ELSEIF PALAM:潤滑 < PALAMLV:2
			TIMES LOCAL , 0.80
		ELSEIF PALAM:潤滑 < PALAMLV:3
			TIMES LOCAL , 1.00
		ELSEIF PALAM:潤滑 < PALAMLV:4
			TIMES LOCAL , 1.20
		ELSEIF PALAM:潤滑 >= PALAMLV:4
			TIMES LOCAL , 1.40
		ENDIF
ENDSELECT

;主人のABL:Ｃ感覚をみる
SELECTCASE ABL:MASTER:Ｃ感覚
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 1.50
	CASE 2
		TIMES LOCAL , 2.00
	CASE 3
		TIMES LOCAL , 2.50
	CASE 4
		TIMES LOCAL , 3.50
	CASEELSE
		TIMES LOCAL , 5.00
ENDSELECT

;主人が挿れられてる側なら主人の感覚を見る
SELECTCASE TFLAG:数珠繋ぎ
	CASE 231, 312
		SELECTCASE TFLAG:奴隷挿入箇所
			CASE 1
				SELECTCASE ABL:MASTER:Ｖ感覚
					CASE 0
						TIMES LOCAL , 1.00
					CASE 1
						TIMES LOCAL , 1.20
					CASE 2
						TIMES LOCAL , 1.50
					CASE 3
						TIMES LOCAL , 2.00
					CASE 4
						TIMES LOCAL , 2.50
					CASEELSE
						TIMES LOCAL , 3.00
				ENDSELECT
			CASE 2
				SELECTCASE ABL:MASTER:Ａ感覚
					CASE 0
						TIMES LOCAL , 1.00
					CASE 1
						TIMES LOCAL , 1.20
					CASE 2
						TIMES LOCAL , 1.50
					CASE 3
						TIMES LOCAL , 2.00
					CASE 4
						TIMES LOCAL , 2.50
					CASEELSE
						TIMES LOCAL , 3.00
				ENDSELECT
		ENDSELECT
	;挿れられてなければ無条件で1.5倍
	CASEELSE
		TIMES LOCAL , 1.50
ENDSELECT

;再装填処理中は射精ゲージは20分の1に
SIF CFLAG:MASTER:賢者タイム > 0
	LOCAL /= 20

BASE:MASTER:射精 += LOCAL

;-------------------------------------------------
;射精ゲージチェック（助手）
;-------------------------------------------------
LOCAL = 1800

;ABL:技巧を見る
SELECTCASE ABL:技巧
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 1.20
	CASE 2
		TIMES LOCAL , 1.40
	CASE 3
		TIMES LOCAL , 1.60
	CASE 4
		TIMES LOCAL , 1.80
	CASEELSE
		TIMES LOCAL , 2.00
ENDSELECT
SELECTCASE ABL:MASTER:技巧
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 1.20
	CASE 2
		TIMES LOCAL , 1.40
	CASE 3
		TIMES LOCAL , 1.60
	CASE 4
		TIMES LOCAL , 1.80
	CASEELSE
		TIMES LOCAL , 2.00
ENDSELECT

;ABL:従順をみる
SELECTCASE ABL:従順
	CASE 0
		TIMES LOCAL , 0.80
	CASE 1
		TIMES LOCAL , 0.90
	CASE 2
		TIMES LOCAL , 1.00
	CASE 3
		TIMES LOCAL , 1.10
	CASE 4
		TIMES LOCAL , 1.20
	CASEELSE
		TIMES LOCAL , 1.30
ENDSELECT
SELECTCASE ABL:ASSI:従順
	CASE 0
		TIMES LOCAL , 0.80
	CASE 1
		TIMES LOCAL , 0.90
	CASE 2
		TIMES LOCAL , 1.00
	CASE 3
		TIMES LOCAL , 1.10
	CASE 4
		TIMES LOCAL , 1.20
	CASEELSE
		TIMES LOCAL , 1.30
ENDSELECT

;ABL:欲望をみる
SELECTCASE ABL:欲望
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 1.10
	CASE 2
		TIMES LOCAL , 1.20
	CASE 3
		TIMES LOCAL , 1.30
	CASE 4
		TIMES LOCAL , 1.40
	CASEELSE
		TIMES LOCAL , 1.50
ENDSELECT
SELECTCASE ABL:ASSI:欲望
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 1.10
	CASE 2
		TIMES LOCAL , 1.20
	CASE 3
		TIMES LOCAL , 1.30
	CASE 4
		TIMES LOCAL , 1.40
	CASEELSE
		TIMES LOCAL , 1.50
ENDSELECT

;奴隷に挿入時、PALAM:潤滑をみる
SELECTCASE TFLAG:数珠繋ぎ
	CASE 123, 231
		IF PALAM:潤滑 < PALAMLV:1
			TIMES LOCAL , 0.60
		ELSEIF PALAM:潤滑 < PALAMLV:2
			TIMES LOCAL , 0.80
		ELSEIF PALAM:潤滑 < PALAMLV:3
			TIMES LOCAL , 1.00
		ELSEIF PALAM:潤滑 < PALAMLV:4
			TIMES LOCAL , 1.20
		ELSEIF PALAM:潤滑 >= PALAMLV:4
			TIMES LOCAL , 1.40
		ENDIF
ENDSELECT

;助手のABL:Ｃ感覚をみる
SELECTCASE ABL:ASSI:Ｃ感覚
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 1.50
	CASE 2
		TIMES LOCAL , 2.00
	CASE 3
		TIMES LOCAL , 2.50
	CASE 4
		TIMES LOCAL , 3.50
	CASEELSE
		TIMES LOCAL , 5.00
ENDSELECT

;助手が挿れられてる側なら助手の感覚を見る
SELECTCASE TFLAG:数珠繋ぎ
	CASE 123, 312
		SELECTCASE TFLAG:主人挿入箇所
			CASE 1
				SELECTCASE ABL:ASSI:Ｖ感覚
					CASE 0
						TIMES LOCAL , 1.00
					CASE 1
						TIMES LOCAL , 1.20
					CASE 2
						TIMES LOCAL , 1.50
					CASE 3
						TIMES LOCAL , 2.00
					CASE 4
						TIMES LOCAL , 2.50
					CASEELSE
						TIMES LOCAL , 3.00
				ENDSELECT
			CASE 2
				SELECTCASE ABL:ASSI:Ａ感覚
					CASE 0
						TIMES LOCAL , 1.00
					CASE 1
						TIMES LOCAL , 1.20
					CASE 2
						TIMES LOCAL , 1.50
					CASE 3
						TIMES LOCAL , 2.00
					CASE 4
						TIMES LOCAL , 2.50
					CASEELSE
						TIMES LOCAL , 3.00
				ENDSELECT
		ENDSELECT
	CASE 132
		SELECTCASE TFLAG:奴隷挿入箇所
			CASE 1
				SELECTCASE ABL:ASSI:Ｖ感覚
					CASE 0
						TIMES LOCAL , 1.00
					CASE 1
						TIMES LOCAL , 1.20
					CASE 2
						TIMES LOCAL , 1.50
					CASE 3
						TIMES LOCAL , 2.00
					CASE 4
						TIMES LOCAL , 2.50
					CASEELSE
						TIMES LOCAL , 3.00
				ENDSELECT
			CASE 2
				SELECTCASE ABL:ASSI:Ａ感覚
					CASE 0
						TIMES LOCAL , 1.00
					CASE 1
						TIMES LOCAL , 1.20
					CASE 2
						TIMES LOCAL , 1.50
					CASE 3
						TIMES LOCAL , 2.00
					CASE 4
						TIMES LOCAL , 2.50
					CASEELSE
						TIMES LOCAL , 3.00
				ENDSELECT
		ENDSELECT
	;挿れられてなければ無条件で1.5倍
	CASEELSE
		TIMES LOCAL , 1.50
ENDSELECT

;再装填処理中は射精ゲージは20分の1に
SIF CFLAG:ASSI:賢者タイム > 0
	LOCAL /= 20

BASE:ASSI:射精 += LOCAL

;-------------------------------------------------
;射精ゲージチェック（奴隷）
;-------------------------------------------------
LOCAL = 1800

;ABL:技巧を見る
SELECTCASE ABL:ASSI:技巧
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 1.20
	CASE 2
		TIMES LOCAL , 1.40
	CASE 3
		TIMES LOCAL , 1.60
	CASE 4
		TIMES LOCAL , 1.80
	CASEELSE
		TIMES LOCAL , 2.00
ENDSELECT
SELECTCASE ABL:MASTER:技巧
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 1.20
	CASE 2
		TIMES LOCAL , 1.40
	CASE 3
		TIMES LOCAL , 1.60
	CASE 4
		TIMES LOCAL , 1.80
	CASEELSE
		TIMES LOCAL , 2.00
ENDSELECT

;ABL:従順をみる
SELECTCASE ABL:従順
	CASE 0
		TIMES LOCAL , 0.80
	CASE 1
		TIMES LOCAL , 0.90
	CASE 2
		TIMES LOCAL , 1.00
	CASE 3
		TIMES LOCAL , 1.10
	CASE 4
		TIMES LOCAL , 1.20
	CASEELSE
		TIMES LOCAL , 1.30
ENDSELECT
SELECTCASE ABL:ASSI:従順
	CASE 0
		TIMES LOCAL , 0.80
	CASE 1
		TIMES LOCAL , 0.90
	CASE 2
		TIMES LOCAL , 1.00
	CASE 3
		TIMES LOCAL , 1.10
	CASE 4
		TIMES LOCAL , 1.20
	CASEELSE
		TIMES LOCAL , 1.30
ENDSELECT

;ABL:欲望をみる
SELECTCASE ABL:欲望
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 1.10
	CASE 2
		TIMES LOCAL , 1.20
	CASE 3
		TIMES LOCAL , 1.30
	CASE 4
		TIMES LOCAL , 1.40
	CASEELSE
		TIMES LOCAL , 1.50
ENDSELECT
SELECTCASE ABL:ASSI:欲望
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 1.10
	CASE 2
		TIMES LOCAL , 1.20
	CASE 3
		TIMES LOCAL , 1.30
	CASE 4
		TIMES LOCAL , 1.40
	CASEELSE
		TIMES LOCAL , 1.50
ENDSELECT

;PALAM:潤滑をみる
SELECTCASE TFLAG:数珠繋ぎ
	CASE 123, 132, 231
		IF PALAM:潤滑 < PALAMLV:1
			TIMES LOCAL , 0.60
		ELSEIF PALAM:潤滑 < PALAMLV:2
			TIMES LOCAL , 0.80
		ELSEIF PALAM:潤滑 < PALAMLV:3
			TIMES LOCAL , 1.00
		ELSEIF PALAM:潤滑 < PALAMLV:4
			TIMES LOCAL , 1.20
		ELSEIF PALAM:潤滑 >= PALAMLV:4
			TIMES LOCAL , 1.40
		ENDIF
ENDSELECT

;ABL:Ｃ感覚をみる
SELECTCASE ABL:Ｃ感覚
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 1.50
	CASE 2
		TIMES LOCAL , 2.00
	CASE 3
		TIMES LOCAL , 2.50
	CASE 4
		TIMES LOCAL , 3.50
	CASEELSE
		TIMES LOCAL , 5.00
ENDSELECT

;奴隷が挿れられてる側なら奴隷の感覚を見る
SELECTCASE TFLAG:数珠繋ぎ
	CASE 123, 231
		SELECTCASE TFLAG:助手挿入箇所
			CASE 1
				SELECTCASE ABL:Ｖ感覚
					CASE 0
						TIMES LOCAL , 1.00
					CASE 1
						TIMES LOCAL , 1.20
					CASE 2
						TIMES LOCAL , 1.50
					CASE 3
						TIMES LOCAL , 2.00
					CASE 4
						TIMES LOCAL , 2.50
					CASEELSE
						TIMES LOCAL , 3.00
				ENDSELECT
			CASE 2
				SELECTCASE ABL:Ａ感覚
					CASE 0
						TIMES LOCAL , 1.00
					CASE 1
						TIMES LOCAL , 1.20
					CASE 2
						TIMES LOCAL , 1.50
					CASE 3
						TIMES LOCAL , 2.00
					CASE 4
						TIMES LOCAL , 2.50
					CASEELSE
						TIMES LOCAL , 3.00
				ENDSELECT
		ENDSELECT
	CASE 132
		SELECTCASE TFLAG:主人挿入箇所
			CASE 1
				SELECTCASE ABL:Ｖ感覚
					CASE 0
						TIMES LOCAL , 1.00
					CASE 1
						TIMES LOCAL , 1.20
					CASE 2
						TIMES LOCAL , 1.50
					CASE 3
						TIMES LOCAL , 2.00
					CASE 4
						TIMES LOCAL , 2.50
					CASEELSE
						TIMES LOCAL , 3.00
				ENDSELECT
			CASE 2
				SELECTCASE ABL:Ａ感覚
					CASE 0
						TIMES LOCAL , 1.00
					CASE 1
						TIMES LOCAL , 1.20
					CASE 2
						TIMES LOCAL , 1.50
					CASE 3
						TIMES LOCAL , 2.00
					CASE 4
						TIMES LOCAL , 2.50
					CASEELSE
						TIMES LOCAL , 3.00
				ENDSELECT
		ENDSELECT
	;挿れられてなければ無条件で1.5倍
	CASEELSE
		TIMES LOCAL , 1.50
ENDSELECT

;再装填処理中は射精ゲージは20分の1に
SIF CFLAG:賢者タイム > 0
	LOCAL /= 20

BASE:射精 += LOCAL

;-------------------------------------------------
;ソース追加処理
;-------------------------------------------------
;消費体力、気力
LOSEBASE:体力 += 80
LOSEBASE:気力 += 150

SOURCE:情愛 = 500
SOURCE:性行動 = 1000
SOURCE:中毒 = 500
SOURCE:恐怖 = 200
SOURCE:屈従 = 1000
SOURCE:逸脱 = 800
SOURCE:反感 = 600

;挿入している部位によって、ソースの数値が変化する
SELECTCASE TFLAG:数珠繋ぎ
	CASE 123, 231
		SELECTCASE TFLAG:助手挿入箇所
			CASE 1
				SOURCE:快V += 700
				SOURCE:性行動 += 100
				SOURCE:苦痛 += 500
			CASE 2
				SOURCE:快A += 700
				SOURCE:性行動 += 100
				SOURCE:苦痛 += 800
		ENDSELECT
	CASE 132
		SELECTCASE TFLAG:主人挿入箇所
			CASE 1
				SOURCE:快V += 700
				SOURCE:性行動 += 100
				SOURCE:苦痛 += 500
			CASE 2
				SOURCE:快A += 700
				SOURCE:性行動 += 100
				SOURCE:苦痛 += 800
		ENDSELECT
	CASE 312
		SOURCE:性行動 += 600
		SOURCE:屈服 += 300
ENDSELECT

;-------------------------------------------------
;特殊ソース処理
;-------------------------------------------------
;抑圧、抵抗持ちには、抑鬱ソース追加
SIF TALENT:抑圧 || TALENT:抵抗
	SOURCE:鬱屈 += 500

;貞操観念持ちで恋慕、親愛持ち以外には常に反発のソースを追加する（セックス系のみ）
SIF TALENT:貞操観念 && FALLTYPE(TARGET) != 1
	SOURCE:反感 += 1000

SELECTCASE TFLAG:数珠繋ぎ
	CASE 123, 231
		SELECTCASE TFLAG:助手挿入箇所
			CASE 1
				;Vへの苦痛は先に処理しておく
				;EXP:Ｖ経験をみる（処女の反感は別途処理済みなので省略）
				IF EXP:Ｖ経験 < EXPLV:1
					TIMES SOURCE:苦痛 , 2.50
				ELSEIF EXP:Ｖ経験 < EXPLV:2
					TIMES SOURCE:苦痛 , 0.80
					TIMES SOURCE:反感 , 1.20
				ELSEIF EXP:Ｖ経験 < EXPLV:3
					TIMES SOURCE:苦痛 , 0.40
				ELSEIF EXP:Ｖ経験 < EXPLV:4
					TIMES SOURCE:苦痛 , 0.10
				ELSEIF EXP:Ｖ経験 < EXPLV:5
					TIMES SOURCE:苦痛 , 0.00
				ELSEIF EXP:Ｖ経験 >= EXPLV:5
					TIMES SOURCE:苦痛 , 0.00
				ENDIF
				;PALAM:潤滑をみる
				IF PALAM:潤滑 < PALAMLV:1
					TIMES SOURCE:苦痛 , 1.20
					TIMES SOURCE:反感 , 1.50
				ELSEIF PALAM:潤滑 < PALAMLV:2
					TIMES SOURCE:苦痛 , 0.70
					TIMES SOURCE:反感 , 1.20
				ELSEIF PALAM:潤滑 < PALAMLV:3
					TIMES SOURCE:苦痛 , 0.40
				ELSEIF PALAM:潤滑 < PALAMLV:4
					TIMES SOURCE:苦痛 , 0.10
				ELSEIF PALAM:潤滑 >= PALAMLV:4
					TIMES SOURCE:苦痛 , 0.10
				ENDIF
			CASE 2
				;Aへの苦痛は先に処理しておく
				;EXP:Ａ経験をみる
				IF EXP:Ａ経験 < EXPLV:1
					TIMES SOURCE:苦痛 , 3.00
					TIMES SOURCE:反感 , 3.00
				ELSEIF EXP:Ａ経験 < EXPLV:2
					TIMES SOURCE:苦痛 , 1.20
					TIMES SOURCE:反感 , 2.00
				ELSEIF EXP:Ａ経験 < EXPLV:3
					TIMES SOURCE:苦痛 , 0.80
					TIMES SOURCE:反感 , 1.50
				ELSEIF EXP:Ａ経験 < EXPLV:4
					TIMES SOURCE:苦痛 , 0.60
					TIMES SOURCE:反感 , 1.20
				ELSEIF EXP:Ａ経験 < EXPLV:5
					TIMES SOURCE:苦痛 , 0.40
				ELSEIF EXP:Ａ経験 >= EXPLV:5
					TIMES SOURCE:苦痛 , 0.20
				ENDIF
				;PALAM:潤滑をみる
				IF PALAM:潤滑 < PALAMLV:1
					TIMES SOURCE:苦痛 , 1.20
					TIMES SOURCE:反感 , 2.00
				ELSEIF PALAM:潤滑 < PALAMLV:2
					TIMES SOURCE:苦痛 , 1.00
					TIMES SOURCE:反感 , 1.50
				ELSEIF PALAM:潤滑 < PALAMLV:3
					TIMES SOURCE:苦痛 , 0.60
				ELSEIF PALAM:潤滑 < PALAMLV:4
					TIMES SOURCE:苦痛 , 0.30
				ELSEIF PALAM:潤滑 >= PALAMLV:4
					TIMES SOURCE:苦痛 , 0.20
				ENDIF
		ENDSELECT
	CASE 132
		SELECTCASE TFLAG:主人挿入箇所
			CASE 1
				;Vへの苦痛は先に処理しておく
				;EXP:Ｖ経験をみる（処女の反感は別途処理済みなので省略）
				IF EXP:Ｖ経験 < EXPLV:1
					TIMES SOURCE:苦痛 , 2.50
				ELSEIF EXP:Ｖ経験 < EXPLV:2
					TIMES SOURCE:苦痛 , 0.80
					TIMES SOURCE:反感 , 1.20
				ELSEIF EXP:Ｖ経験 < EXPLV:3
					TIMES SOURCE:苦痛 , 0.40
				ELSEIF EXP:Ｖ経験 < EXPLV:4
					TIMES SOURCE:苦痛 , 0.10
				ELSEIF EXP:Ｖ経験 < EXPLV:5
					TIMES SOURCE:苦痛 , 0.00
				ELSEIF EXP:Ｖ経験 >= EXPLV:5
					TIMES SOURCE:苦痛 , 0.00
				ENDIF
				;PALAM:潤滑をみる
				IF PALAM:潤滑 < PALAMLV:1
					TIMES SOURCE:苦痛 , 1.20
					TIMES SOURCE:反感 , 1.50
				ELSEIF PALAM:潤滑 < PALAMLV:2
					TIMES SOURCE:苦痛 , 0.70
					TIMES SOURCE:反感 , 1.20
				ELSEIF PALAM:潤滑 < PALAMLV:3
					TIMES SOURCE:苦痛 , 0.40
				ELSEIF PALAM:潤滑 < PALAMLV:4
					TIMES SOURCE:苦痛 , 0.10
				ELSEIF PALAM:潤滑 >= PALAMLV:4
					TIMES SOURCE:苦痛 , 0.10
				ENDIF
			CASE 2
				;Aへの苦痛は先に処理しておく
				;EXP:Ａ経験をみる
				IF EXP:Ａ経験 < EXPLV:1
					TIMES SOURCE:苦痛 , 3.00
					TIMES SOURCE:反感 , 3.00
				ELSEIF EXP:Ａ経験 < EXPLV:2
					TIMES SOURCE:苦痛 , 1.20
					TIMES SOURCE:反感 , 2.00
				ELSEIF EXP:Ａ経験 < EXPLV:3
					TIMES SOURCE:苦痛 , 0.80
					TIMES SOURCE:反感 , 1.50
				ELSEIF EXP:Ａ経験 < EXPLV:4
					TIMES SOURCE:苦痛 , 0.60
					TIMES SOURCE:反感 , 1.20
				ELSEIF EXP:Ａ経験 < EXPLV:5
					TIMES SOURCE:苦痛 , 0.40
				ELSEIF EXP:Ａ経験 >= EXPLV:5
					TIMES SOURCE:苦痛 , 0.20
				ENDIF
				;PALAM:潤滑をみる
				IF PALAM:潤滑 < PALAMLV:1
					TIMES SOURCE:苦痛 , 1.20
					TIMES SOURCE:反感 , 2.00
				ELSEIF PALAM:潤滑 < PALAMLV:2
					TIMES SOURCE:苦痛 , 1.00
					TIMES SOURCE:反感 , 1.50
				ELSEIF PALAM:潤滑 < PALAMLV:3
					TIMES SOURCE:苦痛 , 0.60
				ELSEIF PALAM:潤滑 < PALAMLV:4
					TIMES SOURCE:苦痛 , 0.30
				ELSEIF PALAM:潤滑 >= PALAMLV:4
					TIMES SOURCE:苦痛 , 0.20
				ENDIF
		ENDSELECT
ENDSELECT

;セックス中毒を見る
SELECTCASE ABL:性交中毒
	CASE IS <= 1
		TIMES SOURCE:中毒 , 0.00
	CASE 2
		TIMES SOURCE:中毒 , 0.30
	CASE 3
		TIMES SOURCE:中毒 , 0.60
	CASE 4
		TIMES SOURCE:中毒 , 0.90
	CASE 5
		TIMES SOURCE:中毒 , 1.20
	CASE 6
		TIMES SOURCE:中毒 , 1.50
	CASE 7
		TIMES SOURCE:中毒 , 1.80
	CASE 8
		TIMES SOURCE:中毒 , 2.30
	CASE 9
		TIMES SOURCE:中毒 , 3.00
	CASE IS >= 10
		TIMES SOURCE:中毒 , 5.00
ENDSELECT

;-------------------------------------------------
;絶頂チェック
;-------------------------------------------------
CALL SOURCE_CHECK_CVAB

;-------------------------------------------------
;射精チェック
;-------------------------------------------------
SELECTCASE TFLAG:数珠繋ぎ
	CASE 123,312
		LOCAL = 7
	CASE 132
		LOCAL = 1
	CASE 231
		LOCAL = 6
ENDSELECT
SELECTCASE TFLAG:数珠繋ぎ
	CASE 123, 231
		LOCAL:1 = 1
	CASE 132, 312
		LOCAL:1 = 6
ENDSELECT
SELECTCASE TFLAG:数珠繋ぎ
	CASE 231, 312
		LOCAL:2 = 1
	CASE 132
		LOCAL:2 = 2
	CASE 123
		SELECTCASE TFLAG:助手挿入箇所
			CASE 1
				LOCAL:2 = 4
			CASE 2
				LOCAL:2 = 5
		ENDSELECT
ENDSELECT

CALL SAMEN_CHECK_M, LOCAL
CALL SAMEN_CHECK_A, LOCAL:1
CALL SAMEN_CHECK_T, LOCAL:2

SELECTCASE TFLAG:数珠繋ぎ
	CASE 123
		CALL SAMEN_SHOOT, LOCAL, NOWEX:MASTER:射精, MASTER, ASSI
		CALL SAMEN_SHOOT, LOCAL:1, NOWEX:ASSI:射精, ASSI, TARGET
		CALL SAMEN_SHOOT_T, LOCAL:2, NOWEX:射精
	CASE 132
		CALL SAMEN_SHOOT, LOCAL, NOWEX:MASTER:射精, MASTER, TARGET
		CALL SAMEN_SHOOT, LOCAL:1, NOWEX:ASSI:射精, ASSI
		CALL SAMEN_SHOOT_T, LOCAL:2, NOWEX:射精, ASSI
	CASE 231
		CALL SAMEN_SHOOT, LOCAL, NOWEX:MASTER:射精, MASTER
		CALL SAMEN_SHOOT, LOCAL:1, NOWEX:ASSI:射精, ASSI, TARGET
		CALL SAMEN_SHOOT_T, LOCAL:2, NOWEX:射精, MASTER
	CASE 312
		CALL SAMEN_SHOOT, LOCAL, NOWEX:MASTER:射精, MASTER, ASSI
		CALL SAMEN_SHOOT, LOCAL:1, NOWEX:ASSI:射精, ASSI
		CALL SAMEN_SHOOT_T, LOCAL:2, NOWEX:射精, MASTER
ENDSELECT

;-------------------------------------------------
;絶頂時のウェイト
;-------------------------------------------------
;SIF NOWEX:Ｃ絶頂 || NOWEX:Ｖ絶頂 || NOWEX:Ａ絶頂 || NOWEX:Ｂ絶頂 || NOWEX:射精 || NOWEX:放尿 || NOWEX:噴乳 || NOWEX:MASTER:射精 || (ASSI > 0 && NOWEX:ASSI:射精)
;	WAIT

;-------------------------------------------------
;汚れの処理
;-------------------------------------------------
SELECTCASE TFLAG:数珠繋ぎ
	CASE 123
		SELECTCASE TFLAG:主人挿入箇所
			CASE 1
				;助手の膣内⇔主人のペニスの汚れが移動
				STAIN:ASSI:膣内 |= STAIN:MASTER:ペニス
				STAIN:MASTER:ペニス |= STAIN:ASSI:膣内
			CASE 2
				;助手のアナル⇔主人のペニスの汚れが移動
				SETBIT STAIN:MASTER:ペニス, 3
				STAIN:ASSI:アナル |= STAIN:MASTER:ペニス
				STAIN:MASTER:ペニス |= STAIN:ASSI:アナル
		ENDSELECT
		SELECTCASE TFLAG:助手挿入箇所
			CASE 1
				;奴隷の膣内⇔助手のペニスの汚れが移動
				STAIN:膣内 |= STAIN:ASSI:ペニス
				STAIN:ASSI:ペニス |= STAIN:膣内
			CASE 2
				;奴隷のアナル⇔助手のペニスの汚れが移動
				SETBIT STAIN:ASSI:ペニス, 3
				STAIN:アナル |= STAIN:ASSI:ペニス
				STAIN:ASSI:ペニス |= STAIN:アナル
		ENDSELECT
	CASE 132
		SELECTCASE TFLAG:主人挿入箇所
			CASE 1
				;奴隷の膣内⇔主人のペニスの汚れが移動
				STAIN:膣内 |= STAIN:MASTER:ペニス
				STAIN:MASTER:ペニス |= STAIN:膣内
			CASE 2
				;奴隷のアナル⇔主人のペニスの汚れが移動
				SETBIT STAIN:MASTER:ペニス, 3
				STAIN:アナル |= STAIN:MASTER:ペニス
				STAIN:MASTER:ペニス |= STAIN:アナル
		ENDSELECT
		SELECTCASE TFLAG:奴隷挿入箇所
			CASE 1
				;助手の膣内⇔奴隷のペニスの汚れが移動
				STAIN:ペニス |= STAIN:ASSI:膣内
				STAIN:ASSI:膣内 |= STAIN:ペニス
			CASE 2
				;助手のアナル⇔奴隷のペニスの汚れが移動
				SETBIT STAIN:ペニス, 3
				STAIN:ASSI:アナル |= STAIN:ペニス
				STAIN:ペニス |= STAIN:ASSI:アナル
		ENDSELECT
	CASE 231
		SELECTCASE TFLAG:助手挿入箇所
			CASE 1
				;奴隷の膣内⇔助手のペニスの汚れが移動
				STAIN:膣内 |= STAIN:ASSI:ペニス
				STAIN:ASSI:ペニス |= STAIN:膣内
			CASE 2
				;奴隷のアナル⇔助手のペニスの汚れが移動
				SETBIT STAIN:ASSI:ペニス, 3
				STAIN:アナル |= STAIN:ASSI:ペニス
				STAIN:ASSI:ペニス |= STAIN:アナル
		ENDSELECT
		SELECTCASE TFLAG:奴隷挿入箇所
			CASE 1
				;主人の膣内⇔奴隷のペニスの汚れが移動
				STAIN:ペニス |= STAIN:MASTER:膣内
				STAIN:MASTER:膣内 |= STAIN:ペニス
			CASE 2
				;主人のアナル⇔奴隷のペニスの汚れが移動
				SETBIT STAIN:ペニス, 3
				STAIN:MASTER:アナル |= STAIN:ペニス
				STAIN:ペニス |= STAIN:MASTER:アナル
		ENDSELECT
	CASE 312
		SELECTCASE TFLAG:奴隷挿入箇所
			CASE 1
				;主人の膣内⇔奴隷のペニスの汚れが移動
				STAIN:ペニス |= STAIN:MASTER:膣内
				STAIN:MASTER:膣内 |= STAIN:ペニス
			CASE 2
				;主人のアナル⇔奴隷のペニスの汚れが移動
				SETBIT STAIN:ペニス, 3
				STAIN:MASTER:アナル |= STAIN:ペニス
				STAIN:ペニス |= STAIN:MASTER:アナル
		ENDSELECT
		SELECTCASE TFLAG:主人挿入箇所
			CASE 1
				;助手の膣内⇔主人のペニスの汚れが移動
				STAIN:ASSI:膣内 |= STAIN:MASTER:ペニス
				STAIN:MASTER:ペニス |= STAIN:ASSI:膣内
			CASE 2
				;助手のアナル⇔主人のペニスの汚れが移動
				SETBIT STAIN:MASTER:ペニス, 3
				STAIN:ASSI:アナル |= STAIN:MASTER:ペニス
				STAIN:MASTER:ペニス |= STAIN:ASSI:アナル
		ENDSELECT
ENDSELECT

;-------------------------------------------------
;経験の処理
;-------------------------------------------------
SELECTCASE TFLAG:数珠繋ぎ
	CASE 123
		SELECTCASE TFLAG:主人挿入箇所
			CASE 1
				PRINTFORML Ｖ経験+1(%CALLNAME:ASSI%)
				EXP:ASSI:Ｖ経験++
			CASE 2
				PRINTFORML Ａ経験+1(%CALLNAME:ASSI%)
				EXP:ASSI:Ａ経験++
		ENDSELECT
		SELECTCASE TFLAG:助手挿入箇所
			CASE 1
				PRINTL Ｖ経験+1
				EXP:Ｖ経験++
			CASE 2
				PRINTL Ａ経験+1
				EXP:Ａ経験++
		ENDSELECT
	CASE 132
		SELECTCASE TFLAG:奴隷挿入箇所
			CASE 1
				PRINTFORML Ｖ経験+1(%CALLNAME:ASSI%)
				EXP:ASSI:Ｖ経験++
			CASE 2
				PRINTFORML Ａ経験+1(%CALLNAME:ASSI%)
				EXP:ASSI:Ａ経験++
		ENDSELECT
		SELECTCASE TFLAG:主人挿入箇所
			CASE 1
				PRINTL Ｖ経験+1
				EXP:Ｖ経験++
			CASE 2
				PRINTL Ａ経験+1
				EXP:Ａ経験++
		ENDSELECT
	CASE 231
		SELECTCASE TFLAG:奴隷挿入箇所
			CASE 1
				PRINTFORML Ｖ経験+1(%CALLNAME:MASTER%)
				EXP:MASTER:Ｖ経験++
			CASE 2
				PRINTFORML Ａ経験+1(%CALLNAME:MASTER%)
				EXP:MASTER:Ａ経験++
		ENDSELECT
		SELECTCASE TFLAG:助手挿入箇所
			CASE 1
				PRINTL Ｖ経験+1
				EXP:Ｖ経験++
			CASE 2
				PRINTL Ａ経験+1
				EXP:Ａ経験++
		ENDSELECT
	CASE 312
		SELECTCASE TFLAG:奴隷挿入箇所
			CASE 1
				PRINTFORML Ｖ経験+1(%CALLNAME:MASTER%)
				EXP:MASTER:Ｖ経験++
			CASE 2
				PRINTFORML Ａ経験+1(%CALLNAME:MASTER%)
				EXP:MASTER:Ａ経験++
		ENDSELECT
		SELECTCASE TFLAG:主人挿入箇所
			CASE 1
				PRINTFORML Ｖ経験+1(%CALLNAME:ASSI%)
				EXP:ASSI:Ｖ経験++
			CASE 2
				PRINTFORML Ａ経験+1(%CALLNAME:ASSI%)
				EXP:ASSI:Ａ経験++
		ENDSELECT
ENDSELECT

;性交経験
PRINTL 性交経験+2
EXP:性交経験 += 2

;同性愛経験
IF SEX(TARGET) == SEX(MASTER) && SEX(TARGET) == SEX(ASSI)
	SELECTCASE SEX(TARGET)
		CASE 1
			PRINTL ゲイ経験+6
			EXP:ゲイ経験 += 6
		CASE 2
			PRINTL レズ経験+6
			EXP:レズ経験 += 6
	ENDSELECT
ELSEIF SEX(TARGET) == SEX(MASTER) || SEX(TARGET) == SEX(ASSI)
	SELECTCASE SEX(TARGET)
		CASE 1
			PRINTL ゲイ経験+3
			EXP:ゲイ経験 += 3
		CASE 2
			PRINTL レズ経験+3
			EXP:レズ経験 += 3
	ENDSELECT
ENDIF

PRINTL 主人調教経験+2
PRINTL 助手調教経験+2
EXP:主人調教経験 += 2
EXP:助手調教経験 += 2

RETURN 1

