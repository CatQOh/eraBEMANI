;対象がクンニされてるときの射精ゲージ
@射精ゲージ計算_クンニ射精, 上昇値
#FUNCTION
#DIM DYNAMIC 上昇値

;ABL:調教者の技巧をみる
上昇値 += 上昇値*ABL:PLAYER:技巧/5

;ABL:従順をみる
上昇値 += (上昇値/10)*ABL:従順 - (上昇値/10)*2

;ABL:欲望をみる
上昇値 += (上昇値/10)*ABL:欲望

;奴隷のABL:Ｖ感覚をみる
SELECTCASE ABL:Ｖ感覚
	CASE 0
		TIMES 上昇値 , 0.50
	CASE 1
		TIMES 上昇値 , 0.80
	CASE 2
		TIMES 上昇値 , 1.00
	CASE 3
		TIMES 上昇値 , 1.50
	CASE 4
		TIMES 上昇値 , 2.00
	CASEELSE
		上昇値 += 上昇値*(ABL:Ｖ感覚-3)
ENDSELECT

;奴隷のABL:マゾっ気をみる
上昇値 += 上昇値*ABL:マゾっ気/5

RETURNF 上昇値

;対象がＶ責めされてるときの射精ゲージ
@射精ゲージ計算_Ｖ責め, 上昇値
#FUNCTION
#DIM DYNAMIC 上昇値

;ABL:調教者の技巧をみる
上昇値 += 上昇値*ABL:PLAYER:技巧/5

;ABL:従順をみる
上昇値 += (上昇値/10)*ABL:従順 - (上昇値/10)*2

;ABL:欲望をみる
上昇値 += (上昇値/10)*ABL:欲望

;PALAM:潤滑をみる
SELECTCASE GETPALAMLV(PALAM:潤滑, 4)
	CASE 0
		TIMES 上昇値 , 0.40
	CASE 1
		TIMES 上昇値 , 0.60
	CASE 2
		TIMES 上昇値 , 0.60
	CASE 3
		TIMES 上昇値 , 1.00
	CASE 4
		TIMES 上昇値 , 1.20
ENDSELECT

;奴隷のABL:Ｖ感覚をみる
SELECTCASE ABL:Ｖ感覚
	CASE 0
		TIMES 上昇値 , 1.00
	CASE 1
		TIMES 上昇値 , 1.50
	CASE 2
		TIMES 上昇値 , 2.50
	CASE 3
		TIMES 上昇値 , 4.00
	CASE 4
		TIMES 上昇値 , 6.00
	CASEELSE
		上昇値 += 上昇値*(ABL:Ｖ感覚+2)
ENDSELECT

;奴隷のABL:マゾっ気をみる
上昇値 += 上昇値*ABL:マゾっ気/5

RETURNF 上昇値

;Ａ責めするときの射精ゲージ
@射精ゲージ計算_Ａ責め, 上昇値
#FUNCTION
#DIM DYNAMIC 上昇値

;ABL:調教者の技巧をみる
上昇値 += 上昇値*ABL:PLAYER:技巧/5

;ABL:従順をみる
上昇値 += (上昇値/10)*ABL:従順 - (上昇値/10)*2

;ABL:欲望をみる
上昇値 += (上昇値/10)*ABL:欲望

;PALAM:潤滑をみる
SELECTCASE GETPALAMLV(PALAM:潤滑, 4)
	CASE 0
		TIMES 上昇値 , 0.40
	CASE 1
		TIMES 上昇値 , 0.60
	CASE 2
		TIMES 上昇値 , 0.60
	CASE 3
		TIMES 上昇値 , 1.00
	CASE 4
		TIMES 上昇値 , 1.20
ENDSELECT

;奴隷のABL:Ａ感覚をみる
SELECTCASE ABL:Ａ感覚
	CASE 0
		TIMES 上昇値 , 0.20
	CASE 1
		TIMES 上昇値 , 0.50
	CASE 2
		TIMES 上昇値 , 1.00
	CASE 3
		TIMES 上昇値 , 2.00
	CASE 4
		TIMES 上昇値 , 3.00
	CASEELSE
		上昇値 += 上昇値*(ABL:Ａ感覚-1)
ENDSELECT

;奴隷のABL:マゾっ気をみる
上昇値 += 上昇値*ABL:マゾっ気/5

RETURNF 上昇値

;フェラチオするときの射精ゲージ計算
@射精ゲージ計算_フェラチオ, 上昇値
#FUNCTION
#DIM DYNAMIC 上昇値

;ABL:調教者の技巧をみる
上昇値 += 上昇値*ABL:PLAYER:技巧/2

;ABL:従順をみる
上昇値 += (上昇値/10)*ABL:従順 - (上昇値/10)*2

;ABL:欲望をみる
上昇値 += (上昇値/10)*ABL:欲望

;奴隷のABL:Ｃ感覚をみる
SELECTCASE ABL:Ｃ感覚
	CASE 0
		TIMES 上昇値 , 0.50
	CASE 1
		TIMES 上昇値 , 0.80
	CASE 2
		TIMES 上昇値 , 1.00
	CASE 3
		TIMES 上昇値 , 1.50
	CASE 4
		TIMES 上昇値 , 2.00
	CASEELSE
		上昇値 += 上昇値*(ABL:Ｃ感覚-3)
ENDSELECT

;調教者のTALENT:舌使いをみる
SIF TALENT:PLAYER:舌使い
	TIMES 上昇値 , 1.50

;調教者のTALENT:猫舌をみる
SIF TALENT:PLAYER:猫舌
	TIMES 上昇値 , 0.75

RETURNF 上昇値

;ペニスを責めるときの射精ゲージ
@射精ゲージ計算_Ｐ責め, 上昇値
#FUNCTION
#DIM DYNAMIC 上昇値

;ABL:調教者の技巧をみる
上昇値 += ((上昇値/10)*8)*ABL:PLAYER:技巧

;ABL:欲望をみる
上昇値 += (上昇値/10)*ABL:欲望

;ABL:Ｃ感覚をみる
SELECTCASE ABL:Ｃ感覚
	CASE 0
		TIMES 上昇値 , 0.50
	CASE 1
		TIMES 上昇値 , 0.80
	CASE 2
		TIMES 上昇値 , 1.00
	CASE 3
		TIMES 上昇値 , 1.50
	CASE 4
		TIMES 上昇値 , 2.00
	CASEELSE
		上昇値 += 上昇値*(ABL:Ｃ感覚-3)
ENDSELECT

RETURNF 上昇値

@射精ゲージ計算_パイズリする, 上昇値
#FUNCTION
#DIM DYNAMIC 上昇値

;ABL:調教者の技巧をみる
上昇値 += ((上昇値/10)*8)*ABL:PLAYER:技巧

;ABL:欲望をみる
上昇値 += (上昇値/10)*ABL:欲望

;奴隷のABL:Ｃ感覚をみる
SELECTCASE ABL:Ｃ感覚
	CASE 0
		TIMES 上昇値 , 0.50
	CASE 1
		TIMES 上昇値 , 0.80
	CASE 2
		TIMES 上昇値 , 1.00
	CASE 3
		TIMES 上昇値 , 1.50
	CASE 4
		TIMES 上昇値 , 2.00
	CASEELSE
		上昇値 += 上昇値*(ABL:Ｃ感覚-3)
ENDSELECT

;TALENT:バストサイズをみる
SELECTCASE TALENT:PLAYER:バストサイズ
	CASE 1
		TIMES 上昇値 , 0.70
	CASE 2
		TIMES 上昇値 , 0.85
	CASE 3
		TIMES 上昇値 , 1.00
	CASE 4
		TIMES 上昇値 , 1.15
	CASEELSE
		TIMES 上昇値 , 1.30
ENDSELECT
;対象が小柄体型・小人体型なら相対的に胸が大きくなるので少し増やす
SIF TALENT:小柄体型 || TALENT:小人体型
	TIMES 上昇値 , 1.15

;機械・無機物の場合、ある程度減らす
IF CSTR:PLAYER:種族 == "機械" && TALENT:PLAYER:無機物
	TIMES 上昇値 , 0.60
ELSEIF CSTR:PLAYER:種族 == "機械" || TALENT:PLAYER:無機物
	TIMES 上昇値 , 0.80
ENDIF

;実行者が小柄体型・小人体型なら身体が柔らかいので増やす
SIF TALENT:PLAYER:小柄体型 || TALENT:PLAYER:小人体型
	TIMES 上昇値 , 1.25

RETURNF 上昇値

@射精ゲージ計算_実行者キス, 上昇値
#FUNCTION
#DIM DYNAMIC 上昇値

;ABL:技巧をみる
上昇値 += 上昇値*ABL:技巧

;ABL:従順をみる
上昇値 += (上昇値/10)*ABL:従順 - (上昇値/10)*2

;ABL:奉仕精神をみる
SELECTCASE ABL:奉仕精神
	CASE 0
		TIMES 上昇値 , 0.50
	CASE 1
		TIMES 上昇値 , 0.80
	CASE 2
		TIMES 上昇値 , 1.20
	CASE 3
		TIMES 上昇値 , 1.50
	CASE 4
		TIMES 上昇値 , 1.80
	CASEELSE
		上昇値 += (上昇値/3)*ABL:奉仕精神
ENDSELECT

;TALENT:舌使いをみる
SIF TALENT:舌使い
	TIMES 上昇値 , 2.00

;相性を見る
上昇値 *= RELATION:PLAYER:(NO:TARGET)
上昇値 /= 100

RETURNF 上昇値

@射精ゲージ計算_キス, 上昇値
#FUNCTION
#DIM DYNAMIC 上昇値

;依存度を見る
SIF PLAYER == MASTER
	上昇値 += CFLAG:依存度/10

;ABL:調教者の技巧をみる
上昇値 += 上昇値*ABL:PLAYER:技巧

;ABL:従順をみる
上昇値 += (上昇値/10)*ABL:従順 - (上昇値/10)*2

;ABL:欲望をみる
上昇値 += (上昇値/5)*ABL:欲望

;ABL:奉仕精神をみる
SELECTCASE ABL:奉仕精神
	CASE 0
		TIMES 上昇値 , 0.50
	CASE 1
		TIMES 上昇値 , 0.80
	CASE 2
		TIMES 上昇値 , 1.20
	CASE 3
		TIMES 上昇値 , 1.50
	CASE 4
		TIMES 上昇値 , 1.80
	CASEELSE
		上昇値 += (上昇値/3)*ABL:奉仕精神
ENDSELECT

;調教者のTALENT:舌使いをみる
SIF TALENT:PLAYER:舌使い
	TIMES 上昇値 , 2.00

;相性を見る
上昇値 *= RELATION:TARGET:(NO:PLAYER)
上昇値 /= 100

RETURNF 上昇値

@射精ゲージ増加, ARG, ARG:1 = -1
SIF ARG:1 == -1
	ARG:1 = TARGET

;再装填処理中は射精ゲージは20分の1に
SIF CFLAG:(ARG:1):賢者タイム > 0
	ARG /= 20

;メス度が1上がるにつれ8%減る
ARG -= (ARG*MIN(ABL:(ARG:1):メス度, 10)*8)/100

;子供好きで対象が子供だとイきやすい
IF ARG:1 == TARGET
	SIF TALENT:子供好き && TALENT:PLAYER:小柄体型
		TIMES ARG , 1.20
ELSEIF ARG:1 == MASTER
	SIF TALENT:MASTER:子供好き && TALENT:小柄体型
		TIMES ARG , 1.20
ELSEIF ARG:1 == ASSI
	SIF TALENT:ASSI:子供好き && TALENT:小柄体型
		TIMES ARG , 1.20
ENDIF

SIF PENIS(ARG:1)
	BASE:(ARG:1):射精 += ARG
