;---------------------------------------------------------
;射精するかのチェック
;---------------------------------------------------------
@SAMEN_CHECK, ARG
;ARG:0内訳
;1 = 膣内射精
;2 = アナル射精
;3 = 手淫
;4 = フェラ
;5 = パイズリ
;6 = その他奉仕
;7 = 助手を犯すで射精
;8 = クンニされて射精
;---以下は調教対象の射精なので管轄外---
;;9 = 助手を犯させるで射精
;;10 = 逆レイプで射精
;--------------------------------------
;11 = 3P助手射精

IF !PENIS(PLAYER)
	BASE:PLAYER:射精 = 0
	RETURN 0
ENDIF

;射精限界が来ている場合は射精しない
IF CFLAG:PLAYER:残数 == 0
	CFLAG:PLAYER:射精飾り値 += RAND:20+1
	BASE:PLAYER:射精 = CFLAG:PLAYER:射精飾り値
	PRINTFORML %CALLNAME:PLAYER%のペニスは精液を出し尽くしてしまったようだ……
	RETURN 0
ENDIF

LOCAL = BASE:PLAYER:射精/MAXBASE:PLAYER:射精
SIF LOCAL <= 0
	RETURN 0

;コマンドごとの分岐
SELECTCASE ARG
;通常セックス系
	CASE 1
		;主人による奴隷への中田氏
		IF PLAYER == MASTER
			IF TEQUIP:MASTER:コンドーム
				IF LOCAL >= 2
					PRINTL 膣内大量射精(避妊具)
				ELSE
					PRINTL 膣内射精（避妊具)
				ENDIF
			ELSE
				IF LOCAL >= 2
					PRINTL 膣内大量射精
				ELSE
					PRINTL 膣内射精
				ENDIF
			ENDIF
		;助手による奴隷への中田氏
		ELSEIF PLAYER == ASSI
			IF TEQUIP:ASSI:コンドーム
				IF LOCAL >= 2
					PRINTFORML %CALLNAME:ASSI%膣内大量射精(避妊具)
				ELSE
					PRINTFORML %CALLNAME:ASSI%膣内射精(避妊具)
				ENDIF
			ELSE
				IF LOCAL >= 2
					PRINTFORML %CALLNAME:ASSI%膣内大量射精
				ELSE
					PRINTFORML %CALLNAME:ASSI%膣内射精
				ENDIF
			ENDIF
		ENDIF
	;アナル射精
	CASE 2
		IF PLAYER == MASTER
			IF TEQUIP:MASTER:コンドーム
				IF LOCAL >= 2
					PRINTL 腸内大量射精(避妊具)
				ELSE
					PRINTL 腸内射精(避妊具)
				ENDIF
			ELSE
				IF LOCAL >= 2
					PRINTL 腸内大量射精
				ELSE
					PRINTL 腸内射精
				ENDIF
			ENDIF
		ELSEIF PLAYER == ASSI
			IF TEQUIP:ASSI:コンドーム
				IF LOCAL >= 2
					PRINTFORML %CALLNAME:ASSI%腸内大量射精(避妊具)
				ELSE
					PRINTFORML %CALLNAME:ASSI%腸内射精(避妊具)
				ENDIF
			ELSE
				IF LOCAL >= 2
					PRINTFORML %CALLNAME:ASSI%腸内大量射精
				ELSE
					PRINTFORML %CALLNAME:ASSI%腸内射精
				ENDIF
			ENDIF
		ENDIF
	;手淫
	CASE 3
		IF PLAYER == MASTER
			IF TEQUIP:MASTER:コンドーム
				IF LOCAL >= 2
					PRINTL 大量射精(避妊具)
				ELSE
					PRINTL 射精(避妊具)
				ENDIF
			ELSE
				IF LOCAL >= 2
					PRINTL 大量射精
				ELSE
					PRINTL 射精
				ENDIF
			ENDIF
		ELSEIF PLAYER == ASSI
			IF TEQUIP:ASSI:コンドーム
				IF LOCAL >= 2
					PRINTFORML %CALLNAME:ASSI%大量射精(避妊具)
				ELSE
					PRINTFORML %CALLNAME:ASSI%射精(避妊具)
				ENDIF
			ELSE
				IF LOCAL >= 2
					PRINTFORML %CALLNAME:ASSI%大量射精
				ELSE
					PRINTFORML %CALLNAME:ASSI%射精
				ENDIF
			ENDIF
		ENDIF
	;フェラ
	CASE 4
		IF PLAYER == MASTER || SELECTCOMS == "ダブルフェラ"
			IF TEQUIP:MASTER:コンドーム
				IF LOCAL >= 2
					PRINTL 口内大量射精(避妊具)
				ELSE
					PRINTL 口内射精(避妊具)
				ENDIF
			ELSE
				IF LOCAL >= 2
					PRINTL 口内大量射精
				ELSE
					PRINTL 口内射精
				ENDIF
			ENDIF
		ELSEIF PLAYER == ASSI
			IF TEQUIP:ASSI:コンドーム
				IF LOCAL >= 2
					PRINTFORML %CALLNAME:ASSI%口内大量射精(避妊具)
				ELSE
					PRINTFORML %CALLNAME:ASSI%口内射精(避妊具)
				ENDIF
			ELSE
				IF LOCAL >= 2
					PRINTFORML %CALLNAME:ASSI%口内大量射精
				ELSE
					PRINTFORML %CALLNAME:ASSI%口内射精
				ENDIF
			ENDIF
		ENDIF
	;パイズリ
	CASE 5
		IF PLAYER == MASTER || SELECTCOMS == "ダブルパイズリ"
			IF TEQUIP:MASTER:コンドーム
				IF LOCAL >= 2
					PRINTL 乳内大量射精(避妊具)
				ELSE
					PRINTL 乳内射精(避妊具)
				ENDIF
			ELSE
				IF LOCAL >= 2
					PRINTL 乳内大量射精
				ELSE
					PRINTL 乳内射精
				ENDIF
			ENDIF
		ELSEIF PLAYER == ASSI
			IF TEQUIP:ASSI:コンドーム
				IF LOCAL >= 2
					PRINTFORML %CALLNAME:ASSI%乳内大量射精(避妊具)
				ELSE
					PRINTFORML %CALLNAME:ASSI%乳内射精(避妊具)
				ENDIF
			ELSE
				IF LOCAL >= 2
					PRINTFORML %CALLNAME:ASSI%乳内大量射精
				ELSE
					PRINTFORML %CALLNAME:ASSI%乳内射精
				ENDIF
			ENDIF
		ENDIF
	;その他奉仕
	CASE 6
		IF PLAYER == MASTER
			IF TEQUIP:MASTER:コンドーム
				IF LOCAL >= 2
					PRINTL 大量射精(避妊具)
				ELSE
					PRINTL 射精(避妊具)
				ENDIF
			ELSE
				IF LOCAL >= 2
					PRINTL 大量射精
				ELSE
					PRINTL 射精
				ENDIF
			ENDIF
		ELSEIF PLAYER == ASSI
			IF TEQUIP:ASSI:コンドーム
				IF LOCAL >= 2
					PRINTFORML %CALLNAME:ASSI%大量射精(避妊具)
				ELSE
					PRINTFORML %CALLNAME:ASSI%射精(避妊具)
				ENDIF
			ELSE
				IF LOCAL >= 2
					PRINTFORML %CALLNAME:ASSI%大量射精
				ELSE
					PRINTFORML %CALLNAME:ASSI%射精
				ENDIF
			ENDIF
		ENDIF
	;助手を犯すで射精
	CASE 7
		IF PLAYER == MASTER
			IF VAGINA(ASSI)
				IF TEQUIP:ASSI:コンドーム
					IF LOCAL >= 2
						PRINTFORML %CALLNAME:MASTER%→%CALLNAME:ASSI% 腸内大量射精(避妊具)
					ELSE
						PRINTFORML %CALLNAME:MASTER%→%CALLNAME:ASSI% 腸内射精(避妊具)
					ENDIF
				ELSE
					IF LOCAL >= 2
						PRINTFORML %CALLNAME:MASTER%→%CALLNAME:ASSI% 腸内大量射精
					ELSE
						PRINTFORML %CALLNAME:MASTER%→%CALLNAME:ASSI% 腸内射精
					ENDIF
				ENDIF
			ELSE
				IF TEQUIP:MASTER:コンドーム
					IF LOCAL >= 2
						PRINTFORML %CALLNAME:MASTER%→%CALLNAME:ASSI% 膣内大量射精(避妊具)
					ELSE
						PRINTFORML %CALLNAME:MASTER%→%CALLNAME:ASSI% 膣内射精(避妊具)
					ENDIF
				ELSE
					IF LOCAL >= 2
						PRINTFORML %CALLNAME:MASTER%→%CALLNAME:ASSI% 膣内大量射精
					ELSE
						PRINTFORML %CALLNAME:MASTER%→%CALLNAME:ASSI% 膣内射精
					ENDIF
				ENDIF
			ENDIF
		ELSEIF PLAYER == ASSI
			IF TEQUIP:ASSI:コンドーム
				IF LOCAL >= 2
					PRINTFORML %CALLNAME:ASSI%大量射精(避妊具)
				ELSE
					PRINTFORML %CALLNAME:ASSI%射精(避妊具)
				ENDIF
			ELSE
				IF LOCAL >= 2
					PRINTFORML %CALLNAME:ASSI%大量射精
				ELSE
					PRINTFORML %CALLNAME:ASSI%射精
				ENDIF
			ENDIF
		ENDIF
	;クンニ
	CASE 8
		IF PLAYER == MASTER
			IF TEQUIP:MASTER:コンドーム
				IF LOCAL >= 2
					PRINTL 大量射精(避妊具)
				ELSE
					PRINTL 射精(避妊具)
				ENDIF
			ELSE
				IF LOCAL >= 2
					PRINTL 大量顔射
				ELSE
					PRINTL 顔射
				ENDIF
			ENDIF
		ELSEIF PLAYER == ASSI
			IF TEQUIP:ASSI:コンドーム
				IF LOCAL >= 2
					PRINTFORML %CALLNAME:ASSI%大量射精(避妊具)
				ELSE
					PRINTFORML %CALLNAME:ASSI%射精(避妊具)
				ENDIF
			ELSE
				IF LOCAL >= 2
					PRINTFORML %CALLNAME:ASSI%大量顔射
				ELSE
					PRINTFORML %CALLNAME:ASSI%顔射
				ENDIF
			ENDIF
		ENDIF
	;3P助手射精
	CASE 11
		IF TEQUIP:ASSI:コンドーム
			IF LOCAL >= 2
				PRINTFORML %CALLNAME:ASSI%大量射精(避妊具)
			ELSE
				PRINTFORML %CALLNAME:ASSI%射精(避妊具)
			ENDIF
		ELSE
			IF LOCAL >= 2
				PRINTFORML %CALLNAME:ASSI%大量射精
			ELSE
				PRINTFORML %CALLNAME:ASSI%射精
			ENDIF
		ENDIF
ENDSELECT

NOWEX:PLAYER:射精 = LOCAL

;射精強度を表示
SIF LOCAL >= 3
	PRINTFORML 射精強度×{LOCAL}

;実績:ニーソ姫にニーソを履いたまま足コキされて射精する
IF SELECTCOMS == "足扱き" && CHARANAMEF(TARGET) == "ニーソ姫"
	SIF CSTR:足元 == "ニーソックス" && TEQUIP:足元
		CALL 実績解除, "ニーソマニアIIDX"
ENDIF

;実績:性転換、もしくはふたなり化しためうとまり花をオナホで射精させる
IF SELECTCOMS == "オナホ扱き" && !TEQUIP:PLAYER:コンドーム
	SELECTCASE CHARANAMEF(PLAYER)
		CASE "芽兎 めう"
			SETBIT オナホパフェ, 0
		CASE "山形 まり花"
			SETBIT オナホパフェ, 1
	ENDSELECT
	SIF GETBIT(オナホパフェ, 0) && GETBIT(オナホパフェ, 1)
		CALL 実績解除, "オナホパフェだよ☆ONP"
ENDIF

IF SELECTCOMS == "ダブル素股" && PLAYER == MASTER
	SIF (CHARANAMEF(TARGET) == "東雲 夏陽" && CHARANAMEF(ASSI) == "東雲 心菜") || (CHARANAMEF(TARGET) == "東雲 心菜" && CHARANAMEF(ASSI) == "東雲 夏陽")
		CALL 実績解除, "ココナッツミルクの作り方"
ENDIF

RETURN LOCAL

@SAMEN_CHECK_M, ARG
IF !PENIS(MASTER)
	BASE:MASTER:射精 = 0
	RETURN 0
ENDIF

;PLAYERがMASTERではない場合
;射精限界が来ている場合は、射精ゲージは強制的に0にする
IF CFLAG:MASTER:残数 == 0
	CFLAG:MASTER:射精飾り値 += RAND:20+1
	BASE:MASTER:射精 = CFLAG:MASTER:射精飾り値
	PRINTFORML %CALLNAME:MASTER%のペニスは精液を出し尽くしてしまったようだ……
	RETURN 0
ENDIF

LOCAL = BASE:MASTER:射精/MAXBASE:MASTER:射精
SIF !LOCAL
	RETURN 0

;コマンドごとの分岐
SELECTCASE ARG
	;通常セックス系
	CASE 1
		IF TEQUIP:MASTER:コンドーム
			IF LOCAL >= 2
				PRINTL 膣内大量射精(避妊具)
			ELSE
				PRINTL 膣内射精（避妊具)
			ENDIF
		ELSE
			IF LOCAL >= 2
				PRINTL 膣内大量射精
			ELSE
				PRINTL 膣内射精
			ENDIF
		ENDIF
	;アナル射精
	CASE 2
		IF TEQUIP:MASTER:コンドーム
			IF LOCAL >= 2
				PRINTL 腸内大量射精(避妊具)
			ELSE
				PRINTL 腸内射精(避妊具)
			ENDIF
		ELSE
			IF LOCAL >= 2
				PRINTL 腸内大量射精
			ELSE
				PRINTL 腸内射精
			ENDIF
		ENDIF
	;手淫
	CASE 3
		IF TEQUIP:MASTER:コンドーム
			IF LOCAL >= 2
				PRINTL 大量射精(避妊具)
			ELSE
				PRINTL 射精(避妊具)
			ENDIF
		ELSE
			IF LOCAL >= 2
				PRINTL 大量射精
			ELSE
				PRINTL 射精
			ENDIF
		ENDIF
	;フェラ
	CASE 4
		IF TEQUIP:MASTER:コンドーム
			IF LOCAL >= 2
				PRINTL 口内大量射精(避妊具)
			ELSE
				PRINTL 口内射精(避妊具)
			ENDIF
		ELSE
			IF LOCAL >= 2
				PRINTL 口内大量射精
			ELSE
				PRINTL 口内射精
			ENDIF
		ENDIF
	;パイズリ
	CASE 5
		IF TEQUIP:MASTER:コンドーム
			IF LOCAL >= 2
				PRINTL 乳内大量射精(避妊具)
			ELSE
				PRINTL 乳内射精(避妊具)
			ENDIF
		ELSE
			IF LOCAL >= 2
				PRINTL 乳内大量射精
			ELSE
				PRINTL 乳内射精
			ENDIF
		ENDIF
	;その他奉仕
	CASE 6
		IF TEQUIP:MASTER:コンドーム
			IF LOCAL >= 2
				PRINTL 大量射精(避妊具)
			ELSE
				PRINTL 射精(避妊具)
			ENDIF
		ELSE
			IF LOCAL >= 2
				PRINTL 大量射精
			ELSE
				PRINTL 射精
			ENDIF
		ENDIF
	;助手を犯すで射精
	CASE 7
		IF TFLAG:主人挿入箇所 == 1
			IF TEQUIP:MASTER:コンドーム
				IF LOCAL >= 2
					PRINTFORML %CALLNAME:MASTER%→%CALLNAME:ASSI% 膣内大量射精(避妊具)
				ELSE
					PRINTFORML %CALLNAME:MASTER%→%CALLNAME:ASSI% 膣内射精(避妊具)
				ENDIF
			ELSE
				IF LOCAL >= 2
					PRINTFORML %CALLNAME:MASTER%→%CALLNAME:ASSI% 膣内大量射精
				ELSE
					PRINTFORML %CALLNAME:MASTER%→%CALLNAME:ASSI% 膣内射精
				ENDIF
			ENDIF
		ELSE
			IF TEQUIP:ASSI:コンドーム
				IF LOCAL >= 2
					PRINTFORML %CALLNAME:MASTER%→%CALLNAME:ASSI% 腸内大量射精(避妊具)
				ELSE
					PRINTFORML %CALLNAME:MASTER%→%CALLNAME:ASSI% 腸内射精(避妊具)
				ENDIF
			ELSE
				IF LOCAL >= 2
					PRINTFORML %CALLNAME:MASTER%→%CALLNAME:ASSI% 腸内大量射精
				ELSE
					PRINTFORML %CALLNAME:MASTER%→%CALLNAME:ASSI% 腸内射精
				ENDIF
			ENDIF
		ENDIF
	;クンニ強制
	CASE 8
		IF TEQUIP:MASTER:コンドーム
			IF LOCAL >= 2
				PRINTL 大量射精(避妊具)
			ELSE
				PRINTL 射精(避妊具)
			ENDIF
		ELSE
			IF LOCAL >= 2
				PRINTL 大量顔射
			ELSE
				PRINTL 顔射
			ENDIF
		ENDIF
ENDSELECT

NOWEX:MASTER:射精 = LOCAL

;射精強度を表示
SIF LOCAL >= 3
	PRINTFORML 射精強度×{LOCAL}

RETURN LOCAL

@SAMEN_CHECK_A, ARG
IF !PENIS(ASSI)
	BASE:ASSI:射精 = 0
	RETURN 0
ENDIF

;PLAYERがASSIではない場合
;射精限界が来ている場合は、射精ゲージは強制的に0にする
IF CFLAG:ASSI:残数 == 0
	CFLAG:ASSI:射精飾り値 += RAND:20+1
	BASE:ASSI:射精 = CFLAG:ASSI:射精飾り値
	PRINTFORML %CALLNAME:ASSI%のペニスは精液を出し尽くしてしまったようだ……
	RETURN 0
ENDIF

LOCAL = BASE:ASSI:射精/MAXBASE:ASSI:射精
SIF !LOCAL
	RETURN 0

;コマンドごとの分岐
SELECTCASE ARG
;通常セックス系
	CASE 1
		IF TEQUIP:ASSI:コンドーム
			IF LOCAL >= 2
				PRINTFORML %CALLNAME:ASSI%膣内大量射精(避妊具)
			ELSE
				PRINTFORML %CALLNAME:ASSI%膣内射精(避妊具)
			ENDIF
		ELSE
			IF LOCAL >= 2
				PRINTFORML %CALLNAME:ASSI%膣内大量射精
			ELSE
				PRINTFORML %CALLNAME:ASSI%膣内射精
			ENDIF
		ENDIF
	;アナル射精
	CASE 2
		IF TEQUIP:ASSI:コンドーム
			IF LOCAL >= 2
				PRINTFORML %CALLNAME:ASSI%腸内大量射精(避妊具)
			ELSE
				PRINTFORML %CALLNAME:ASSI%腸内射精(避妊具)
			ENDIF
		ELSE
			IF LOCAL >= 2
				PRINTFORML %CALLNAME:ASSI%腸内大量射精
			ELSE
				PRINTFORML %CALLNAME:ASSI%腸内射精
			ENDIF
		ENDIF
	;手淫
	CASE 3
		IF TEQUIP:ASSI:コンドーム
			IF LOCAL >= 2
				PRINTFORML %CALLNAME:ASSI%大量射精(避妊具)
			ELSE
				PRINTFORML %CALLNAME:ASSI%射精(避妊具)
			ENDIF
		ELSE
			IF LOCAL >= 2
				PRINTFORML %CALLNAME:ASSI%大量射精
			ELSE
				PRINTFORML %CALLNAME:ASSI%射精
			ENDIF
		ENDIF
	;フェラ
	CASE 4
		IF TEQUIP:ASSI:コンドーム
			IF LOCAL >= 2
				PRINTFORML %CALLNAME:ASSI%口内大量射精(避妊具)
			ELSE
				PRINTFORML %CALLNAME:ASSI%口内射精(避妊具)
			ENDIF
		ELSE
			IF LOCAL >= 2
				PRINTFORML %CALLNAME:ASSI%口内大量射精
			ELSE
				PRINTFORML %CALLNAME:ASSI%口内射精
			ENDIF
		ENDIF
	;パイズリ
	CASE 5
		IF TEQUIP:ASSI:コンドーム
			IF LOCAL >= 2
				PRINTFORML %CALLNAME:ASSI%乳内大量射精(避妊具)
			ELSE
				PRINTFORML %CALLNAME:ASSI%乳内射精(避妊具)
			ENDIF
		ELSE
			IF LOCAL >= 2
				PRINTFORML %CALLNAME:ASSI%乳内大量射精
			ELSE
				PRINTFORML %CALLNAME:ASSI%乳内射精
			ENDIF
		ENDIF
	;その他奉仕
	CASE 6
		IF TEQUIP:ASSI:コンドーム
			IF LOCAL >= 2
				PRINTFORML %CALLNAME:ASSI%大量射精(避妊具)
			ELSE
				PRINTFORML %CALLNAME:ASSI%射精(避妊具)
			ENDIF
		ELSE
			IF LOCAL >= 2
				PRINTFORML %CALLNAME:ASSI%大量射精
			ELSE
				PRINTFORML %CALLNAME:ASSI%射精
			ENDIF
		ENDIF
	;助手を犯すで射精
	CASE 7
		IF TEQUIP:ASSI:コンドーム
			IF LOCAL >= 2
				PRINTFORML %CALLNAME:ASSI%大量射精(避妊具)
			ELSE
				PRINTFORML %CALLNAME:ASSI%射精(避妊具)
			ENDIF
		ELSE
			IF LOCAL >= 2
				PRINTFORML %CALLNAME:ASSI%大量射精
			ELSE
				PRINTFORML %CALLNAME:ASSI%射精
			ENDIF
		ENDIF
	;クンニ強制
	CASE 8
		IF TEQUIP:ASSI:コンドーム
			IF LOCAL >= 2
				PRINTFORML %CALLNAME:ASSI%大量射精(避妊具)
			ELSE
				PRINTFORML %CALLNAME:ASSI%射精(避妊具)
			ENDIF
		ELSE
			IF LOCAL >= 2
				PRINTFORML %CALLNAME:ASSI%大量顔射
			ELSE
				PRINTFORML %CALLNAME:ASSI%顔射
			ENDIF
		ENDIF
	;3P助手射精
	CASE 11
		IF TEQUIP:ASSI:コンドーム
			IF LOCAL >= 2
				PRINTFORML %CALLNAME:ASSI%大量射精(避妊具)
			ELSE
				PRINTFORML %CALLNAME:ASSI%射精(避妊具)
			ENDIF
		ELSE
			IF LOCAL >= 2
				PRINTFORML %CALLNAME:ASSI%大量射精
			ELSE
				PRINTFORML %CALLNAME:ASSI%射精
			ENDIF
		ENDIF
ENDSELECT

NOWEX:ASSI:射精 = LOCAL

;射精強度を表示
SIF LOCAL >= 3
	PRINTFORML 射精強度×{LOCAL}

RETURN LOCAL

;---------------------------------------------------------
;射精処理
;---------------------------------------------------------
@SAMEN_SHOOT, 射精先, 射精量, 射精したキャラ = -1, 射精されるキャラ = -1
#DIM 射精先
#DIM 射精量
#DIM 射精したキャラ
#DIM 射精されるキャラ
;ARG:0 = 射精先
;ARG:1 = 射精量
;ARG:2 = 射精したキャラ
;ARG:3 = 射精されるキャラ
SIF 射精したキャラ == -1
	射精したキャラ = PLAYER
SIF 射精されるキャラ == -1
	射精されるキャラ = TARGET
SIF 射精量 <= 0
	RETURN 0

;射精先変数内訳
;1 = 膣内射精
;2 = アナル射精
;3 = 手淫
;4 = フェラ
;5 = パイズリ
;6 = その他奉仕
;7 = 助手を犯すで射精
;8 = クンニされて射精
;---以下は調教対象の射精なので管轄外---
;;9 = 助手を犯させるで射精
;;10 = 逆レイプで射精
;--------------------------------------
;11 = 3P助手射精

;コマンドごとの分岐
SELECTCASE 射精先
;通常セックス系
	CASE 1
		;主人による奴隷への中田氏
		IF 射精したキャラ == MASTER
			IF !TEQUIP:MASTER:コンドーム
				SETBIT TFLAG:中出し, 0
				PRINTFORML 膣内射精経験+{射精量}
				EXP:膣射経験 += 射精量
				PREG:0 += 射精量
				CFLAG:主人からの膣射経験++
				中出し人数:MASTER:(NO:TARGET)++
				中出され人数:(NO:MASTER)++
				;妊娠していないのであれば中田氏時の恐怖判定等
				SIF !TALENT:妊娠
					CALL SAMEN_SHOOT_SOURCE, 射精したキャラ
				;ビデオ撮影中はボーナスカウント
				SIF TEQUIP:ビデオカメラ
					VIDEOBONUS:0++
				;獣人、獣による催淫
				SELECTCASE CSTR:射精したキャラ:種族
					CASE "獣人", "獣"
						CFLAG:射精されるキャラ:残数 += ((CFLAG:射精されるキャラ:媚薬%5)+射精量)/5
						CFLAG:射精されるキャラ:媚薬 += 射精量
				ENDSELECT
			ENDIF
		;助手による奴隷への中田氏
		ELSEIF 射精したキャラ == ASSI
			IF !TEQUIP:ASSI:コンドーム
				SETBIT TFLAG:中出し, 0
				PRINTFORML 膣内射精経験+{射精量}
				EXP:TARGET:膣射経験 += 射精量
				PREG:1 += 射精量
				CFLAG:助手からの膣射経験++
				中出し人数:ASSI:(NO:TARGET)++
				中出され人数:(NO:ASSI)++
				;妊娠していないのであれば中田氏時の恐怖判定等
				SIF TALENT:妊娠 == 0
					CALL SAMEN_SHOOT_SOURCE, 射精したキャラ
				;ビデオ撮影中はボーナスカウント
				SIF TEQUIP:ビデオカメラ
					VIDEOBONUS:2++
				;獣人、獣による催淫
				SELECTCASE CSTR:射精したキャラ:種族
					CASE "獣人", "獣"
						CFLAG:射精されるキャラ:残数 += ((CFLAG:射精されるキャラ:媚薬%5)+射精量)/5
						CFLAG:射精されるキャラ:媚薬 += 射精量
				ENDSELECT
			ENDIF
		ENDIF
	;アナル射精
	CASE 2
		IF 射精したキャラ == MASTER
			IF !TEQUIP:MASTER:コンドーム
				SETBIT TFLAG:中出し, 1
				CFLAG:主人からの腸射経験++
				アナル中出し人数:MASTER:(NO:TARGET)++
				アナル中出され人数:(NO:MASTER)++
				;ビデオ撮影時はボーナスカウント
				SIF TEQUIP:ビデオカメラ
					VIDEOBONUS:1++
				;獣人、獣による催淫
				SELECTCASE CSTR:射精したキャラ:種族
					CASE "獣人", "獣"
						CFLAG:射精されるキャラ:残数 += ((CFLAG:射精されるキャラ:媚薬%5)+射精量)/5
						CFLAG:射精されるキャラ:媚薬 += 射精量
				ENDSELECT
			ENDIF
		ELSEIF 射精したキャラ == ASSI
			IF !TEQUIP:ASSI:コンドーム
				SETBIT TFLAG:中出し, 1
				CFLAG:助手からの腸射経験++
				アナル中出し人数:ASSI:(NO:TARGET)++
				アナル中出され人数:(NO:ASSI)++
				;ビデオ撮影時はボーナスカウント
				SIF TEQUIP:ビデオカメラ
					VIDEOBONUS:3++
				;獣人、獣による催淫
				SELECTCASE CSTR:射精したキャラ:種族
					CASE "獣人", "獣"
						CFLAG:射精されるキャラ:残数 += ((CFLAG:射精されるキャラ:媚薬%5)+射精量)/5
						CFLAG:射精されるキャラ:媚薬 += 射精量
				ENDSELECT
			ENDIF
		ENDIF
	;手淫
	CASE 3
		SIF 射精したキャラ == MASTER
			CFLAG:手で射精させた経験++
	;フェラ
	CASE 4
		IF 射精したキャラ == MASTER || SELECTCOMS == "ダブルフェラ"
			IF !TEQUIP:MASTER:コンドーム
				;奉仕精神LV2以上、技巧LV2以上なら汚れをなめ取る（ボールギャグ使用時は除く）
				IF ABL:技巧 >= 2 && ABL:奉仕精神 >= 2
					STAIN:MASTER:ペニス = 2
					CFLAG:お掃除フェラ経験++
					SELECTCASE SELECTCOMS
						CASE "ダブルフェラ"
							TFLAG:お掃除フェラ = 2
						CASEELSE
							TFLAG:お掃除フェラ = 1
					ENDSELECT
				ENDIF
			ENDIF
			CFLAG:口で射精させた経験++
		ENDIF
		IF !TEQUIP:PLAYER:コンドーム
			SETBIT TFLAG:口内射精, 0
			;獣人、獣による催淫
			SELECTCASE CSTR:射精したキャラ:種族
				CASE "獣人", "獣"
					CFLAG:射精されるキャラ:残数 += ((CFLAG:射精されるキャラ:媚薬%5)+射精量)/5
					CFLAG:射精されるキャラ:媚薬 += 射精量
			ENDSELECT
		ENDIF
	;パイズリ
	CASE 5
		SIF 射精したキャラ == MASTER || SELECTCOMS == "ダブルパイズリ"
			CFLAG:胸で射精させた経験++
	;その他奉仕
	CASE 6
		;
	;助手を犯すで射精
	CASE 7
		IF 射精したキャラ == MASTER
			SELECTCASE TFLAG:主人挿入箇所
				CASE 1
					IF !TEQUIP:MASTER:コンドーム
						SETBIT TFLAG:中出し, 2
						PRINTFORML 精液経験+{射精量}(%CALLNAME:ASSI%)
						EXP:ASSI:精液経験 += 射精量
						PRINTFORML 膣内射精経験+{射精量}(%CALLNAME:ASSI%)
						EXP:膣射経験 += 射精量
						PREG:ASSI:0 += 射精量
						;獣人、獣による催淫
						SELECTCASE CSTR:射精したキャラ:種族
							CASE "獣人", "獣"
								CFLAG:射精されるキャラ:残数 += ((CFLAG:射精されるキャラ:媚薬%5)+射精量)/5
								CFLAG:射精されるキャラ:媚薬 += 射精量
						ENDSELECT
					ENDIF
				CASE 2
					IF !TEQUIP:MASTER:コンドーム
						SETBIT TFLAG:中出し, 3
						PRINTFORML 精液経験+{射精量}(%CALLNAME:ASSI%)
						EXP:ASSI:精液経験 += 射精量
						;獣人、獣による催淫
						SELECTCASE CSTR:射精したキャラ:種族
							CASE "獣人", "獣"
								CFLAG:射精されるキャラ:残数 += ((CFLAG:射精されるキャラ:媚薬%5)+射精量)/5
								CFLAG:射精されるキャラ:媚薬 += 射精量
						ENDSELECT
					ENDIF
			ENDSELECT
		ENDIF
	;クンニ
	CASE 8
		SIF 射精したキャラ == MASTER
			CFLAG:口で射精させた経験++
	;3P助手射精
	CASE 11
		;
ENDSELECT

IF 射精したキャラ == MASTER
	SELECTCASE SELECTCOMS
		CASE "キスする"
			CFLAG:キスで射精させた経験++
		CASE "騎乗位"
			CFLAG:騎乗位で射精させた経験++
		CASE "騎乗位アナル"
			CFLAG:アナル騎乗位で射精させた経験++
		CASE "足扱き"
			CFLAG:足で射精させた経験++
	ENDSELECT
ENDIF

;射精回数カウント
EX:(射精したキャラ):射精++

;助手に射精した時以外は奴隷の精液経験増加
IF 射精先 != 7
	PRINTFORML 精液経験+{射精量}
	EXP:精液経験 += 射精量
ENDIF
;ダブルフェラ、ダブルパイズリ時、助手を犯す時は助手の精液経験も増加
IF SELECTCOMS == "ダブルフェラ" || SELECTCOMS == "ダブルパイズリ" || 射精先 == 7
	PRINTFORML 精液経験+{射精量}(%CALLNAME:ASSI%)
	EXP:ASSI:精液経験 += 射精量
ENDIF

PRINTFORML 射精経験+{射精量}(%CALLNAME:(射精したキャラ)%)
EXP:射精したキャラ:射精経験 += 射精量

;精液汚れの設定
SETBIT STAIN:射精したキャラ:ペニス, 2

BASE:射精したキャラ:射精 -= MAXBASE:射精したキャラ:射精*射精量
SIF BASE:射精したキャラ:射精 >= MAXBASE:射精したキャラ:射精
	BASE:射精したキャラ:射精 = MAXBASE:射精したキャラ:射精-1

;射精時に中毒充足のソースを追加
;通常射精時
SIF 射精量 == 1
	LOCAL = 200
;大量射精時
SIF 射精量 >= 2
	LOCAL = 500

IF 射精されるキャラ == TARGET
	;精液中毒を見る
	SELECTCASE ABL:精液中毒
		CASE 0, 1
			TIMES LOCAL , 0.10
		CASE 2
			TIMES LOCAL , 0.30
		CASE 3
			TIMES LOCAL , 0.60
		CASE 4
			TIMES LOCAL , 0.90
		CASE 5
			TIMES LOCAL , 1.20
		CASE 6
			TIMES LOCAL , 1.50
		CASE 7
			TIMES LOCAL , 1.80
		CASE 8
			TIMES LOCAL , 2.30
		CASE 9
			TIMES LOCAL , 3.00
		CASE IS >= 10
			TIMES LOCAL , 5.00
	ENDSELECT
ENDIF

SOURCE:中毒 += LOCAL

;射精後は再装填の時間を設ける
;通常射精時
SIF 射精量 == 1
	CFLAG:射精したキャラ:賢者タイム = 3
;大量射精時
SIF 射精量 >= 2
	CFLAG:射精したキャラ:賢者タイム = 5

;媚薬の効果に応じて賢者タイムが短くなる
CFLAG:射精したキャラ:賢者タイム -= CFLAG:射精したキャラ:媚薬/10

CFLAG:射精したキャラ:残数--

;実績:シグを相手に打ち止めまで射精する
IF CFLAG:射精したキャラ:残数 == 0
	SELECTCASE CHARANAMEF(TARGET)
		CASE "赤シグ", "青シグ", "黄シグ"
			CALL 実績解除, "「シグの勝ち！」"
	ENDSELECT
ENDIF

IF TEQUIP:射精したキャラ:コンドーム
	TEQUIP:射精したキャラ:コンドーム = 0
	IF 射精したキャラ == MASTER
		SETBIT TFLAG:避妊具射精, 0
		TFLAG:使用済み避妊具 = 1
	ELSEIF 射精したキャラ == ASSI
		SETBIT TFLAG:避妊具射精, 1
		TFLAG:使用済み避妊具 = 2
	ENDIF
	;コンドーム自動装着処理
	IF GETBIT(FLAG:避妊具設定, 0) && 射精したキャラ == MASTER
		IF ITEM:コンドーム > 0
			ITEM:コンドーム--
			TEQUIP:MASTER:コンドーム = 1
		ENDIF
		IF ITEM:コンドーム == 0
			PRINTL <コンドームが無くなったので、自動装着を解除します>
			CLEARBIT FLAG:避妊具設定, 0
		ENDIF
	ELSEIF GETBIT(FLAG:避妊具設定, 1) && 射精したキャラ == ASSI
		IF ITEM:コンドーム > 0
			ITEM:コンドーム--
			TEQUIP:ASSI:コンドーム = 1
		ENDIF
		IF ITEM:コンドーム == 0
			PRINTL <コンドームが無くなったので、自動装着を解除します>
			CLEARBIT FLAG:避妊具設定, 1
		ENDIF
	ENDIF
ENDIF

;天使による感度アップ
SIF CSTR:射精したキャラ:種族 == "天使"
	TFLAG:天使の感度ボーナス++

;実績:1回の調教でモードの口、膣、尻のすべてに射精する
SIF CHARANAMEF(TARGET) == "モード" && GETBIT(TFLAG:中出し, 0) && GETBIT(TFLAG:中出し, 1) && GETBIT(TFLAG:口内射精, 0)
	CALL 実績解除, "精子の海のリントヴルム"

;実績:卑弥呼の穴を白くする
SIF CHARANAMEF(TARGET) == "卑弥呼" && (GETBIT(TFLAG:中出し, 0) || GETBIT(TFLAG:中出し, 1))
	CALL 実績解除, "皆伝予備軍"

;-------------------------------------------------
;ソースの計算
;-------------------------------------------------
@SAMEN_SHOOT_SOURCE, ARG
;恋慕、親愛持ちで射精者が主人の場合は達成感のソースが増加する
IF (TALENT:恋慕 || TALENT:親愛) && ARG == MASTER
	SOURCE:達成 += 1500
;淫乱、娼婦なら欲情のソース増加
ELSEIF TALENT:淫乱 || TALENT:娼婦
	SOURCE:欲情 += 1500
ELSE
	SOURCE:恐怖 += 1500
ENDIF

;未陥落の場合は反発増加
SIF !CFLAG:陥落
	SOURCE:反感 += 1000

