【eraBEMANI用　口上テンプレート】

【概要】
eratohoAからの機能である口上機能を表示するための雛形です。
eratohoAからまんま流用してましたが、
Ver.1.13でeraBEMANI用に改正しました。
Ver.1.15で仕様を変更したため、1.14以前の口上は移植しないと使えなくなりました。
ついでに特定の調教者用のテンプレも削除
テンプレを少し工夫すれば対応できるので、やりたい方は頑張ってください
わからなければ聞いてください
口上の変化の分岐には陥落素質が採用されています。
陥落の判断フラグは「CFLAG:5」「CFLAG:陥落」です。


【内容物】
・EVENT_KX1.ERB　 主人公がキャラKX1を調教した場合を前提としたテンプレート

【使い方】
まず共通するのが、KX1を対象のフルネームに置換をすることです。
口上を書く前に全置換するとよいでしょう。
また、ファイル名のKX1も奴隷のキャラ名に変えてください。

次に、各所にあるPRINTFORMW の後にセリフなどの口上テキストを書き加えていってください。
ですが量が多いので、条件やコマンドの取捨選択をしながら書いていくことをおすすめします。
書き終わったら、ERBフォルダに口上ファイルを入れてeraBEMANIを起動すれば口上が表示されます。

飽くまでもテンプレートですので、素質などで分岐を作ることも工夫のひとつになります。
テンプレートではそのような分岐は用意していませんので、各自作ってください。
口上を書いていないコマンドやイベント等は、関数名を差し戻したり、頭にRETURN 0を置く、
PRINTFORMW の文頭にセミコロン(;)を付けてコメントアウト等をすれば、無駄なウェイトを防ぐことができます。

口上を作成したら同梱の「ライセンステンプレ.txt」の内容をread meに書いておきましょう。
それが無い場合は作者も手出しできないので書いてもらえると助かります。


【CFLAGについて】
口上テンプレート内で使用しているキャラ変数は以下のようになっています。

　FEVE:(イベント番号) = イベントの初回判定に使用 0は初調教時、15はエクストラモード その他はイベント番号と同じです
　FPALAM = パラメータ変化用フラグ
　FEX = 初絶頂時のフラグ
　FCOM:(COM番号) = 初回調教コマンド用フラグ

口上独自のイベントなどで変数が必要な場合はERHを使うといいでしょう。


【作り方】
基本的に「PRINTFORMW 」の後ろにセリフを追加していけば大方の口上は作れると思います。
しかしテンプレートはかなり単純に作っているので、「状況によって分岐を作りたい」という口上作者のニーズには物足りないものがあります。
そういう場合の分岐の増やし方や、基本的な文法をここで説明したいと思います。

【その１ 奴隷の能力で分岐を作りたい！】
能力というのは「Ｃ感覚」や「Ｖ感覚」、「従順」や「奉仕精神」などの、調教終了後に上昇させることができる数値のことです。
その場合は「SELECTCASE」という分岐を使います。能力は「ABL:」の後に能力名を入れることによって参照することができます。
以下に例

;奴隷のＡ感覚を見る
SELECTCASE ABL:Ａ感覚
	;ゼロの場合
	CASE 0
		PRINTFORMW 「痛いっ！ 痛いなぁ、もう！ 変に弄らないでよ……まったく」
	;1～3の場合
	CASE 1 TO 3
		PRINTFORMW 「あっ、ぐぅ……な、なんだよ……気持ち良くなって何か悪い？」
		PRINTFORMW 「お前ばかり楽しむなんて不公平なんだから……少しくらい……」
	;4以上の場合
	CASE IS >= 4
		PRINTFORMW 「だ、だめぇ……そこは……僕、出しちゃうからぁ……」
ENDSELECT

まず「SELECTCASE ABL:Ａ感覚」で奴隷のＡ感覚を参照します 「SELECTCASE ABL:Ｖ感覚」ならＶ感覚を参照しますし、
「SELECTCASE ABL:従順」なら従順を参照します。
ただし「SELECTCASE」と「ABL:◯◯」の間に半角スペースを入れるのを忘れないようにしましょう。

次に「CASE ◯」でその能力がどの数値の場合、の分岐が出来上がります。
「CASE 0」や「CASE 1」など、ひとつの数字で書いた場合は、その数値の場合にその分岐を実行します。
上記の例なら「CASE 0」、つまりＡ感覚が0の場合に「痛いっ！ 痛いなぁ」と言うわけです

「CASE 1 TO 3」や「CASE 4 TO 6」といったように、「◯ TO ◯」と書いた場合は、その間の数値の場合に分岐を実行します。
上記の場合は「CASE 1 TO 3」と書いているので、Ａ感覚が1、2、3の場合に「あっ、ぐぅ……な、なんだよ」と言うわけです

「CASE IS >= 4」や「CASE IS >= 6」といったように、「IS >= ◯」と書いた場合は、それ以上の数値の場合に分岐を実行します。
上記の場合は「CASE IS >= 4」と書いているので、Ａ感覚が4以上の場合に「だ、だめぇ……」と言うわけです
応用として、「IS <= ◯」と書くと、その数値以下の場合に実行する分岐になります

「Ａ感覚」や「Ｃ感覚」の「Ａ」「Ｃ」の部分は全角大文字なので間違えないようにしましょう

【その２ ランダムで表示する分岐を作りたい！】
ランダムで分岐を表示する場合には「乱数」と呼ばれるものを使います。
乱数の使い方は簡単です。「RAND:◯」といったように、「RAND:」のあとに数字を入れると、その数値の中からランダムでひとつの数字になります。
注意点として、プログラミングの類は数字を0から数えるので、「1、2、3と数えるから3番目の数字は3だよね」というのは間違いになります。
「0、1、2と数えるから3番めの数字は2」というのが正しくなります。ややこしいですが気をつけましょう。
たとえば「RAND:3」と書いた場合は、0～2の中からランダムでひとつの数字になります。
当然、「RAND:5」と書くと0～4の中からひとつの数字になります。5分の1の確率です。
以下例文

;乱数分岐:4
SELECTCASE RAND:4
	CASE 0
		PRINTFORMW 「はぁ……出ちゃった……ねぇ、これ舐めて……？」
	CASE 1
		PRINTFORMW 「うあっ、ああっ……出る、出ちゃ、うぅ……」
	CASE 2
		PRINTFORMW 「はっ、はぁっ、見て、僕の、こんなに……」
	CASE 3
		PRINTFORMW 「僕だけ先にイッちゃった……ごめんね♪」
ENDSELECT

「SELECTCASE」を使い方は前項で紹介した通りです。
例文では「RAND:4」を使っていますので、0～3の数字からランダムでひとつを返します。
つまり「SELECTCASE RAND:4」のあとの4つのセリフの中から、それぞれ4分の1の確率でひとつが表示されるわけです。
口上のマンネリ化を防ぎたい場合などに活用しましょう。

【その３ 主人の名前を呼ぶようにしたい！】
主人の名前は「%CALLNAME:MASTER%」を使うことによって表示するようにできます。が、
正直これはおすすめしません。デフォルトだと主人の名前は「あなた」になってしまうので、

PRINTFORMW 「僕は%CALLNAME:MASTER%なんか嫌いだよ！」

と書いた場合、ゲーム内では

「僕はあなたなんか嫌いだよ！」

とどこか不自然な文になってしまいます。なので、あまり主人の名前は呼ばずに、
そのキャラに合った二人称を使うことをおすすめします。

PRINTFORMW 「僕はお前なんか嫌いだよ！」

といったように書くといいでしょう。
活用できる場面としては、

PRINTFORMW 「僕はお前なんか嫌いだよ！」
PRINTFORMW ルシェは%CALLNAME:MASTER%を睨みながら吐き捨てた……

などというように情景描写を表す一文に使用すれば、

「僕はお前なんか嫌いだよ！」
ルシェはあなたを睨みながら吐き捨てた……

と表示されて自然な文章になります。これなら、例えば主人が「あなた」以外のキャラだった場合にも、

「僕はお前なんか嫌いだよ！」
ルシェはマモニスを睨みながら吐き捨てた……

といったように、分かりやすくて面白い口上になったりするでしょう。「僕はアーシェムさんなら好きだよ」

【その４ 陥落素質で分岐したい！】
陥落素質とは「恋慕」「淫乱」「服従」などの、主人に完全に屈した奴隷の素質のことを指します。
陥落素質には3種類あり、主人に恋い慕う「恋慕」及び「親愛」、性行為の虜になってしまった「淫乱」及び「娼婦」、主人に忠誠を誓った「服従」及び「隷属」の3種類です。
陥落素質はこの3種類の中からひとつしか付けられません。つまり「恋慕」を取得した場合は「淫乱」も「服従」も付けられません。
これらは「IF TALENT:恋慕 || TALENT:親愛」などでも分岐を作れますが、当バリアントでは少し簡略化した書き方ができます。
その際は「FALLTYPE(TARGET)」というものを使います。
対象が恋慕、もしくは親愛の場合、「FALLTYPE(TARGET)」には1が、淫乱、娼婦の場合は2が、服従、隷属の場合は3が入ります。
未陥落の場合は0です。以下例文

SELECTCASE FALLTYPE(TARGET)
	;未陥落の場合
	CASE 0
		PRINTFORMW 「また来たの？ キミも懲りないねぇ……」
	;恋慕or親愛
	CASE 1
		PRINTFORMW 「どこ行ってたのさ！ 今日も僕とたくさん愛し合おうね♪」
	;淫乱or娼婦
	CASE 2
		PRINTFORMW 「あぁんもう、やっと来た……ねぇ、早く僕を抱いてよぉ」
	;服従or隷属
	CASE 3
		PRINTFORMW 「ご主人様、お疲れではありませんか？ 僕のことよりも、ご主人様の体を大事になさってくださいね……」
ENDSELECT

コメントアウト行の通りです。上記のように書けば少しは作成が楽になるかも？


基本的な説明はしましたが、上記以外にも口上の分岐を増やす方法はたくさん存在します。
何か不明な点や、「こういうのを書きたいけどどうやって分岐したらいいのか分からない」と言った場合には、eraBEMANI開発スレ等で問い合わせてもらえると作者自ら対応させていただきます。お気軽にどうぞ。

